# HMAC-Net 實驗配置檔案

# 訓練參數
training:
  batch_size: 32            # 批次大小
  num_epochs: 50            # 訓練輪數
  learning_rate: 0.001      # 初始學習率
  weight_decay: 0.0001      # L2 正則化係數
  grad_clip: 5.0            # 梯度裁剪閾值

  # 損失函數設定
  loss:
    type: "focal"           # 損失函數類型: "focal", "ce", "weighted_ce"
    gamma: 2.0              # Focal Loss 的 gamma 參數（越大越關注難樣本）
    class_weights: [1.0, 2.5, 1.0]  # 類別權重 [負面, 中性, 正面]（中性給予更高權重）
    use_class_weights: true # 是否使用類別權重

  # 優化器設定
  optimizer:
    type: "adam"            # 優化器類型: "adam", "adamw", "sgd"
    beta1: 0.9
    beta2: 0.999
    eps: 1.0e-8

  # 學習率調度器
  scheduler:
    type: "cosine"              # 調度器類型: "cosine", "reduce_on_plateau", "linear"
    warmup_epochs: 2            # Warm-up 輪數（前 2 個 epochs 線性增長）
    min_lr: 1.0e-6              # 最小學習率
    # ReduceLROnPlateau 參數（當 type="reduce_on_plateau" 時使用）
    factor: 0.5                 # 學習率衰減因子
    patience: 3                 # 等待輪數

  # Early Stopping
  early_stopping:
    enabled: true           # 是否啟用
    patience: 5             # 容忍輪數（降低以更早停止過擬合）
    metric: "macro_f1"      # 監控指標: "accuracy", "macro_f1", "loss"
    mode: "max"             # 模式: "max" 或 "min"

  # 資料增強
  augmentation:
    label_smoothing: 0.1    # 標籤平滑化
    mixup_alpha: 0.2        # Mixup 參數（0表示不使用，推薦 0.2）
    mixup_enabled: false    # 是否啟用 Mixup（需要模型架構支持，暫時禁用）
    adversarial_training:   # 對抗訓練
      enabled: false        # 是否啟用（可選，會增加訓練時間）
      epsilon: 1.0          # 擾動幅度
      method: "fgm"         # 方法: "fgm" 或 "pgd"

# 驗證參數
validation:
  val_interval: 1           # 每隔幾個 epoch 進行驗證
  save_best_only: true      # 是否只保存最佳模型
  save_interval: 5          # 每隔幾個 epoch 保存檢查點

# 測試參數
testing:
  batch_size: 64            # 測試批次大小
  ensemble: false           # 是否使用模型集成
  num_models: 5             # 集成模型數量（如果使用集成）

# 日誌與輸出
logging:
  log_interval: 10          # 每隔幾個 batch 記錄一次
  tensorboard: true         # 是否使用 TensorBoard
  log_dir: "results/logs"   # 日誌目錄
  save_attention: true      # 是否保存注意力權重（用於視覺化）

# 檢查點設定
checkpoint:
  save_dir: "results/checkpoints"
  filename_template: "hmac_net_epoch_{epoch}_f1_{f1:.4f}.pt"
  keep_last_n: 3            # 保留最近 N 個檢查點

# 消融實驗設定
ablation:
  variants:
    - name: "full"          # 完整模型
      remove_modules: []

    - name: "wo_aaha"       # 移除 AAHA
      remove_modules: ["aaha"]
      replace_with: "single_attention"

    - name: "wo_pmac"       # 移除 PMAC
      remove_modules: ["pmac"]
      replace_with: "average_pooling"

    - name: "wo_iarm"       # 移除 IARM
      remove_modules: ["iarm"]
      replace_with: "independent"

    - name: "wo_hierarchical"  # 移除階層式設計
      remove_modules: ["aaha"]
      replace_with: "flat_attention"

  # 消融實驗重複次數（用於統計顯著性檢驗）
  num_runs: 5

# Baseline 比較實驗
baselines:
  models:
    - "LSTM"
    - "ATAE-LSTM"
    - "IAN"
    - "HMAC-Net"

  # 統計檢驗設定
  statistical_tests:
    - "paired_t_test"
    - "wilcoxon_signed_rank"
  confidence_level: 0.95
  num_bootstrap_samples: 1000

# 隨機種子（用於結果重現）
seeds: [42, 123, 456, 789, 1024]
