# PMAC Only (without IARM) - Enhanced with Data Augmentation & Balanced Regularization
# 測試 PMAC 單獨的效果，排除 IARM 可能引入的噪音
# 配置更新 v2 (2025-11-19 修正):
#   - 啟用數據增強 (訓練集增加 ~84%)
#   - 平衡正則化 (Dropout 0.4, Label Smoothing 0.05)

experiment_name: "pmac_only_balanced"

# 模型配置
model:
  baseline: null
  bert_model: "distilbert-base-uncased"
  freeze_bert: false
  hidden_dim: 768
  dropout: 0.4  # 從 0.5 降至 0.4 (平衡正則化強度)

  # PMAC 配置（與 full_model_optimized 一致）
  use_pmac: true
  gate_bias_init: -1.0    # 實驗 A 驗證的最佳值
  gate_weight_gain: 0.5   # 實驗 A 使用的值
  gate_sparsity_weight: 0.0
  gate_sparsity_type: "l1"

  # IARM 配置
  use_iarm: false  # 不使用 IARM（消融實驗）

# 數據配置
data:
  use_augmented: true  # ✅ 啟用數據增強 (訓練集 +84%)
  min_aspects: 2
  max_aspects: 8
  include_single_aspect: true
  virtual_aspect_mode: "overall"
  max_text_len: 128
  max_aspect_len: 10

# 訓練配置
training:
  batch_size: 32
  accumulation_steps: 1
  epochs: 30
  lr: 2.0e-5
  weight_decay: 0.05  # 維持 L2 正則化
  grad_clip: 1.0
  patience: 12  # 從 8 提升至 12 (避免過早停止)

  # 調度器
  use_scheduler: true
  warmup_ratio: 0.1

  # 損失函數
  loss_type: "focal"
  focal_gamma: 2.5
  label_smoothing: 0.05  # 從 0.1 降至 0.05 (減少平滑影響)
  class_weights: [1.0, 8.0, 1.0]  # 與 full_model 一致

  # Virtual aspect
  virtual_weight: 0.5
