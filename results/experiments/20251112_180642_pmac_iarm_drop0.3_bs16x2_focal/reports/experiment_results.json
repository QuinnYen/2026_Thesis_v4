{
  "args": {
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": true,
    "pmac_mode": "selective",
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": true,
    "iarm_mode": "transformer",
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 16,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 2,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ]
  },
  "best_val_f1": 0.6433369265568673,
  "history": {
    "train_loss": [
      0.8119930342624062,
      0.6610191744147685,
      0.48226373498899894,
      0.3871976139121934,
      0.31293511854713424,
      0.2733525646883145,
      0.2132915978630384,
      0.17447906244840278,
      0.15714836620170167,
      0.13800368677383582,
      0.1247217154269221,
      0.10135136104368589,
      0.09478823249963553,
      0.10121767663625642,
      0.08622970302352323,
      0.08206476791855764,
      0.07484855397661593,
      0.07852569391967304,
      0.07394057871358216,
      0.07392372984006151,
      0.06765657715196109,
      0.06624675761977733,
      0.0701623966635548
    ],
    "val_loss": [
      0.5005798225219433,
      0.39487739365834457,
      0.3659446033147665,
      0.36583279302487004,
      0.39631185164818394,
      0.4127683307115848,
      0.48062724333543044,
      0.5262590715518365,
      0.5444702024643238,
      0.825461976803266,
      0.6793868266619169,
      0.7668541222810745,
      0.9538570894644811,
      1.0257817506790161,
      1.0291929955665882,
      1.0307866220290844,
      1.1314263744996145,
      1.11180946460137,
      1.1155502532537167,
      1.3135093312997084,
      1.203922918209663,
      1.2559609413146973,
      1.051058815075801
    ],
    "val_accuracy": [
      0.2463157894736842,
      0.4842105263157895,
      0.6210526315789474,
      0.5852631578947368,
      0.6968421052631579,
      0.7221052631578947,
      0.7052631578947368,
      0.7242105263157895,
      0.6463157894736842,
      0.7389473684210527,
      0.7326315789473684,
      0.7178947368421053,
      0.7410526315789474,
      0.751578947368421,
      0.7452631578947368,
      0.7157894736842105,
      0.728421052631579,
      0.7242105263157895,
      0.7115789473684211,
      0.7221052631578947,
      0.7178947368421053,
      0.7242105263157895,
      0.7073684210526315
    ],
    "val_f1_macro": [
      0.17465683663648512,
      0.34683470954657397,
      0.5319568116316084,
      0.5303930433629273,
      0.6180257172054339,
      0.638510986093784,
      0.6019216845303802,
      0.6199253882129147,
      0.5658739020368901,
      0.6249677008343352,
      0.6259264387338158,
      0.6227451095575546,
      0.6433369265568673,
      0.6428805727934686,
      0.6395466017210287,
      0.597180774100199,
      0.60698487792515,
      0.6175424269776819,
      0.6081641651626404,
      0.6227304042562419,
      0.613085664041078,
      0.618892531699102,
      0.6110529111130193
    ],
    "val_precision": [
      0.36963601532567053,
      0.3914638255955621,
      0.633113401042825,
      0.655135905135905,
      0.6492622182411353,
      0.6713869934208917,
      0.650460704607046,
      0.6908688387635756,
      0.6354287160477284,
      0.6284809634809635,
      0.6510680576254346,
      0.6253990929922626,
      0.6509089850284818,
      0.6558549730524253,
      0.6493310295941875,
      0.6176842684268427,
      0.6254564820450396,
      0.6234019734019735,
      0.6206467661691543,
      0.6218324151306079,
      0.6243961352657005,
      0.623062905508991,
      0.6260387110384473
    ],
    "val_recall": [
      0.3656404105024657,
      0.47130481140876984,
      0.5621633164915852,
      0.5662525898731418,
      0.6321843989676856,
      0.6479941356790618,
      0.6025532211357881,
      0.6188878993857002,
      0.5819772091163534,
      0.6221035828093006,
      0.6213193510474598,
      0.6298389735015085,
      0.6451101377630767,
      0.6359910581222056,
      0.6354073522106309,
      0.5961291241079326,
      0.5988828710939866,
      0.6190884252359662,
      0.6136396956368967,
      0.6284982976506367,
      0.6163640604364315,
      0.6217834078489816,
      0.6168438685132008
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.30947775628626695,
        0.2144927536231884
      ],
      [
        0.0,
        0.37948717948717947,
        0.6610169491525424
      ],
      [
        0.4065040650406504,
        0.40418118466898956,
        0.7851851851851852
      ],
      [
        0.464,
        0.3924050632911392,
        0.7347740667976425
      ],
      [
        0.5771812080536913,
        0.4444444444444444,
        0.8324514991181657
      ],
      [
        0.5986394557823129,
        0.4622222222222222,
        0.8546712802768166
      ],
      [
        0.5362318840579711,
        0.41818181818181815,
        0.8513513513513513
      ],
      [
        0.5384615384615384,
        0.46511627906976744,
        0.856198347107438
      ],
      [
        0.49624060150375937,
        0.4092664092664093,
        0.7921146953405018
      ],
      [
        0.5795454545454546,
        0.43312101910828027,
        0.8622366288492707
      ],
      [
        0.5675675675675675,
        0.4479166666666667,
        0.8622950819672132
      ],
      [
        0.5783132530120482,
        0.441025641025641,
        0.8488964346349746
      ],
      [
        0.5875,
        0.4787234042553192,
        0.8637873754152824
      ],
      [
        0.5822784810126582,
        0.47398843930635837,
        0.8723747980613893
      ],
      [
        0.5875,
        0.4632768361581921,
        0.867862969004894
      ],
      [
        0.5,
        0.4329896907216495,
        0.8585526315789473
      ],
      [
        0.5263157894736842,
        0.4342857142857143,
        0.8603531300160514
      ],
      [
        0.5555555555555556,
        0.4385026737967914,
        0.8585690515806988
      ],
      [
        0.5290322580645161,
        0.44554455445544555,
        0.8499156829679595
      ],
      [
        0.5847953216374269,
        0.43010752688172044,
        0.8532883642495784
      ],
      [
        0.5477707006369427,
        0.43434343434343436,
        0.8571428571428571
      ],
      [
        0.5609756097560976,
        0.43617021276595747,
        0.8595317725752508
      ],
      [
        0.5548387096774193,
        0.43478260869565216,
        0.8435374149659864
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23
    ]
  },
  "test_metrics": {
    "loss": 0.7187397423090021,
    "accuracy": 0.7815362931642001,
    "f1_macro": 0.6941657094244801,
    "precision": 0.6991147989374434,
    "recall": 0.6921541446304151,
    "f1_per_class": [
      0.6735112936344969,
      0.5182481751824818,
      0.8907376594564614
    ],
    "gate_stats": {
      "mean": 0.053917420335547216,
      "std": 0.03233970589607805,
      "min": 0.0,
      "max": 0.12952202558517456,
      "median": 0.05818428099155426,
      "q25": 0.04592323303222656,
      "q75": 0.07525983452796936,
      "sparsity": 0.945478504365014,
      "activation_rate": 0.0,
      "total_gates": 12142
    }
  }
}