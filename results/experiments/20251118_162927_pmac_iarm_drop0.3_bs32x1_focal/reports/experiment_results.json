{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": true,
    "gate_bias_init": -1.0,
    "gate_weight_gain": 0.5,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": true,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 20,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ]
  },
  "best_val_f1": 0.6395020202020202,
  "history": {
    "train_loss": [
      1.01531253781235,
      0.7576138999378472,
      0.5930238653693283,
      0.4815018522111993,
      0.37960560802827803,
      0.3235048842534684,
      0.25790494105272127,
      0.22389882253973106,
      0.18327376324879496,
      0.1611936934815164,
      0.15262631712514058,
      0.12661645744453398,
      0.11825033564839446,
      0.10881583170409788,
      0.1056006367792163,
      0.0963599817794666,
      0.09020721656270325,
      0.08519700672804263,
      0.08870617356641512,
      0.08479417540263712,
      0.0820559305057191,
      0.08208822478589259,
      0.07897577516473177,
      0.07832333592599944,
      0.07748547993731081,
      0.08067536767441452,
      0.07954805252844827,
      0.07667374659917857,
      0.07859682481278453,
      0.07974472931145053
    ],
    "val_loss": [
      0.6656092660767692,
      0.4560544618538448,
      0.461509644985199,
      0.4595323119844709,
      0.46413310510771616,
      0.5023595009531293,
      0.7010022572108677,
      0.7166548328740256,
      0.9237242681639535,
      1.082248100212642,
      1.4063295892306737,
      1.5280089208057948,
      1.7098500558308192,
      1.8174672297069006,
      1.5529092720576696,
      2.109706469944545,
      2.623046875,
      2.3816316638674055,
      2.317503103188106,
      1.9940768820898873,
      2.0716855015073503,
      2.0069752420697893,
      2.175738658223833,
      2.214660976614271,
      2.3313903638294766,
      2.1841078315462386,
      2.3101290549550737,
      2.3338862572397505,
      2.3306196417127336,
      2.3182678392955234
    ],
    "val_accuracy": [
      0.22526315789473683,
      0.44842105263157894,
      0.4842105263157895,
      0.6294736842105263,
      0.6442105263157895,
      0.5936842105263158,
      0.72,
      0.6947368421052632,
      0.7052631578947368,
      0.728421052631579,
      0.7263157894736842,
      0.7326315789473684,
      0.7094736842105264,
      0.728421052631579,
      0.6673684210526316,
      0.7115789473684211,
      0.751578947368421,
      0.72,
      0.7242105263157895,
      0.671578947368421,
      0.6863157894736842,
      0.6378947368421053,
      0.6989473684210527,
      0.6884210526315789,
      0.6968421052631579,
      0.6694736842105263,
      0.6884210526315789,
      0.7052631578947368,
      0.6926315789473684,
      0.6926315789473684
    ],
    "val_f1_macro": [
      0.15330287530605005,
      0.32549104252104466,
      0.4420024209219838,
      0.5427412313999392,
      0.5265456661986497,
      0.520589519745934,
      0.6069615879692681,
      0.621799558608599,
      0.6157866101471708,
      0.6383785384072328,
      0.6213247063826534,
      0.6374488255372005,
      0.6101324156042068,
      0.6143858710972805,
      0.5733931292081146,
      0.6239827385487199,
      0.6395020202020202,
      0.627016343505861,
      0.6334738448366338,
      0.5673105642956972,
      0.5751839721839951,
      0.5426388692545349,
      0.5936929390455826,
      0.57911992151894,
      0.584285308326229,
      0.5623023370897721,
      0.57911992151894,
      0.5886771554423563,
      0.5827079669586862,
      0.5827079669586862
    ],
    "val_precision": [
      0.3813888412997544,
      0.3891446822631492,
      0.6415936901592639,
      0.626027027027027,
      0.6725774548950015,
      0.6311210461865483,
      0.677558800378269,
      0.6572584078331206,
      0.6351327817354466,
      0.6601550653993749,
      0.6362149927367319,
      0.6454759850445787,
      0.6106578424243638,
      0.6375235647528105,
      0.6194462162518259,
      0.6344706119162641,
      0.6535363676929942,
      0.6318583948006683,
      0.6411577463123855,
      0.6116476681668365,
      0.6122476813966176,
      0.5670002827254735,
      0.6116301200317594,
      0.6031269763827903,
      0.6072107279693487,
      0.5873333627680398,
      0.6031269763827903,
      0.6150057509775378,
      0.6105226617957172,
      0.6105226617957172
    ],
    "val_recall": [
      0.36065573770491804,
      0.45569772091163535,
      0.5225094810560624,
      0.5594819647898416,
      0.5609874232125333,
      0.5628163885960767,
      0.6053678528588565,
      0.627287872729696,
      0.621418099426896,
      0.6423563907770226,
      0.6207356451358851,
      0.633685616662426,
      0.6135788108998824,
      0.6075221426580882,
      0.5804632692377595,
      0.6262831231143906,
      0.6297696073085918,
      0.6306547078138441,
      0.6355354827765863,
      0.5710376455478414,
      0.581937225109956,
      0.5532741448874995,
      0.595193740685544,
      0.5819214738347086,
      0.586293058534162,
      0.573194055711049,
      0.5819214738347086,
      0.5876924987580725,
      0.5841072661844353,
      0.5841072661844353
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.3088512241054614,
        0.1510574018126888
      ],
      [
        0.0,
        0.36585365853658536,
        0.6106194690265486
      ],
      [
        0.3333333333333333,
        0.38242894056847543,
        0.6102449888641426
      ],
      [
        0.453125,
        0.3895131086142322,
        0.7855855855855856
      ],
      [
        0.34234234234234234,
        0.4244604316546763,
        0.8128342245989305
      ],
      [
        0.4032258064516129,
        0.40514469453376206,
        0.7533980582524272
      ],
      [
        0.5116279069767442,
        0.4507042253521127,
        0.8585526315789473
      ],
      [
        0.6216216216216216,
        0.42290748898678415,
        0.8208695652173913
      ],
      [
        0.5751633986928104,
        0.43601895734597157,
        0.8361774744027304
      ],
      [
        0.5866666666666667,
        0.47804878048780486,
        0.8504201680672269
      ],
      [
        0.5584415584415584,
        0.4479166666666667,
        0.8576158940397351
      ],
      [
        0.6257668711656442,
        0.4406779661016949,
        0.8459016393442623
      ],
      [
        0.5680473372781065,
        0.4262295081967213,
        0.8361204013377926
      ],
      [
        0.5503355704697986,
        0.43243243243243246,
        0.8603896103896104
      ],
      [
        0.5035971223021583,
        0.4034334763948498,
        0.8131487889273357
      ],
      [
        0.6125,
        0.4263959390862944,
        0.8330522765598651
      ],
      [
        0.5875,
        0.46060606060606063,
        0.8704
      ],
      [
        0.5975609756097561,
        0.4397905759162304,
        0.8436974789915966
      ],
      [
        0.6172839506172839,
        0.4375,
        0.8456375838926175
      ],
      [
        0.4892086330935252,
        0.38596491228070173,
        0.8267581475128645
      ],
      [
        0.4714285714285714,
        0.4125560538116592,
        0.8415672913117547
      ],
      [
        0.46357615894039733,
        0.3706896551724138,
        0.7936507936507936
      ],
      [
        0.5359477124183006,
        0.4019607843137255,
        0.8431703204047217
      ],
      [
        0.5,
        0.3981042654028436,
        0.8392554991539763
      ],
      [
        0.5,
        0.4057971014492754,
        0.8470588235294118
      ],
      [
        0.4520547945205479,
        0.4107142857142857,
        0.8241379310344827
      ],
      [
        0.5,
        0.3981042654028436,
        0.8392554991539763
      ],
      [
        0.5068493150684932,
        0.4039408866995074,
        0.8552412645590682
      ],
      [
        0.5068493150684932,
        0.3981042654028436,
        0.8431703204047217
      ],
      [
        0.5068493150684932,
        0.3981042654028436,
        0.8431703204047217
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30
    ]
  },
  "test_metrics": {
    "loss": 1.6476648810662722,
    "accuracy": 0.7857646229739254,
    "f1_macro": 0.6966770658015227,
    "precision": 0.7047493144482303,
    "recall": 0.6896547267620482,
    "f1_per_class": [
      0.7077534791252486,
      0.4979757085020243,
      0.8843020097772949
    ],
    "auc_macro": 0.879280610100054,
    "auc_weighted": 0.8904790065049842,
    "gate_stats": {
      "mean": 0.2149705373077539,
      "std": 0.12468064961922831,
      "min": 0.0,
      "max": 0.5322463512420654,
      "median": 0.2272980958223343,
      "q25": 0.1731882095336914,
      "q75": 0.2909729555249214,
      "sparsity": 0.18972431077694235,
      "activation_rate": 0.0016290726817042606,
      "total_gates": 15960
    }
  }
}