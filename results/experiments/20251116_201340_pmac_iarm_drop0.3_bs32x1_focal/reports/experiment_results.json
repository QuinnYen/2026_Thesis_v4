{
  "args": {
    "dataset": "laptops",
    "use_augmented": true,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": true,
    "gate_bias_init": -1.0,
    "gate_weight_gain": 0.5,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": true,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 15,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ]
  },
  "best_val_f1": 0.7397453516590003,
  "history": {
    "train_loss": [
      1.0285272766167008,
      0.7436829964879533,
      0.5239856306096198,
      0.39964775919494494,
      0.294235406941931,
      0.23341451774180774,
      0.2003946250803034,
      0.1529717980273245,
      0.12978735414922277,
      0.1156619501079418,
      0.11031117805109268,
      0.10269067058460435,
      0.09826129266638046,
      0.1000366404626566,
      0.0902441759937292,
      0.08795420726733348,
      0.0923839354966308,
      0.09157018935386564,
      0.08543723121359838,
      0.08340614640422847
    ],
    "val_loss": [
      0.6774238049983978,
      0.5203760750591755,
      0.5087138079106808,
      0.4500971920788288,
      0.45690589398145676,
      0.45051650889217854,
      0.5567725859582424,
      0.6046130694448948,
      0.5306655559688807,
      0.5656526144593954,
      0.5029905252158642,
      0.6004814971238375,
      0.5615755971521139,
      0.5668783076107502,
      0.5711290054023266,
      0.5987722650170326,
      0.5793727142736316,
      0.601159255951643,
      0.6196984741836786,
      0.6435742378234863
    ],
    "val_accuracy": [
      0.18659420289855072,
      0.45471014492753625,
      0.6992753623188406,
      0.6739130434782609,
      0.7626811594202898,
      0.6721014492753623,
      0.7228260869565217,
      0.7518115942028986,
      0.7336956521739131,
      0.7481884057971014,
      0.7119565217391305,
      0.7427536231884058,
      0.7228260869565217,
      0.7192028985507246,
      0.7373188405797102,
      0.730072463768116,
      0.7409420289855072,
      0.7336956521739131,
      0.7427536231884058,
      0.75
    ],
    "val_f1_macro": [
      0.11335679130082103,
      0.4337151780860153,
      0.6576650563607086,
      0.6507666372257926,
      0.7397453516590003,
      0.6599174086978965,
      0.707314736389105,
      0.7283708853616843,
      0.7183682311939849,
      0.7320472999565458,
      0.6997845292776169,
      0.7206387592076032,
      0.7073785460929574,
      0.7036991331725501,
      0.722890559732665,
      0.7144605300741143,
      0.72501754186342,
      0.71779064618305,
      0.7236477079358532,
      0.7303708850433169
    ],
    "val_precision": [
      0.3935523114355231,
      0.6991925098325851,
      0.6680307471387456,
      0.69831727341016,
      0.7418831168831169,
      0.6997354497354498,
      0.7295113222188764,
      0.736455582007762,
      0.7353763494380141,
      0.740892941178616,
      0.721498600568368,
      0.7239435739528498,
      0.7256682081948048,
      0.7238790974057284,
      0.7387644485329924,
      0.7322619040300552,
      0.7377381675195883,
      0.7340301649746029,
      0.7291748879795495,
      0.7351754461088099
    ],
    "val_recall": [
      0.33910533910533913,
      0.5312780312780312,
      0.6633191633191633,
      0.6781001781001782,
      0.7618072618072619,
      0.7004927004927005,
      0.7421837421837422,
      0.7516932516932516,
      0.7534677534677535,
      0.765011765011765,
      0.7395317395317397,
      0.7433082433082433,
      0.7437567437567437,
      0.7391222391222391,
      0.7599092599092598,
      0.7498797498797498,
      0.759064259064259,
      0.7528242528242527,
      0.750945750945751,
      0.7569517569517569
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.30602782071097373,
        0.03404255319148936
      ],
      [
        0.23107569721115537,
        0.3741935483870968,
        0.6958762886597938
      ],
      [
        0.7688888888888888,
        0.4166666666666667,
        0.7874396135265701
      ],
      [
        0.7991071428571429,
        0.46258503401360546,
        0.6906077348066298
      ],
      [
        0.8142857142857143,
        0.5928853754940712,
        0.8120649651972158
      ],
      [
        0.6829268292682927,
        0.5206349206349207,
        0.7761904761904762
      ],
      [
        0.7648578811369509,
        0.5655172413793104,
        0.7915690866510539
      ],
      [
        0.817351598173516,
        0.5736434108527132,
        0.7941176470588235
      ],
      [
        0.7862407862407862,
        0.5824561403508772,
        0.7864077669902912
      ],
      [
        0.78239608801956,
        0.608058608058608,
        0.8056872037914692
      ],
      [
        0.7469287469287469,
        0.5782312925170068,
        0.7741935483870968
      ],
      [
        0.7737226277372263,
        0.578125,
        0.8100686498855835
      ],
      [
        0.741514360313316,
        0.5824561403508772,
        0.7981651376146789
      ],
      [
        0.7455012853470437,
        0.5674740484429066,
        0.7981220657276995
      ],
      [
        0.7769423558897243,
        0.5964912280701754,
        0.7952380952380952
      ],
      [
        0.7609254498714653,
        0.5824561403508772,
        0.8
      ],
      [
        0.7753086419753087,
        0.5949820788530465,
        0.8047619047619048
      ],
      [
        0.7621483375959079,
        0.5865724381625441,
        0.8046511627906977
      ],
      [
        0.7707317073170732,
        0.5909090909090909,
        0.8093023255813954
      ],
      [
        0.782608695652174,
        0.5954198473282443,
        0.8130841121495327
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20
    ]
  },
  "test_metrics": {
    "loss": 0.6234310652528491,
    "accuracy": 0.7380434782608696,
    "f1_macro": 0.7085208459118842,
    "precision": 0.7019909803220109,
    "recall": 0.7206430893614716,
    "f1_per_class": [
      0.6948356807511737,
      0.5859375,
      0.844789356984479
    ],
    "gate_stats": {
      "mean": 0.14575528657765097,
      "std": 0.08320867749933965,
      "min": 0.0,
      "max": 0.283310204744339,
      "median": 0.1806240752339363,
      "q25": 0.1427779197692871,
      "q75": 0.19774992763996124,
      "sparsity": 0.23354908306364616,
      "activation_rate": 0.0,
      "total_gates": 7416
    }
  }
}