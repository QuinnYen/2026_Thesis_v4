{
  "args": {
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": true,
    "pmac_mode": "selective",
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": true,
    "iarm_mode": "transformer",
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 16,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 2,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "class_weights": [
      1.0,
      3.0,
      1.0
    ]
  },
  "best_val_f1": 0.6555324173386283,
  "history": {
    "train_loss": [
      0.7474712201377802,
      0.5953323686854881,
      0.46417501895574104,
      0.37613312658249287,
      0.30459213903860044,
      0.24928741941326543,
      0.19943931656317754,
      0.16805028101723446,
      0.1421170710104011,
      0.12963601533556357,
      0.11959695004400585,
      0.11072697126502662,
      0.09946895074589472,
      0.0958974645779419,
      0.08931921424523911,
      0.08793806467152185,
      0.08166774096663862
    ],
    "val_loss": [
      0.4631571884338672,
      0.39470321857012236,
      0.3830345720052719,
      0.35277140599030715,
      0.41494220151351047,
      0.5330651379548587,
      0.468909522661796,
      0.5650839324180896,
      0.588886939562284,
      0.6261100929517013,
      0.6065467194868968,
      0.5835471359583048,
      0.7658540377250085,
      0.7246186183049128,
      0.854373982319465,
      0.9339823722839355,
      0.7955420406965109
    ],
    "val_accuracy": [
      0.6294736842105263,
      0.6610526315789473,
      0.5810526315789474,
      0.7031578947368421,
      0.6673684210526316,
      0.7452631578947368,
      0.7452631578947368,
      0.7305263157894737,
      0.7368421052631579,
      0.7347368421052631,
      0.7094736842105264,
      0.7157894736842105,
      0.7326315789473684,
      0.7389473684210527,
      0.7389473684210527,
      0.7536842105263157,
      0.7326315789473684
    ],
    "val_f1_macro": [
      0.38750913936649445,
      0.5031892467247753,
      0.5464005964931973,
      0.6126774764335154,
      0.5999513337971182,
      0.6470848549740268,
      0.6555324173386283,
      0.632699636114336,
      0.636552391745762,
      0.6253611180361045,
      0.6211135979375527,
      0.633763301625247,
      0.6388550668025902,
      0.635097536366953,
      0.6463492063492063,
      0.6497867543436727,
      0.631708357535603
    ],
    "val_precision": [
      0.3503741703914398,
      0.7091011360914349,
      0.6417042224017715,
      0.655755423335332,
      0.6311068818808757,
      0.6677030020624857,
      0.6693363960865804,
      0.6821374703727644,
      0.6379602680920948,
      0.6491592016344492,
      0.6311440012376508,
      0.6426997675683696,
      0.6323358971099245,
      0.6425680248458722,
      0.6433626816990631,
      0.6530281467425679,
      0.632101850887647
    ],
    "val_recall": [
      0.4337731574037052,
      0.5570871651339464,
      0.591848109241152,
      0.6184617062266002,
      0.6258002859462276,
      0.6410744792991894,
      0.6553808779518496,
      0.6294200501617535,
      0.6385663916251682,
      0.6226894090848508,
      0.6251902269395272,
      0.643329637841833,
      0.6477148534525584,
      0.6315743399609852,
      0.6507163801146209,
      0.6467552372990198,
      0.6342399403874813
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.38095238095238093,
        0.7815750371471025
      ],
      [
        0.22,
        0.4542124542124542,
        0.8353552859618717
      ],
      [
        0.5217391304347826,
        0.40752351097178685,
        0.7099391480730223
      ],
      [
        0.5633802816901409,
        0.4298245614035088,
        0.8448275862068966
      ],
      [
        0.5584415584415584,
        0.43478260869565216,
        0.8066298342541437
      ],
      [
        0.6274509803921569,
        0.44680851063829785,
        0.8669950738916257
      ],
      [
        0.6369426751592356,
        0.46632124352331605,
        0.8633333333333333
      ],
      [
        0.5899280575539568,
        0.44339622641509435,
        0.8647746243739566
      ],
      [
        0.6153846153846154,
        0.430939226519337,
        0.8633333333333333
      ],
      [
        0.5540540540540541,
        0.4536082474226804,
        0.868421052631579
      ],
      [
        0.6086956521739131,
        0.417910447761194,
        0.8367346938775511
      ],
      [
        0.6086956521739131,
        0.45410628019323673,
        0.8384879725085911
      ],
      [
        0.6,
        0.4632768361581921,
        0.8532883642495784
      ],
      [
        0.6012269938650306,
        0.4431818181818182,
        0.8608837970540099
      ],
      [
        0.6285714285714286,
        0.45714285714285713,
        0.8533333333333334
      ],
      [
        0.6242774566473989,
        0.4567901234567901,
        0.8682926829268293
      ],
      [
        0.5798816568047337,
        0.4581005586592179,
        0.8571428571428571
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17
    ]
  },
  "test_metrics": {
    "loss": 0.38391041865351755,
    "accuracy": 0.7766032417195208,
    "f1_macro": 0.6893732433884766,
    "precision": 0.6935925567722903,
    "recall": 0.6858045833267713,
    "f1_per_class": [
      0.7014028056112225,
      0.48565965583174,
      0.8810572687224669
    ],
    "gate_stats": {
      "mean": 0.03506442096487505,
      "std": 0.018490559777985967,
      "min": 0.0,
      "max": 0.05100540444254875,
      "median": 0.043495241552591324,
      "q25": 0.04096006602048874,
      "q75": 0.04618996288627386,
      "sparsity": 1.0,
      "activation_rate": 0.0,
      "total_gates": 12142
    }
  }
}