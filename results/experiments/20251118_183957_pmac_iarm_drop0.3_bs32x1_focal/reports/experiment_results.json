{
  "args": {
    "dataset": "laptops",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": true,
    "gate_bias_init": -1.0,
    "gate_weight_gain": 0.5,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": true,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 20,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ]
  },
  "best_val_f1": 0.7108029447012498,
  "history": {
    "train_loss": [
      0.9807599300429934,
      0.7758459235940661,
      0.5766641071864537,
      0.45283381392558414,
      0.3602020928547496,
      0.303408838453747,
      0.20558444091251918,
      0.18088178576103278,
      0.15445864191722303,
      0.13283875056852898,
      0.11535865813493729,
      0.11210355748023305,
      0.11358177549915299,
      0.08471607206766271,
      0.07982986582265723,
      0.08502527637340661,
      0.06771191421319686,
      0.06855177143145175,
      0.0619242999126159,
      0.06435265828899685,
      0.05735444434962812,
      0.06262516824340093,
      0.056409867807468844,
      0.056020460972961574,
      0.056656001978332086,
      0.05514376403741716,
      0.05716450188386565,
      0.055771331258472945,
      0.052980322013830856,
      0.05491912646158155
    ],
    "val_loss": [
      0.7271267533302307,
      0.4878631055355072,
      0.47352202534675597,
      0.474592912197113,
      0.4469249755144119,
      0.503478741645813,
      0.7641348034143448,
      0.7106080442667008,
      0.5815714478492737,
      0.8133195012807846,
      0.7492763668298721,
      1.0128545969724656,
      0.5989822238683701,
      0.9376223295927048,
      0.6843203142285347,
      0.7918363615870476,
      0.9949194818735123,
      0.6738753944635392,
      1.2558741688728332,
      0.7647557184100151,
      0.8725430876016617,
      0.8211134314537049,
      0.9572481065988541,
      1.0042764216661453,
      0.9649512797594071,
      1.00114586353302,
      0.9383927404880523,
      0.9281738430261612,
      0.9452288210391998,
      0.9523249328136444
    ],
    "val_accuracy": [
      0.20414201183431951,
      0.3609467455621302,
      0.5680473372781065,
      0.6538461538461539,
      0.621301775147929,
      0.6449704142011834,
      0.6982248520710059,
      0.6952662721893491,
      0.6449704142011834,
      0.7366863905325444,
      0.7307692307692307,
      0.7337278106508875,
      0.6982248520710059,
      0.727810650887574,
      0.7011834319526628,
      0.7130177514792899,
      0.7396449704142012,
      0.6863905325443787,
      0.7100591715976331,
      0.7130177514792899,
      0.7248520710059172,
      0.7130177514792899,
      0.7248520710059172,
      0.7189349112426036,
      0.7189349112426036,
      0.7189349112426036,
      0.7248520710059172,
      0.7248520710059172,
      0.7248520710059172,
      0.7248520710059172
    ],
    "val_f1_macro": [
      0.12401140007125044,
      0.32916275501867903,
      0.5746809501969263,
      0.6448542168179064,
      0.6220095693779905,
      0.6333926535698189,
      0.6570101177822224,
      0.665836262596454,
      0.6450994253030516,
      0.7095615004256398,
      0.7108029447012498,
      0.6869488536155203,
      0.6821804241838391,
      0.6964236964236964,
      0.6911427015935435,
      0.6914919291036935,
      0.7010991815919997,
      0.6762387239590169,
      0.6505478527288778,
      0.6938780447762483,
      0.7025187014838665,
      0.6893249588814311,
      0.6929582395375848,
      0.6943495782689819,
      0.6943495782689819,
      0.6880468916410356,
      0.6993613519896998,
      0.6993613519896998,
      0.6993613519896998,
      0.6993613519896998
    ],
    "val_precision": [
      0.3990049751243781,
      0.6963235294117647,
      0.6875267119169558,
      0.7123865008135203,
      0.7019320548732312,
      0.6772872158267695,
      0.6661269109364362,
      0.685227278865366,
      0.7224618510850395,
      0.712547548749673,
      0.7209793443112428,
      0.6891910558577226,
      0.7005388631220453,
      0.696171274109738,
      0.7199282436378805,
      0.6990946662152006,
      0.7052533402741629,
      0.6995205770365609,
      0.6563983111452893,
      0.7005386365408195,
      0.7052039727489126,
      0.6909415858962568,
      0.69516363325643,
      0.6965547613744508,
      0.6965547613744508,
      0.6893879163391348,
      0.7023006233532549,
      0.7023006233532549,
      0.7023006233532549,
      0.7023006233532549
    ],
    "val_recall": [
      0.34063260340632606,
      0.467185234338519,
      0.6135982698026494,
      0.6763056354297229,
      0.6549927498832608,
      0.6542390654312795,
      0.658701368920347,
      0.6768110955458888,
      0.6875445452087788,
      0.7191951960808408,
      0.7272358622723587,
      0.6856775377456642,
      0.70065210089541,
      0.7017506779063957,
      0.7210466383215776,
      0.704821122825989,
      0.7033784724782292,
      0.7037544954819893,
      0.650328098503281,
      0.7100559528783373,
      0.7146976660358656,
      0.6997304758861936,
      0.6989931758788206,
      0.7045966559348554,
      0.7045966559348554,
      0.6941269958301589,
      0.7094628359835172,
      0.7094628359835172,
      0.7094628359835172,
      0.7094628359835172
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.32917705735660846,
        0.04285714285714286
      ],
      [
        0.0851063829787234,
        0.38461538461538464,
        0.5177664974619289
      ],
      [
        0.6359447004608295,
        0.4435483870967742,
        0.6445497630331753
      ],
      [
        0.6634615384615384,
        0.4928909952606635,
        0.7782101167315175
      ],
      [
        0.6818181818181818,
        0.47368421052631576,
        0.7105263157894737
      ],
      [
        0.7480314960629921,
        0.46464646464646464,
        0.6875
      ],
      [
        0.768595041322314,
        0.4246575342465753,
        0.7777777777777778
      ],
      [
        0.7161572052401747,
        0.46706586826347307,
        0.8142857142857143
      ],
      [
        0.6944444444444444,
        0.5198237885462555,
        0.721030042918455
      ],
      [
        0.7692307692307693,
        0.5419354838709678,
        0.8175182481751825
      ],
      [
        0.7627118644067796,
        0.5696969696969697,
        0.8
      ],
      [
        0.7703703703703704,
        0.47619047619047616,
        0.8142857142857143
      ],
      [
        0.7569721115537849,
        0.5222222222222223,
        0.7673469387755102
      ],
      [
        0.7878787878787878,
        0.5135135135135135,
        0.7878787878787878
      ],
      [
        0.74235807860262,
        0.5654450261780105,
        0.765625
      ],
      [
        0.7551867219917012,
        0.5398773006134969,
        0.7794117647058824
      ],
      [
        0.782258064516129,
        0.5072463768115942,
        0.8137931034482758
      ],
      [
        0.7394957983193278,
        0.5502645502645502,
        0.7389558232931727
      ],
      [
        0.7557251908396947,
        0.4,
        0.7959183673469388
      ],
      [
        0.7428571428571429,
        0.5508982035928144,
        0.7878787878787878
      ],
      [
        0.7630522088353414,
        0.5534591194968553,
        0.7910447761194029
      ],
      [
        0.7509881422924901,
        0.535031847133758,
        0.7819548872180451
      ],
      [
        0.7630522088353414,
        0.5100671140939598,
        0.8057553956834532
      ],
      [
        0.7569721115537849,
        0.535031847133758,
        0.7910447761194029
      ],
      [
        0.7569721115537849,
        0.535031847133758,
        0.7910447761194029
      ],
      [
        0.7569721115537849,
        0.5100671140939598,
        0.7971014492753623
      ],
      [
        0.7630522088353414,
        0.535031847133758,
        0.8
      ],
      [
        0.7630522088353414,
        0.535031847133758,
        0.8
      ],
      [
        0.7630522088353414,
        0.535031847133758,
        0.8
      ],
      [
        0.7630522088353414,
        0.535031847133758,
        0.8
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30
    ]
  },
  "test_metrics": {
    "loss": 1.3902444227465562,
    "accuracy": 0.7663043478260869,
    "f1_macro": 0.7268008194554586,
    "precision": 0.7293056871885134,
    "recall": 0.7246938983778021,
    "f1_per_class": [
      0.676923076923077,
      0.6375,
      0.865979381443299
    ],
    "auc_macro": 0.8931153496283503,
    "auc_weighted": 0.9012949040670514,
    "gate_stats": {
      "mean": 0.20522102636426784,
      "std": 0.11764739915117149,
      "min": 0.0,
      "max": 0.38903939723968506,
      "median": 0.25121060013771057,
      "q25": 0.20461588725447655,
      "q75": 0.2837618887424469,
      "sparsity": 0.23354908306364616,
      "activation_rate": 0.0,
      "total_gates": 7416
    }
  }
}