{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "use_pmac": true,
    "gate_bias_init": -1.0,
    "gate_weight_gain": 0.5,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ]
  },
  "best_val_f1": 0.6394475198986477,
  "history": {
    "train_loss": [
      0.6871922366451799,
      0.5828612598410824,
      0.4481023795772017,
      0.3597391807196433,
      0.2938777851430993,
      0.24787775636242146,
      0.20066423969049202,
      0.1822186945692489,
      0.15196855974040532,
      0.13697759480329982,
      0.1154290701082924,
      0.10705112054813326,
      0.10706582756941779,
      0.09765115177683663,
      0.09421530343069319,
      0.08817087960217082,
      0.08305829482381805
    ],
    "val_loss": [
      0.5975557139941624,
      0.42680240103176664,
      0.4211422715868269,
      0.4465621028627668,
      0.5077049434185028,
      0.5681491025856563,
      0.7069148889609745,
      0.8126255997589656,
      0.8125649264880589,
      1.3348392759050642,
      1.4260358682700567,
      1.4651221675532204,
      1.7167149909905024,
      1.6957638561725616,
      1.9280927521841866,
      1.9389699952942985,
      2.0850036399705068
    ],
    "val_accuracy": [
      0.1726315789473684,
      0.4884210526315789,
      0.6378947368421053,
      0.6294736842105263,
      0.6547368421052632,
      0.6947368421052632,
      0.7410526315789474,
      0.7031578947368421,
      0.6947368421052632,
      0.7347368421052631,
      0.7305263157894737,
      0.6989473684210527,
      0.7326315789473684,
      0.6863157894736842,
      0.7010526315789474,
      0.6673684210526316,
      0.7305263157894737
    ],
    "val_f1_macro": [
      0.09814482345900659,
      0.3489115553742237,
      0.548100842097608,
      0.5401600206478255,
      0.5823872174396761,
      0.6086442061738396,
      0.6394475198986477,
      0.616263382048365,
      0.6012100563491266,
      0.6317233573489668,
      0.6265997548186659,
      0.6047581194640018,
      0.6317871595434262,
      0.576618356517854,
      0.6027783860301029,
      0.5753767560664113,
      0.6327233391470002
    ],
    "val_precision": [
      0.05754385964912281,
      0.39154612664738025,
      0.6637506832001093,
      0.6394098895396249,
      0.6679985213694728,
      0.6551200353362591,
      0.6688101238502431,
      0.6335912379977692,
      0.6357472030298794,
      0.6507027568120816,
      0.6509381576387784,
      0.6226906062971637,
      0.6351403011553584,
      0.607205401618929,
      0.6207093324263553,
      0.6072367398683188,
      0.6463163476334416
    ],
    "val_recall": [
      0.3333333333333333,
      0.4705184592829535,
      0.5827950637926648,
      0.5754513346176681,
      0.5976830479929239,
      0.6140901215271467,
      0.6340530454484873,
      0.6194937176644494,
      0.6051736881005174,
      0.6245529061102831,
      0.6199492930100687,
      0.6062508330001333,
      0.6309906340494106,
      0.5784107569093574,
      0.6016766020864381,
      0.5828810899882472,
      0.6277570789865873
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.29443447037701975,
        0.0
      ],
      [
        0.0,
        0.3772609819121447,
        0.6694736842105263
      ],
      [
        0.4166666666666667,
        0.43205574912891986,
        0.7955801104972375
      ],
      [
        0.4065040650406504,
        0.4250871080139373,
        0.7888888888888889
      ],
      [
        0.5343511450381679,
        0.41353383458646614,
        0.7992766726943942
      ],
      [
        0.5673758865248227,
        0.4260869565217391,
        0.8324697754749568
      ],
      [
        0.5986394557823129,
        0.4512820512820513,
        0.868421052631579
      ],
      [
        0.6025641025641025,
        0.41346153846153844,
        0.8327645051194539
      ],
      [
        0.5517241379310345,
        0.416289592760181,
        0.8356164383561644
      ],
      [
        0.5882352941176471,
        0.4530386740331492,
        0.8538961038961039
      ],
      [
        0.5771812080536913,
        0.44919786096256686,
        0.8534201954397395
      ],
      [
        0.5714285714285714,
        0.4117647058823529,
        0.831081081081081
      ],
      [
        0.5988023952095808,
        0.4431818181818182,
        0.8533772652388797
      ],
      [
        0.48951048951048953,
        0.4095238095238095,
        0.830820770519263
      ],
      [
        0.5620915032679739,
        0.41624365482233505,
        0.83
      ],
      [
        0.5103448275862069,
        0.4088888888888889,
        0.8068965517241379
      ],
      [
        0.5987261146496815,
        0.4530386740331492,
        0.8464052287581699
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17
    ]
  },
  "test_metrics": {
    "loss": 0.5525338371333323,
    "accuracy": 0.7815362931642001,
    "f1_macro": 0.6985563338091266,
    "precision": 0.7270209378835576,
    "recall": 0.6875830989013395,
    "f1_per_class": [
      0.6818181818181818,
      0.5298245614035088,
      0.8840262582056893
    ],
    "auc_macro": 0.8989167928094286,
    "auc_weighted": 0.9088839310209661,
    "gate_stats": {
      "mean": 0.22852461106823127,
      "std": 0.12349453222523334,
      "min": 0.0,
      "max": 0.5300233364105225,
      "median": 0.25635187327861786,
      "q25": 0.2080925703048706,
      "q75": 0.3044048249721527,
      "sparsity": 0.18972431077694235,
      "activation_rate": 0.0013784461152882206,
      "total_gates": 15960
    }
  }
}