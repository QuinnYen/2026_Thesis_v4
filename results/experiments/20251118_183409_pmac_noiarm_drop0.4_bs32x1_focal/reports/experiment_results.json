{
  "args": {
    "dataset": "laptops",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "use_pmac": true,
    "gate_bias_init": -1.0,
    "gate_weight_gain": 0.5,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ]
  },
  "best_val_f1": 0.6799944168041164,
  "history": {
    "train_loss": [
      0.7433782588867914,
      0.6107285888422103,
      0.46037045263108756,
      0.3448458690018881,
      0.2647875306152162,
      0.20369128226524308,
      0.15774997784977868,
      0.13132693450010957,
      0.12997244648812784,
      0.09905191377869674,
      0.09531546619144224,
      0.0824273397613849,
      0.07989937486127019,
      0.07298124656968173,
      0.07005063985430059,
      0.06434733801177658,
      0.06068586919545418,
      0.06072064909607261,
      0.05874318115612758,
      0.05650420118278513,
      0.05437301726834405,
      0.050150638873068,
      0.052287669286930134,
      0.05496378413711985
    ],
    "val_loss": [
      0.6626530885696411,
      0.5212411880493164,
      0.47419825196266174,
      0.48480338752269747,
      0.6776732563972473,
      0.6628513664007187,
      0.6850910395383835,
      0.7292353957891464,
      0.9865584313869477,
      1.248592382669449,
      1.1811803311109543,
      1.0642903655767442,
      0.8603512436151505,
      1.1768606930971146,
      0.9302377074956893,
      0.9845719546079635,
      1.0035539805889129,
      1.429632756114006,
      1.3568030387163161,
      1.5259057134389877,
      1.4479742079973221,
      1.4739116579294205,
      1.630908739566803,
      1.4022752791643143
    ],
    "val_accuracy": [
      0.1952662721893491,
      0.2781065088757396,
      0.5355029585798816,
      0.6804733727810651,
      0.6982248520710059,
      0.6627218934911243,
      0.650887573964497,
      0.6686390532544378,
      0.6745562130177515,
      0.7041420118343196,
      0.6923076923076923,
      0.7071005917159763,
      0.6775147928994083,
      0.7071005917159763,
      0.6686390532544378,
      0.6745562130177515,
      0.6745562130177515,
      0.6923076923076923,
      0.6923076923076923,
      0.6775147928994083,
      0.6834319526627219,
      0.6952662721893491,
      0.6893491124260355,
      0.6804733727810651
    ],
    "val_f1_macro": [
      0.10891089108910891,
      0.2312545214689987,
      0.5450021511959672,
      0.6653776567672213,
      0.6570651268786194,
      0.6490374287366768,
      0.6409658357818188,
      0.6526318543257938,
      0.641662206652719,
      0.6610931100488702,
      0.6550473100838065,
      0.6693879779167545,
      0.662900913484571,
      0.6799944168041164,
      0.6522731407213852,
      0.6571280140900394,
      0.6582221688604667,
      0.6576311404723207,
      0.6671749909427551,
      0.6409172449946375,
      0.649665739520812,
      0.6631858236233993,
      0.6545538976989644,
      0.6506392611645082
    ],
    "val_precision": [
      0.0650887573964497,
      0.38240341844418757,
      0.712808833678399,
      0.6922975517890771,
      0.6572247548003868,
      0.6693374422187982,
      0.6839947089947089,
      0.678376759508835,
      0.6472413416366218,
      0.6673894670047379,
      0.6578515428880393,
      0.6759137836303643,
      0.6867031661149309,
      0.6878817413905134,
      0.6757968799172773,
      0.6774602852357509,
      0.6804032410024495,
      0.6604084186242021,
      0.6754483611626471,
      0.6439321342572116,
      0.6529945065273743,
      0.6675799986858534,
      0.6584291187739464,
      0.6574841358715939
    ],
    "val_recall": [
      0.3333333333333333,
      0.3988424389884244,
      0.5993085764375302,
      0.6834721915013886,
      0.6588455520329001,
      0.6685852851302974,
      0.6637272973039396,
      0.6681445435703344,
      0.6469086649135312,
      0.6634954574127323,
      0.6589979273677571,
      0.6737807925155858,
      0.683223967165573,
      0.6894852826726305,
      0.6681445435703344,
      0.673010723618996,
      0.6755920928670319,
      0.6617234797283459,
      0.6772837867728377,
      0.6442150622199284,
      0.6543160723209386,
      0.6692832624706103,
      0.6591822523696003,
      0.6570817665708176
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.32673267326732675,
        0.0
      ],
      [
        0.0,
        0.3485254691689008,
        0.34523809523809523
      ],
      [
        0.5445026178010471,
        0.43956043956043955,
        0.6509433962264151
      ],
      [
        0.758893280632411,
        0.4946236559139785,
        0.7426160337552743
      ],
      [
        0.7404580152671756,
        0.43661971830985913,
        0.7941176470588235
      ],
      [
        0.7183673469387755,
        0.5,
        0.728744939271255
      ],
      [
        0.6902654867256637,
        0.47761194029850745,
        0.7550200803212851
      ],
      [
        0.7136929460580913,
        0.4731182795698925,
        0.7710843373493976
      ],
      [
        0.7096774193548387,
        0.4358974358974359,
        0.7794117647058824
      ],
      [
        0.7459016393442623,
        0.44285714285714284,
        0.7945205479452054
      ],
      [
        0.7222222222222222,
        0.44,
        0.8029197080291971
      ],
      [
        0.7489711934156379,
        0.4563758389261745,
        0.8028169014084507
      ],
      [
        0.717948717948718,
        0.5081081081081081,
        0.7626459143968871
      ],
      [
        0.7489711934156379,
        0.4968944099378882,
        0.7941176470588235
      ],
      [
        0.7196652719665272,
        0.4782608695652174,
        0.758893280632411
      ],
      [
        0.7257383966244726,
        0.4888888888888889,
        0.7567567567567568
      ],
      [
        0.723404255319149,
        0.4945054945054945,
        0.7567567567567568
      ],
      [
        0.7315175097276264,
        0.4473684210526316,
        0.7940074906367042
      ],
      [
        0.7346938775510204,
        0.4878048780487805,
        0.7790262172284644
      ],
      [
        0.7137254901960784,
        0.423841059602649,
        0.7851851851851852
      ],
      [
        0.7193675889328063,
        0.4444444444444444,
        0.7851851851851852
      ],
      [
        0.7309236947791165,
        0.4645161290322581,
        0.7941176470588235
      ],
      [
        0.7250996015936255,
        0.4444444444444444,
        0.7941176470588235
      ],
      [
        0.7228915662650602,
        0.45,
        0.7790262172284644
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24
    ]
  },
  "test_metrics": {
    "loss": 1.6679939638291086,
    "accuracy": 0.7554347826086957,
    "f1_macro": 0.7223220559513032,
    "precision": 0.7193200965948513,
    "recall": 0.7275090428728554,
    "f1_per_class": [
      0.7067307692307693,
      0.6118143459915611,
      0.848421052631579
    ],
    "auc_macro": 0.8861897405039718,
    "auc_weighted": 0.8958030295872069,
    "gate_stats": {
      "mean": 0.22125598284021067,
      "std": 0.16937501271510025,
      "min": 0.0,
      "max": 0.6294248104095459,
      "median": 0.19556763768196106,
      "q25": 0.11762757413089275,
      "q75": 0.3455248177051544,
      "sparsity": 0.23354908306364616,
      "activation_rate": 0.0714670981661273,
      "total_gates": 7416
    }
  }
}