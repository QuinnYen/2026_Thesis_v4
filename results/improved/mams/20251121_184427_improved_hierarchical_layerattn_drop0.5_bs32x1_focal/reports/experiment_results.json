{
  "args": {
    "dataset": "mams",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": false,
    "virtual_aspect_mode": "none",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical_layerattn",
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.5,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.1,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.1,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.6895332262541229,
  "history": {
    "train_loss": [
      0.8172832802489952,
      0.6279739865550289,
      0.5534791824994264,
      0.490545489832207,
      0.3966186108412566,
      0.3365906924009323,
      0.30516584085093607,
      0.27726817042739305,
      0.24676636634049592,
      0.22820187983689486,
      0.20764351663766084,
      0.18841559208101696,
      0.17427016507696222,
      0.15916923494250687,
      0.15294095788289,
      0.13753453266841395,
      0.13027997309411013,
      0.12232104316353798,
      0.11452679438171563,
      0.10770468496614033,
      0.09971801931107485,
      0.09497465184993215,
      0.09000046716796027,
      0.08756520732961319,
      0.08458063145754514,
      0.08115732040670183,
      0.08338431124058035,
      0.0821974894652764,
      0.07996740498476558,
      0.07693598408389975
    ],
    "val_loss": [
      0.5955620855093002,
      0.5471528265625238,
      0.5601401310414076,
      0.49859948083758354,
      0.4839943591505289,
      0.5243952125310898,
      0.5318831242620945,
      0.575452521443367,
      0.6654229871928692,
      0.7553279884159565,
      0.7482015565037727,
      0.9057242143899202,
      1.0432079266756773,
      1.1370535120368004,
      1.3537154123187065,
      1.1554518416523933,
      1.6762313544750214,
      1.4429409094154835,
      1.38832095451653,
      1.6069071218371391,
      1.7567427642643452,
      1.6281898841261864,
      1.7274401374161243,
      1.8340051881968975,
      2.001099195331335,
      1.9525394067168236,
      2.0302983969449997,
      2.0325191393494606,
      2.0490494333207607,
      2.016140218824148
    ],
    "val_accuracy": [
      0.45338345864661656,
      0.45413533834586467,
      0.4631578947368421,
      0.4706766917293233,
      0.5721804511278196,
      0.5992481203007519,
      0.6112781954887218,
      0.5977443609022557,
      0.6278195488721805,
      0.649624060150376,
      0.6466165413533834,
      0.6609022556390978,
      0.6526315789473685,
      0.6654135338345865,
      0.6819548872180451,
      0.6736842105263158,
      0.6962406015037594,
      0.6894736842105263,
      0.6954887218045113,
      0.6977443609022557,
      0.6947368421052632,
      0.7007518796992481,
      0.7015037593984963,
      0.6992481203007519,
      0.7007518796992481,
      0.7030075187969925,
      0.7030075187969925,
      0.7045112781954888,
      0.7037593984962406,
      0.7015037593984963
    ],
    "val_f1_macro": [
      0.20959082283204333,
      0.2118452691189462,
      0.24219643090048412,
      0.2602418539119306,
      0.45724620330501237,
      0.5248270431341412,
      0.5442119500515562,
      0.5220397628202743,
      0.574014331704572,
      0.6052212385985521,
      0.5986565551393526,
      0.6182841997902027,
      0.6123637881421341,
      0.627440108568337,
      0.6547722843764977,
      0.6380580193258808,
      0.6796619739876925,
      0.6658249726243577,
      0.6701451745175392,
      0.6789050674917495,
      0.6763711355685237,
      0.6797528046163669,
      0.6808899749530729,
      0.6820698636563343,
      0.6844662888724927,
      0.6855366657576086,
      0.6879310506020225,
      0.6895332262541229,
      0.6886483292086248,
      0.6863475578383365
    ],
    "val_precision": [
      0.3177710843373494,
      0.48466566113624937,
      0.28692410087758924,
      0.5053934816589485,
      0.5922470374788936,
      0.6096520590474963,
      0.6570068703651487,
      0.6435633071624247,
      0.6669098698314747,
      0.6660740422894468,
      0.67542532689558,
      0.6735897570733994,
      0.6649749175595816,
      0.6695383981912958,
      0.6807318376068375,
      0.6837254518961564,
      0.6925929843086568,
      0.6886995553754356,
      0.6983846294191123,
      0.6951845655137333,
      0.6920808932286694,
      0.6983451230733838,
      0.7010569662268692,
      0.6975233126143632,
      0.696861360498079,
      0.7002080040550592,
      0.6994163440544403,
      0.7007643347493454,
      0.6998440383660754,
      0.6980876934928529
    ],
    "val_recall": [
      0.33416046319272125,
      0.3351861042183622,
      0.3491081012011245,
      0.357974933293763,
      0.5050585723353915,
      0.5406257608358134,
      0.5476760398890932,
      0.5291133772454103,
      0.5661987474890701,
      0.5976090725978197,
      0.5910457284650833,
      0.6161473884954756,
      0.605041370232668,
      0.6242413900178341,
      0.6453260018301279,
      0.6279275862921774,
      0.6723977697721134,
      0.6575937390941142,
      0.6596899774394148,
      0.6706436499234698,
      0.668031788166822,
      0.6720120139925091,
      0.6716480768543783,
      0.6735414073298545,
      0.6772069940562063,
      0.6777744436109027,
      0.6809056659769338,
      0.6825599256957097,
      0.6817327958363216,
      0.6792514062581579
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.6238341968911917,
        0.0049382716049382715
      ],
      [
        0.0061162079510703364,
        0.6244813278008299,
        0.0049382716049382715
      ],
      [
        0.09239130434782608,
        0.6341979883536263,
        0.0
      ],
      [
        0.10695187165775401,
        0.6399572649572649,
        0.033816425120772944
      ],
      [
        0.5674740484429066,
        0.7004270896888346,
        0.1038374717832957
      ],
      [
        0.5748709122203098,
        0.7165913492575855,
        0.2830188679245283
      ],
      [
        0.5634328358208955,
        0.7169094363521216,
        0.3522935779816514
      ],
      [
        0.5307692307692308,
        0.7107231920199502,
        0.3246268656716418
      ],
      [
        0.5618860510805501,
        0.7283387622149837,
        0.4318181818181818
      ],
      [
        0.610909090909091,
        0.7477906186267845,
        0.4569640062597809
      ],
      [
        0.608534322820037,
        0.7433510638297872,
        0.44408427876823336
      ],
      [
        0.6347107438016529,
        0.7538035961272476,
        0.4663382594417077
      ],
      [
        0.6151142355008787,
        0.7453416149068323,
        0.4766355140186916
      ],
      [
        0.632952691680261,
        0.7572540693559802,
        0.4921135646687697
      ],
      [
        0.6188034188034188,
        0.7618343195266272,
        0.5836791147994468
      ],
      [
        0.6172839506172839,
        0.7619718309859155,
        0.5349182763744428
      ],
      [
        0.6440677966101694,
        0.758893280632411,
        0.6360248447204969
      ],
      [
        0.6501650165016502,
        0.7630402384500745,
        0.5842696629213483
      ],
      [
        0.6416382252559727,
        0.7699115044247787,
        0.5988857938718662
      ],
      [
        0.6600331674958541,
        0.7641653905053599,
        0.6125166444740346
      ],
      [
        0.6588628762541806,
        0.7621247113163973,
        0.6081258191349934
      ],
      [
        0.6623164763458401,
        0.7700453857791225,
        0.6068965517241379
      ],
      [
        0.6588628762541806,
        0.7694633408919124,
        0.6143437077131259
      ],
      [
        0.6610738255033557,
        0.7625676720804331,
        0.622568093385214
      ],
      [
        0.6677631578947368,
        0.7632398753894081,
        0.6223958333333334
      ],
      [
        0.6655737704918033,
        0.7652040030792918,
        0.625832223701731
      ],
      [
        0.6721311475409836,
        0.7621283255086072,
        0.6295336787564767
      ],
      [
        0.6732348111658456,
        0.763921568627451,
        0.6314432989690721
      ],
      [
        0.6721311475409836,
        0.7633228840125392,
        0.6304909560723514
      ],
      [
        0.6721311475409836,
        0.7609375,
        0.625974025974026
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30
    ]
  },
  "test_metrics": {
    "loss": 1.9353731237351894,
    "accuracy": 0.7160030052592036,
    "f1_macro": 0.7032956185892393,
    "precision": 0.7226107226107225,
    "recall": 0.6931307548671803,
    "f1_per_class": [
      0.7252032520325203,
      0.7639939485627837,
      0.6206896551724138
    ],
    "auc_macro": 0.8779324915635698,
    "auc_weighted": 0.873908725915764,
    "layer_attention": [
      0.18641629815101624,
      0.30623385310173035,
      0.5073497891426086
    ]
  },
  "layer_attention": [
    0.18641629815101624,
    0.30623385310173035,
    0.5073497891426086
  ]
}