{
  "args": {
    "dataset": "mams",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": false,
    "virtual_aspect_mode": "none",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "iarn",
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "batch_size": 32,
    "epochs": 40,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      3.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.8464878286107336,
  "history": {
    "train_loss": [
      0.6939381564104998,
      0.5301770373626992,
      0.40014685304076586,
      0.2761073179818966,
      0.1841716722205833,
      0.11618697199004668,
      0.07725279521611002,
      0.05023115404226162,
      0.03871824772321378,
      0.028540139411645078,
      0.022229405415149544,
      0.01750471847039147,
      0.01619525613178094,
      0.013318947096585935,
      0.01233719322610543,
      0.009863777130683754,
      0.007957278353704304,
      0.00425508402248077,
      0.005024123533601394,
      0.009582145437572628,
      0.003596039754777141,
      0.002684671580519299,
      0.004726712746646121,
      0.0030252069155519874,
      0.003445713160181185,
      0.0015440600424140199
    ],
    "val_loss": [
      0.5541551560163498,
      0.47683780640363693,
      0.3532765470445156,
      0.3019547192379832,
      0.2703034430742264,
      0.36594241112470627,
      0.38121921848505735,
      0.5150115191936493,
      0.6582625862210989,
      0.6451024562120438,
      0.7282880172133446,
      0.7075713314116001,
      0.7922557350248098,
      0.8040025103837252,
      0.9031719136983156,
      0.9084162227809429,
      0.9823468886315823,
      1.0208437964320183,
      1.0376305524259806,
      1.03594221919775,
      1.0805746391415596,
      1.1089730821549892,
      1.021540567278862,
      1.1862983871251345,
      1.041631143540144,
      1.121878307312727
    ],
    "val_accuracy": [
      0.45338345864661656,
      0.5924812030075188,
      0.7511278195488722,
      0.8075187969924812,
      0.8210526315789474,
      0.8278195488721805,
      0.8338345864661654,
      0.8353383458646616,
      0.8315789473684211,
      0.837593984962406,
      0.8383458646616542,
      0.8338345864661654,
      0.8390977443609022,
      0.8533834586466166,
      0.8443609022556391,
      0.8458646616541353,
      0.8421052631578947,
      0.8413533834586466,
      0.8406015037593985,
      0.8421052631578947,
      0.843609022556391,
      0.8451127819548873,
      0.8458646616541353,
      0.8338345864661654,
      0.843609022556391,
      0.843609022556391
    ],
    "val_f1_macro": [
      0.20959082283204333,
      0.5099476837825886,
      0.7330269791421506,
      0.7961347416762993,
      0.8111143064093539,
      0.8204471026476031,
      0.8276519853707168,
      0.8264913620950773,
      0.8248356907438582,
      0.8304063455533971,
      0.8314547244616496,
      0.8246410099917402,
      0.8315124801253745,
      0.8464878286107336,
      0.8377657622915738,
      0.8393015607459233,
      0.8355094529966521,
      0.8355960878920037,
      0.8329907861322233,
      0.8355978927588925,
      0.8370508790255511,
      0.8386180445638821,
      0.8386688364315601,
      0.8275871284885676,
      0.8367106521239499,
      0.8376666786823929
    ],
    "val_precision": [
      0.3177710843373494,
      0.7033229427165887,
      0.7553874271383297,
      0.8103266684149396,
      0.8344483728204373,
      0.8229978403343247,
      0.8363362798671886,
      0.8351526288737822,
      0.8244382169271494,
      0.8310718347861125,
      0.8354017916166733,
      0.8357783527784705,
      0.8353584650749903,
      0.8552547458417369,
      0.842453951375744,
      0.844472247543821,
      0.8371803395224489,
      0.8359982082650138,
      0.8361597131987318,
      0.836168052358892,
      0.8376961334048881,
      0.838054771927856,
      0.8448474974691126,
      0.8257571295515288,
      0.8430654286045319,
      0.8384800469273846
    ],
    "val_recall": [
      0.33416046319272125,
      0.5207128705253237,
      0.7221823038177128,
      0.7870673712384141,
      0.7994649761341434,
      0.8185875589776564,
      0.8214029331508702,
      0.8201020035228588,
      0.8257832590015637,
      0.8297634848272507,
      0.8282047434935658,
      0.8167585302919137,
      0.8289307491708091,
      0.8399493829501331,
      0.8338517046844128,
      0.8354048402210443,
      0.8339546974655753,
      0.8352138034508627,
      0.8302628953941782,
      0.835344275629347,
      0.8369236265110233,
      0.8392745439107031,
      0.8337680573989652,
      0.8296767048905083,
      0.8319833255017052,
      0.8369498418560685
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.6238341968911917,
        0.0049382716049382715
      ],
      [
        0.561122244488978,
        0.6958083832335329,
        0.2729124236252546
      ],
      [
        0.7009966777408638,
        0.8078668683812406,
        0.6902173913043478
      ],
      [
        0.762987012987013,
        0.8453125,
        0.7801047120418848
      ],
      [
        0.8025682182985554,
        0.8545316070068545,
        0.7762430939226519
      ],
      [
        0.803680981595092,
        0.8597063621533442,
        0.7979539641943734
      ],
      [
        0.8125984251968504,
        0.8573705179282869,
        0.812987012987013
      ],
      [
        0.794912559618442,
        0.8660287081339713,
        0.8185328185328186
      ],
      [
        0.7912772585669782,
        0.8571428571428571,
        0.8260869565217391
      ],
      [
        0.8024691358024691,
        0.8668320926385442,
        0.821917808219178
      ],
      [
        0.8055987558320373,
        0.8643379366368806,
        0.8244274809160306
      ],
      [
        0.7993527508090615,
        0.866877971473851,
        0.8076923076923077
      ],
      [
        0.8085758039816233,
        0.8694241686942417,
        0.8165374677002584
      ],
      [
        0.8285714285714286,
        0.879489225857941,
        0.8314028314028314
      ],
      [
        0.8194662480376766,
        0.8710462287104623,
        0.8227848101265823
      ],
      [
        0.8260869565217391,
        0.8732849071832123,
        0.8185328185328186
      ],
      [
        0.8167701863354038,
        0.8707818930041152,
        0.818976279650437
      ],
      [
        0.8246153846153846,
        0.8692052980132451,
        0.8129675810473815
      ],
      [
        0.8130841121495327,
        0.8727569331158238,
        0.8131313131313131
      ],
      [
        0.821917808219178,
        0.8722176422093982,
        0.8126582278481013
      ],
      [
        0.8212121212121212,
        0.8731466227347611,
        0.816793893129771
      ],
      [
        0.8188736681887366,
        0.8744804655029094,
        0.8225
      ],
      [
        0.8173076923076923,
        0.8742903487429035,
        0.8244084682440846
      ],
      [
        0.808446455505279,
        0.8633696563285834,
        0.8109452736318408
      ],
      [
        0.8174474959612278,
        0.8720456397718012,
        0.8206388206388207
      ],
      [
        0.8202764976958525,
        0.8696369636963697,
        0.823086574654956
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26
    ]
  },
  "test_metrics": {
    "loss": 0.7741430420428514,
    "accuracy": 0.8489857250187829,
    "f1_macro": 0.8435952018863001,
    "precision": 0.8448425924009172,
    "recall": 0.8427097869027489,
    "f1_per_class": [
      0.822289156626506,
      0.8702040816326531,
      0.8382923673997412
    ],
    "auc_macro": 0.9432149558256323,
    "auc_weighted": 0.9442266565705069,
    "confusion_matrix": [
      [
        273,
        40,
        16
      ],
      [
        36,
        533,
        38
      ],
      [
        26,
        45,
        324
      ]
    ]
  }
}