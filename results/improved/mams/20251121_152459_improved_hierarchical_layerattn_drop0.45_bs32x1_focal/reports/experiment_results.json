{
  "args": {
    "dataset": "mams",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": false,
    "virtual_aspect_mode": "none",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical_layerattn",
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.45,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 8,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.05,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.7053680974707301,
  "history": {
    "train_loss": [
      0.8127199512940866,
      0.6645560211605496,
      0.5933431300852033,
      0.48547271644627604,
      0.4056271654588205,
      0.3533882328757533,
      0.31367386336679814,
      0.2857395849846028,
      0.25772878715285547,
      0.23156275583638086,
      0.20841118257354807,
      0.19000102253975693,
      0.17286528834590206,
      0.1667661628237477,
      0.1511561007687339,
      0.14053436992345034,
      0.13048280496840123,
      0.12197323132444311,
      0.11228345308314872,
      0.10381430452344594,
      0.10069615153802766,
      0.09415235042020127,
      0.08939391987191306,
      0.0844066772678936,
      0.08206597097493984,
      0.07815869732035531,
      0.08150225724611017,
      0.07579476136576246,
      0.0767306073948189,
      0.07632663044388648
    ],
    "val_loss": [
      0.6466507315635681,
      0.5964812710881233,
      0.5927540827542543,
      0.49331988021731377,
      0.4988690111786127,
      0.5183949358761311,
      0.5702777467668056,
      0.6063979417085648,
      0.6902354955673218,
      0.8879660274833441,
      0.8742159865796566,
      0.9169258996844292,
      1.033975901082158,
      1.0617260597646236,
      1.1384653262794018,
      1.0938931964337826,
      1.3304877988994122,
      1.2690710425376892,
      1.253005962818861,
      1.5242375917732716,
      1.5319215022027493,
      1.4951570816338062,
      1.5331525430083275,
      1.592891238629818,
      1.6842550039291382,
      1.6238540075719357,
      1.714359637349844,
      1.7102541849017143,
      1.7067884877324104,
      1.7131475880742073
    ],
    "val_accuracy": [
      0.45338345864661656,
      0.46541353383458645,
      0.46541353383458645,
      0.5984962406015037,
      0.6135338345864662,
      0.6225563909774436,
      0.6285714285714286,
      0.6323308270676692,
      0.6518796992481203,
      0.6721804511278195,
      0.674436090225564,
      0.6819548872180451,
      0.675187969924812,
      0.6902255639097744,
      0.706766917293233,
      0.7007518796992481,
      0.7135338345864661,
      0.6992481203007519,
      0.6977443609022557,
      0.7157894736842105,
      0.7082706766917293,
      0.7142857142857143,
      0.7172932330827068,
      0.7142857142857143,
      0.7180451127819549,
      0.7142857142857143,
      0.7172932330827068,
      0.7135338345864661,
      0.7127819548872181,
      0.7135338345864661
    ],
    "val_f1_macro": [
      0.20959082283204333,
      0.24422497869293558,
      0.2506487062251547,
      0.5229572308403828,
      0.549193945261792,
      0.562088964486536,
      0.5744950045472241,
      0.57923734523956,
      0.609469021859644,
      0.638626876955935,
      0.6446951584159958,
      0.6534231600758452,
      0.6442501880497251,
      0.6656157171333169,
      0.6861111109695971,
      0.6790813611406851,
      0.7005532859120533,
      0.679612416136472,
      0.6799757324081862,
      0.7035242160581702,
      0.6931718309417136,
      0.6995597668248582,
      0.7024519261650605,
      0.7000150335072504,
      0.7053680974707301,
      0.6994726905554884,
      0.7036885430595436,
      0.6999413779507432,
      0.6991495347701632,
      0.699854975575083
    ],
    "val_precision": [
      0.3177710843373494,
      0.5171852524793702,
      0.2871533228676086,
      0.637344808798992,
      0.6389200702608335,
      0.6507634376798873,
      0.6490792249870224,
      0.6531882037167449,
      0.6725964579380138,
      0.6747859916359605,
      0.6800609897708413,
      0.6837828110222627,
      0.677422334926093,
      0.6873376152601146,
      0.7041630883736146,
      0.7093606887337036,
      0.7126482810463716,
      0.6972725728375132,
      0.7016910487907299,
      0.7111979900890429,
      0.7046438651802415,
      0.7069917617424611,
      0.7123854414584877,
      0.7117317317317317,
      0.712058457900003,
      0.7097276079638442,
      0.710472483581869,
      0.7067944942270442,
      0.7061233755116989,
      0.7065830736254854
    ],
    "val_recall": [
      0.33416046319272125,
      0.34972798144591094,
      0.35312888661725866,
      0.5398473244684797,
      0.5556707858283252,
      0.5680533869731169,
      0.5737789941990993,
      0.5780382458251926,
      0.6001166775210286,
      0.6347905657733115,
      0.6351632413597905,
      0.644576913459134,
      0.6354697465575184,
      0.6595370271139213,
      0.6779586105317539,
      0.6668207711268477,
      0.6929311998329252,
      0.6713278319579895,
      0.6692540717596982,
      0.6980718806075146,
      0.6861974284779985,
      0.6950243055269311,
      0.696171680282708,
      0.6927395585160027,
      0.7004783613485789,
      0.6931365808485088,
      0.6988309714791335,
      0.6950436510226458,
      0.6942165211632578,
      0.6950436510226458
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.6238341968911917,
        0.0049382716049382715
      ],
      [
        0.052478134110787174,
        0.632577754348972,
        0.047619047619047616
      ],
      [
        0.11548556430446194,
        0.6364605543710021,
        0.0
      ],
      [
        0.5902777777777778,
        0.7064045656309448,
        0.27218934911242604
      ],
      [
        0.5809859154929577,
        0.7211413748378729,
        0.34545454545454546
      ],
      [
        0.6089965397923875,
        0.7245430809399478,
        0.3527272727272727
      ],
      [
        0.5865724381625441,
        0.7307692307692307,
        0.4061433447098976
      ],
      [
        0.5925925925925926,
        0.7335548172757476,
        0.41156462585034015
      ],
      [
        0.5974499089253188,
        0.7442176870748299,
        0.48673946957878317
      ],
      [
        0.644122383252818,
        0.7586206896551724,
        0.5131375579598145
      ],
      [
        0.6482758620689655,
        0.758273381294964,
        0.527536231884058
      ],
      [
        0.6474576271186441,
        0.764748725418791,
        0.5480631276901005
      ],
      [
        0.626916524701874,
        0.7601156069364162,
        0.5457184325108854
      ],
      [
        0.6538461538461539,
        0.7662434652725915,
        0.5767575322812052
      ],
      [
        0.659016393442623,
        0.7744874715261959,
        0.6248294679399727
      ],
      [
        0.6666666666666666,
        0.7686622320768662,
        0.6019151846785226
      ],
      [
        0.6919275123558485,
        0.7670588235294118,
        0.6426735218508998
      ],
      [
        0.6633663366336634,
        0.7665399239543726,
        0.6089309878213802
      ],
      [
        0.6620689655172414,
        0.760670731707317,
        0.6171875
      ],
      [
        0.6861788617886179,
        0.7686148919135308,
        0.6557788944723618
      ],
      [
        0.6797385620915033,
        0.7677873338545739,
        0.6319895968790638
      ],
      [
        0.6782334384858044,
        0.7721518987341772,
        0.6482939632545932
      ],
      [
        0.6828478964401294,
        0.7751572327044025,
        0.6493506493506493
      ],
      [
        0.6852459016393443,
        0.7705559906029757,
        0.6442432082794308
      ],
      [
        0.6838709677419355,
        0.7714514835605453,
        0.6607818411097099
      ],
      [
        0.6817447495961227,
        0.7717647058823529,
        0.6449086161879896
      ],
      [
        0.680577849117175,
        0.7731629392971247,
        0.6573248407643312
      ],
      [
        0.6784565916398714,
        0.7699680511182109,
        0.6513994910941476
      ],
      [
        0.6773675762439807,
        0.7687400318979266,
        0.6513409961685823
      ],
      [
        0.6773675762439807,
        0.7699680511182109,
        0.6522292993630573
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30
    ]
  },
  "test_metrics": {
    "loss": 1.5664104595780373,
    "accuracy": 0.7257700976709242,
    "f1_macro": 0.7161000334374948,
    "precision": 0.7278394969220267,
    "recall": 0.7085721536988757,
    "f1_per_class": [
      0.7400318979266348,
      0.7692307692307693,
      0.6390374331550802
    ],
    "auc_macro": 0.879935460172001,
    "auc_weighted": 0.8756096827720578
  }
}