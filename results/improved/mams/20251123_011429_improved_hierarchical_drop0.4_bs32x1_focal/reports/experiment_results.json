{
  "args": {
    "dataset": "mams",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": false,
    "virtual_aspect_mode": "none",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical",
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "batch_size": 32,
    "epochs": 40,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      3.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.8281639129735248,
  "history": {
    "train_loss": [
      0.8284330906691375,
      0.5534860836135016,
      0.3818500167793698,
      0.2600219048835613,
      0.18511902458137935,
      0.12659818949522794,
      0.088084693018485,
      0.05791548662301567,
      0.03888418390243142,
      0.03141287169074295,
      0.023178456654272008,
      0.020021863777569874,
      0.014494430901228312,
      0.016570988574703398,
      0.011928919949342445,
      0.009220435366512026,
      0.00857053016866471,
      0.00804961526381602,
      0.005997214515486525,
      0.005999670991662208,
      0.006391895943980435,
      0.0059172094273957625,
      0.005075000742544944,
      0.002982705898271147,
      0.0036026027688354522,
      0.004962928734932103,
      0.0030334111471718105
    ],
    "val_loss": [
      0.570776104927063,
      0.4254978895187378,
      0.3175870645791292,
      0.30129525903612375,
      0.3285627579316497,
      0.38684996496886015,
      0.491115665063262,
      0.5840199235826731,
      0.6573415156453848,
      0.7605307791382074,
      0.7987455110996962,
      0.8377374093979597,
      0.812960421666503,
      0.9106024708598852,
      0.9658788852393627,
      1.0775966886430979,
      1.042237525805831,
      1.011168697848916,
      1.0831074267625809,
      1.0022456478327513,
      1.0315044485032558,
      1.0644139796495438,
      1.1734012439846992,
      1.197931107133627,
      1.1534736528992653,
      1.1392807140946388,
      1.127578429877758
    ],
    "val_accuracy": [
      0.45263157894736844,
      0.674436090225564,
      0.7571428571428571,
      0.8142857142857143,
      0.8157894736842105,
      0.8180451127819549,
      0.8308270676691729,
      0.8293233082706767,
      0.8195488721804511,
      0.8233082706766918,
      0.8218045112781955,
      0.8308270676691729,
      0.8240601503759398,
      0.8210526315789474,
      0.8338345864661654,
      0.8270676691729323,
      0.8180451127819549,
      0.8210526315789474,
      0.8278195488721805,
      0.8293233082706767,
      0.825563909774436,
      0.8300751879699249,
      0.8315789473684211,
      0.825563909774436,
      0.825563909774436,
      0.8210526315789474,
      0.824812030075188
    ],
    "val_f1_macro": [
      0.20772946859903382,
      0.6505908915814471,
      0.7420345115767598,
      0.8067790110618088,
      0.809091780428783,
      0.8096516563534314,
      0.8245225043248547,
      0.821666946056668,
      0.8135832638517152,
      0.8174954874053671,
      0.8134344206750911,
      0.8237614201800268,
      0.8157990607401929,
      0.8129484394206021,
      0.8281639129735248,
      0.8212806521630514,
      0.81225394893595,
      0.8145915035339937,
      0.8228028249533041,
      0.8226529614191529,
      0.8186829993796737,
      0.8245560505212529,
      0.8274501643246156,
      0.8210994791414769,
      0.8191663986241183,
      0.8157532030159067,
      0.8191611689081219
    ],
    "val_precision": [
      0.15087719298245614,
      0.689449571419969,
      0.7944084740152267,
      0.8160236855828682,
      0.8171105985735211,
      0.8193138426304207,
      0.8235313863080571,
      0.8262208403515888,
      0.8139467333432852,
      0.8199855860308047,
      0.817211705845211,
      0.8329833081885871,
      0.8272539054692688,
      0.8185676695584249,
      0.8308703462177262,
      0.821154045156497,
      0.811809927369025,
      0.817325685909898,
      0.8229486055065435,
      0.8253746904455258,
      0.8227873584008704,
      0.8257596109760191,
      0.8251200678456273,
      0.8192546212457718,
      0.8208270789737675,
      0.8174918464089916,
      0.8201281564731419
    ],
    "val_recall": [
      0.3333333333333333,
      0.6370359622872751,
      0.7225106826157089,
      0.7999275093498649,
      0.8033721067629545,
      0.803737307953362,
      0.8259711631204505,
      0.8178596847013951,
      0.813665339411776,
      0.8160143882124377,
      0.8105846791368171,
      0.816929562060845,
      0.80774748632213,
      0.8084391427527212,
      0.8257514378594649,
      0.8223561384851706,
      0.8131534531984644,
      0.8121658986175114,
      0.8227375525199981,
      0.8203916363706312,
      0.8158627019392211,
      0.8237769332443001,
      0.8301767200041769,
      0.8232375676336666,
      0.8177991201096978,
      0.8147502809768375,
      0.8182379660849278
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.6231884057971014,
        0.0
      ],
      [
        0.6048237476808905,
        0.7404129793510325,
        0.6065359477124183
      ],
      [
        0.7339130434782609,
        0.7974230493915533,
        0.6947674418604651
      ],
      [
        0.7864077669902912,
        0.8425259792166268,
        0.7914032869785083
      ],
      [
        0.7862969004893964,
        0.8404858299595142,
        0.8004926108374384
      ],
      [
        0.7782945736434108,
        0.8469468675654243,
        0.8037135278514589
      ],
      [
        0.7987987987987988,
        0.8576186511240633,
        0.8171500630517023
      ],
      [
        0.7923930269413629,
        0.8576078112286412,
        0.815
      ],
      [
        0.789712556732224,
        0.8439306358381503,
        0.8071065989847716
      ],
      [
        0.8012718600953895,
        0.8502495840266223,
        0.8009650180940893
      ],
      [
        0.7795527156549521,
        0.8529170090386196,
        0.8078335373317014
      ],
      [
        0.8051948051948052,
        0.8580593424218124,
        0.8080301129234629
      ],
      [
        0.7921440261865794,
        0.8537360890302067,
        0.8015170670037927
      ],
      [
        0.7891373801916933,
        0.8532035685320357,
        0.7965043695380774
      ],
      [
        0.8161993769470405,
        0.8592471358428805,
        0.8090452261306532
      ],
      [
        0.8071748878923767,
        0.8535980148883374,
        0.80306905370844
      ],
      [
        0.7951807228915663,
        0.8441127694859039,
        0.7974683544303798
      ],
      [
        0.7912087912087912,
        0.8465955701394585,
        0.8059701492537313
      ],
      [
        0.8103975535168195,
        0.8509933774834437,
        0.8070175438596491
      ],
      [
        0.80370942812983,
        0.8571428571428571,
        0.8071065989847716
      ],
      [
        0.7929373996789727,
        0.8524319868095631,
        0.8106796116504854
      ],
      [
        0.8109756097560976,
        0.8545603944124898,
        0.8081321473951716
      ],
      [
        0.8168168168168168,
        0.8521008403361344,
        0.8134328358208955
      ],
      [
        0.8102409638554217,
        0.847571189279732,
        0.8054862842892768
      ],
      [
        0.7974882260596546,
        0.8526490066225165,
        0.807361963190184
      ],
      [
        0.8025276461295419,
        0.8466666666666667,
        0.7980652962515115
      ],
      [
        0.8006182380216383,
        0.8488852188274154,
        0.8079800498753117
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27
    ]
  },
  "test_metrics": {
    "loss": 0.9831100478768349,
    "accuracy": 0.830954169797145,
    "f1_macro": 0.8249935937556853,
    "precision": 0.8234252363973079,
    "recall": 0.8267460807991851,
    "f1_per_class": [
      0.7982062780269058,
      0.8554817275747508,
      0.8212927756653993
    ],
    "auc_macro": 0.9393595580982805,
    "auc_weighted": 0.9385007786878876,
    "confusion_matrix": [
      [
        267,
        43,
        19
      ],
      [
        41,
        515,
        51
      ],
      [
        32,
        39,
        324
      ]
    ]
  }
}