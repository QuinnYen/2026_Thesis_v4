{
  "args": {
    "dataset": "mams",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": false,
    "virtual_aspect_mode": "none",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical",
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.8264152591417532,
  "history": {
    "train_loss": [
      1.0934113798318086,
      0.6287197907765706,
      0.4355394155890853,
      0.29680730601151784,
      0.21621208875267595,
      0.16182925590762384,
      0.1202691464236489,
      0.08846560607629794,
      0.07273475374612544,
      0.05450048973024995,
      0.044617221247473804,
      0.03326980073298155,
      0.027577609445951466,
      0.025625024699278316,
      0.01782258002031422,
      0.018875524312520778,
      0.01448333181189675,
      0.010658233808094842,
      0.0091447491522693,
      0.009938109507654898,
      0.0055769704493286556,
      0.00706290336871731,
      0.006888208881867252,
      0.006436892374767922,
      0.004527519641541639,
      0.0033078810715340768,
      0.0026690678406912074,
      0.006547696954031481,
      0.003507781878060659,
      0.0023482207960316575
    ],
    "val_loss": [
      0.6938292570412159,
      0.47494804859161377,
      0.3843780644237995,
      0.290366904810071,
      0.3067373624071479,
      0.4182524364441633,
      0.5446776212193072,
      0.6135360989719629,
      0.8125273678451777,
      0.6679224204272032,
      0.792325078509748,
      1.1039792820811272,
      1.2740785274654627,
      1.1033652033656836,
      1.4373614452779293,
      1.692848265171051,
      1.4414540976285934,
      1.543362945318222,
      1.5582217685878277,
      1.8388639017939568,
      1.814145602285862,
      1.7612069360911846,
      1.9822872206568718,
      1.6571805030107498,
      1.7766582667827606,
      1.77586093172431,
      1.8546007871627808,
      1.8072364628314972,
      1.8087757006287575,
      1.8017237335443497
    ],
    "val_accuracy": [
      0.45263157894736844,
      0.5684210526315789,
      0.6360902255639098,
      0.7699248120300752,
      0.7992481203007519,
      0.8165413533834587,
      0.8195488721804511,
      0.824812030075188,
      0.8142857142857143,
      0.8067669172932331,
      0.8157894736842105,
      0.8270676691729323,
      0.8195488721804511,
      0.8270676691729323,
      0.8157894736842105,
      0.8195488721804511,
      0.8203007518796992,
      0.824812030075188,
      0.8240601503759398,
      0.8225563909774436,
      0.8218045112781955,
      0.8285714285714286,
      0.824812030075188,
      0.8300751879699249,
      0.8293233082706767,
      0.8338345864661654,
      0.8285714285714286,
      0.825563909774436,
      0.8263157894736842,
      0.8270676691729323
    ],
    "val_f1_macro": [
      0.20772946859903382,
      0.45595487219578756,
      0.5717658771243467,
      0.7535463964019645,
      0.7847456813955495,
      0.8064693585989388,
      0.8115385099011997,
      0.8146160691634868,
      0.8053725350080595,
      0.7960600436769233,
      0.8067286889519086,
      0.8187846315313368,
      0.8127579330779532,
      0.8182288280739175,
      0.808112054124232,
      0.8121656138363701,
      0.8118061683698876,
      0.8182081292236948,
      0.8144834900892958,
      0.8151560984214948,
      0.8140390494845654,
      0.820750719344962,
      0.8179621680747712,
      0.8212699146969019,
      0.8225671488625544,
      0.8264152591417532,
      0.8217271872720934,
      0.818009786268377,
      0.8189774676617737,
      0.819620910547339
    ],
    "val_precision": [
      0.15087719298245614,
      0.6697919364935457,
      0.7885973607147184,
      0.8269099708777737,
      0.8258177909602198,
      0.8199961193404922,
      0.8179046701711502,
      0.8261359628733568,
      0.8137708263228319,
      0.8187405614958667,
      0.8157003661142862,
      0.8239304936073791,
      0.8141440943941186,
      0.8265932147925031,
      0.8112378613106158,
      0.812257365049974,
      0.816482494114073,
      0.8214222835647961,
      0.8219324683051212,
      0.8173020925920609,
      0.8166477893998474,
      0.8235582358498625,
      0.8196779255602785,
      0.8269919516170247,
      0.8249840356300727,
      0.8290413980712489,
      0.8235124042600535,
      0.8210559500895998,
      0.8218908420567517,
      0.8226124700700458
    ],
    "val_recall": [
      0.3333333333333333,
      0.4948140331786244,
      0.5585810738398885,
      0.7289685608215241,
      0.7663429593662151,
      0.7975135542127291,
      0.8073279858426146,
      0.8069078808163579,
      0.7996316111995032,
      0.7832588366871938,
      0.800139760214779,
      0.8145580351131739,
      0.8115304100750462,
      0.8119249592617935,
      0.806229909125633,
      0.8125004877593024,
      0.8079603417337852,
      0.8155786748885023,
      0.8094142216872898,
      0.813771464844233,
      0.8126222214894382,
      0.8183996548587696,
      0.8172716255987074,
      0.8167241810452612,
      0.820567669389875,
      0.8240884396923406,
      0.820287379537192,
      0.8157128842650222,
      0.8167385252906634,
      0.8172922351466987
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.6231884057971014,
        0.0
      ],
      [
        0.5686653771760155,
        0.6850439882697947,
        0.1141552511415525
      ],
      [
        0.47874720357941836,
        0.7186932849364791,
        0.5178571428571429
      ],
      [
        0.7355072463768116,
        0.8080949057920447,
        0.717037037037037
      ],
      [
        0.7452339688041595,
        0.8361498897869214,
        0.7728531855955678
      ],
      [
        0.775974025974026,
        0.8501960784313726,
        0.7932379713914174
      ],
      [
        0.7987616099071208,
        0.8525641025641025,
        0.783289817232376
      ],
      [
        0.7859424920127795,
        0.8605200945626478,
        0.7973856209150327
      ],
      [
        0.7737704918032787,
        0.8462783171521036,
        0.7960687960687961
      ],
      [
        0.7649006622516556,
        0.8388082505729565,
        0.784471218206158
      ],
      [
        0.782051282051282,
        0.8494023904382471,
        0.7887323943661971
      ],
      [
        0.7936507936507936,
        0.8596918085969181,
        0.8030112923462986
      ],
      [
        0.790625,
        0.8486352357320099,
        0.7990135635018496
      ],
      [
        0.7877813504823151,
        0.8582866293034428,
        0.8086185044359949
      ],
      [
        0.7776,
        0.845771144278607,
        0.8009650180940893
      ],
      [
        0.7831513260530422,
        0.8509212730318257,
        0.8024242424242424
      ],
      [
        0.7821939586645469,
        0.8527257933279089,
        0.800498753117207
      ],
      [
        0.7987616099071208,
        0.8517915309446255,
        0.8040712468193384
      ],
      [
        0.7777777777777778,
        0.8578391551584078,
        0.8078335373317014
      ],
      [
        0.7892234548335975,
        0.8538205980066446,
        0.8024242424242424
      ],
      [
        0.784688995215311,
        0.8535773710482529,
        0.8038507821901324
      ],
      [
        0.7898894154818326,
        0.8585526315789473,
        0.813810110974106
      ],
      [
        0.7923930269413629,
        0.8538011695906432,
        0.8076923076923077
      ],
      [
        0.7904,
        0.8629359286293593,
        0.8104738154613467
      ],
      [
        0.8012618296529969,
        0.858085808580858,
        0.8083538083538083
      ],
      [
        0.8006279434850864,
        0.8637110016420362,
        0.8149068322981367
      ],
      [
        0.7987421383647799,
        0.8576158940397351,
        0.8088235294117647
      ],
      [
        0.7917329093799682,
        0.8564356435643564,
        0.8058608058608059
      ],
      [
        0.7936507936507936,
        0.8564356435643564,
        0.8068459657701712
      ],
      [
        0.7936507936507936,
        0.8573784006595219,
        0.8078335373317014
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30
    ]
  },
  "test_metrics": {
    "loss": 2.0169707238674164,
    "accuracy": 0.8392186326070623,
    "f1_macro": 0.8348656084778702,
    "precision": 0.8337940575607811,
    "recall": 0.8359910289564813,
    "f1_per_class": [
      0.8205128205128205,
      0.8583264291632146,
      0.8257575757575758
    ],
    "auc_macro": 0.9339121289199143,
    "auc_weighted": 0.9336864696384003
  }
}