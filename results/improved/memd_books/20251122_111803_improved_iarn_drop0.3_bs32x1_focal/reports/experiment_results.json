{
  "args": {
    "dataset": "memd_books",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": false,
    "virtual_aspect_mode": "none",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "iarn",
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.6955436720142602,
  "history": {
    "train_loss": [
      0.6849593750455163,
      0.47659294171766803,
      0.44138678366487677,
      0.38885386965491553,
      0.38743124224922876,
      0.24213641543279996,
      0.17658585953441533,
      0.14381568794223396,
      0.1177580752833323,
      0.10450273921543901,
      0.0906207026405768,
      0.08649008924310858,
      0.07826310209929943,
      0.07380082161927765,
      0.07524762582033873,
      0.07590405439788644,
      0.06474224867468531,
      0.06127094680612737,
      0.050935306078331036,
      0.05295443560250781,
      0.05437034897675568,
      0.048495544036003674,
      0.053079423917965454,
      0.04786678060719913
    ],
    "val_loss": [
      0.3743608718117078,
      0.30946191648642224,
      0.3684058537085851,
      0.2739168306191762,
      0.2683255920807521,
      0.21884034325679144,
      0.19312105079491934,
      0.1763985939323902,
      0.17098520944515863,
      0.16799869388341904,
      0.1982369919617971,
      0.16292567799488702,
      0.20507818957169852,
      0.3096893106897672,
      0.330806128680706,
      0.2332124337553978,
      0.3102956662575404,
      0.2836423044403394,
      0.3169025083382924,
      0.3390637934207916,
      0.3415377214550972,
      0.3623916779955228,
      0.30041132618983585,
      0.3547551358739535
    ],
    "val_accuracy": [
      0.7554347826086957,
      0.7554347826086957,
      0.6413043478260869,
      0.6358695652173914,
      0.717391304347826,
      0.8152173913043478,
      0.7934782608695652,
      0.8043478260869565,
      0.7934782608695652,
      0.8097826086956522,
      0.7989130434782609,
      0.8206521739130435,
      0.7934782608695652,
      0.8043478260869565,
      0.7934782608695652,
      0.8043478260869565,
      0.8097826086956522,
      0.7989130434782609,
      0.8043478260869565,
      0.7934782608695652,
      0.8260869565217391,
      0.8206521739130435,
      0.8152173913043478,
      0.8206521739130435
    ],
    "val_f1_macro": [
      0.2868937048503612,
      0.2868937048503612,
      0.32826510721247565,
      0.32692386704466087,
      0.5311549227211878,
      0.5687046152346605,
      0.6291498644027828,
      0.5856261022927689,
      0.5830899735780837,
      0.6628204542338803,
      0.642976505522631,
      0.6955436720142602,
      0.6465532518164098,
      0.47963091118800466,
      0.5959982067435879,
      0.5928027047160621,
      0.5938565549676661,
      0.5916723598576104,
      0.60891675374434,
      0.5904683808742849,
      0.6110465866563427,
      0.6203608541738038,
      0.6031459515214027,
      0.6070695938945917
    ],
    "val_precision": [
      0.25181159420289856,
      0.25181159420289856,
      0.3152335685822651,
      0.31997973937468344,
      0.5346934623712164,
      0.5922222222222222,
      0.5952380952380952,
      0.6018912529550827,
      0.585026085026085,
      0.630212306127638,
      0.622802493015259,
      0.655730234677603,
      0.6225185185185186,
      0.4881045751633987,
      0.6459156785243741,
      0.6049320301089764,
      0.610224586288416,
      0.6005904455179818,
      0.6564364876385337,
      0.5970418470418469,
      0.6258614014711575,
      0.6709330210250405,
      0.6150994270306707,
      0.6203608541738038
    ],
    "val_recall": [
      0.3333333333333333,
      0.3333333333333333,
      0.6067146282973621,
      0.60431654676259,
      0.6969205123705914,
      0.555287477335205,
      0.7011463999532083,
      0.5734193133298239,
      0.696101655261157,
      0.7376878984617184,
      0.6691524828917355,
      0.7654120605954261,
      0.6839504006550857,
      0.47528806223314035,
      0.5743551500263204,
      0.5848833128619056,
      0.5815493946306369,
      0.5882172310931743,
      0.5906153126279464,
      0.5915511493244429,
      0.6002076387670351,
      0.5978095572322629,
      0.5954114756974908,
      0.5978095572322629
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.0,
        0.8606811145510835
      ],
      [
        0.0,
        0.0,
        0.8606811145510835
      ],
      [
        0.0,
        0.14035087719298245,
        0.8444444444444444
      ],
      [
        0.0,
        0.13114754098360656,
        0.849624060150376
      ],
      [
        0.5783132530120482,
        0.18181818181818182,
        0.8333333333333334
      ],
      [
        0.5633802816901409,
        0.25,
        0.8927335640138409
      ],
      [
        0.66,
        0.36363636363636365,
        0.8638132295719845
      ],
      [
        0.5925925925925926,
        0.2857142857142857,
        0.8785714285714286
      ],
      [
        0.5294117647058824,
        0.3333333333333333,
        0.8865248226950354
      ],
      [
        0.6075949367088608,
        0.5,
        0.8808664259927798
      ],
      [
        0.6136363636363636,
        0.4444444444444444,
        0.8708487084870848
      ],
      [
        0.6588235294117647,
        0.5454545454545454,
        0.8823529411764706
      ],
      [
        0.631578947368421,
        0.4444444444444444,
        0.8636363636363636
      ],
      [
        0.56,
        0.0,
        0.8788927335640139
      ],
      [
        0.5882352941176471,
        0.3333333333333333,
        0.8664259927797834
      ],
      [
        0.6190476190476191,
        0.2857142857142857,
        0.8736462093862816
      ],
      [
        0.6172839506172839,
        0.2857142857142857,
        0.8785714285714286
      ],
      [
        0.6206896551724138,
        0.2857142857142857,
        0.8686131386861314
      ],
      [
        0.6206896551724138,
        0.3333333333333333,
        0.8727272727272727
      ],
      [
        0.6222222222222222,
        0.2857142857142857,
        0.8634686346863468
      ],
      [
        0.6585365853658537,
        0.2857142857142857,
        0.8888888888888888
      ],
      [
        0.6428571428571429,
        0.3333333333333333,
        0.8848920863309353
      ],
      [
        0.6428571428571429,
        0.2857142857142857,
        0.8808664259927798
      ],
      [
        0.6506024096385542,
        0.2857142857142857,
        0.8848920863309353
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24
    ]
  },
  "test_metrics": {
    "loss": 0.6805778717223022,
    "accuracy": 0.781496062992126,
    "f1_macro": 0.5752529034865613,
    "precision": 0.5634469696969697,
    "recall": 0.5952395369289102,
    "f1_per_class": [
      0.6666666666666666,
      0.20512820512820512,
      0.8539638386648123
    ],
    "auc_macro": 0.8387874890382251,
    "auc_weighted": 0.8752458381306282
  }
}