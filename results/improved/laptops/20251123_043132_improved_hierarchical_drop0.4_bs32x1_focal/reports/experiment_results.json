{
  "args": {
    "dataset": "laptops",
    "use_augmented": true,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical",
    "auto_select": false,
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "batch_size": 32,
    "epochs": 25,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 8,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.7132029813955487,
  "history": {
    "train_loss": [
      0.7009449132851192,
      0.5409676723536991,
      0.3714784046723729,
      0.25301338004924,
      0.17084009750258355,
      0.12589052235264153,
      0.09942844523383039,
      0.08837489162882169,
      0.061094818925041525,
      0.046536554648940055,
      0.04711770357209302,
      0.032009916715434794,
      0.02349204182835473,
      0.018463591066566074,
      0.014160931169629163,
      0.009125647585841805,
      0.013127420660263548,
      0.009072375815906395,
      0.00760265398552985,
      0.005610768400878268,
      0.005283714423837539
    ],
    "val_loss": [
      0.5330868482589721,
      0.45482924580574036,
      0.3759856462478638,
      0.43423885107040405,
      0.5200399369001388,
      0.5594018459320068,
      0.6012104213237762,
      0.7564383208751678,
      0.8113336563110352,
      0.7133053183555603,
      1.0585262477397919,
      0.9642983317375183,
      1.1610607862472535,
      1.180494064092636,
      1.2118052124977112,
      1.271494483947754,
      1.3058007597923278,
      1.4297038793563843,
      1.3265082955360412,
      1.4173291683197022,
      1.4367364048957825
    ],
    "val_accuracy": [
      0.21005917159763313,
      0.4526627218934911,
      0.606508875739645,
      0.6153846153846154,
      0.6715976331360947,
      0.6153846153846154,
      0.6627218934911243,
      0.6982248520710059,
      0.7071005917159763,
      0.6893491124260355,
      0.727810650887574,
      0.7130177514792899,
      0.742603550295858,
      0.7100591715976331,
      0.7071005917159763,
      0.727810650887574,
      0.7248520710059172,
      0.7337278106508875,
      0.742603550295858,
      0.7396449704142012,
      0.7366863905325444
    ],
    "val_f1_macro": [
      0.1337498676268135,
      0.4576252434697765,
      0.6022758031428231,
      0.6074893847171076,
      0.6347049208747121,
      0.6120779110406808,
      0.6431312136126723,
      0.6530747430028007,
      0.6807912897473788,
      0.6707302573293256,
      0.6941967886971065,
      0.6815460613508759,
      0.7132029813955487,
      0.6768409796728626,
      0.6793857164656018,
      0.6926739846711006,
      0.6914932394245411,
      0.6946348502980454,
      0.7112286798853963,
      0.703346169400925,
      0.7025944377703971
    ],
    "val_precision": [
      0.3993993993993994,
      0.7117238562091504,
      0.6673213882560597,
      0.685802869709424,
      0.6385035942087679,
      0.6859914041314612,
      0.6657584219059629,
      0.6533389239735397,
      0.6881647002199047,
      0.6883880775185123,
      0.6968661049556699,
      0.6822503306878307,
      0.7119339071220084,
      0.6804655579849378,
      0.6857713543821603,
      0.6926859810462623,
      0.692730179979176,
      0.6947749510763209,
      0.7110454912182709,
      0.7023780313253999,
      0.7016802641802643
    ],
    "val_recall": [
      0.34549878345498786,
      0.5357320160239868,
      0.6274832673859437,
      0.6443150073320391,
      0.6370558791483366,
      0.6368592658130371,
      0.6529889323076671,
      0.6537909508712428,
      0.6898457404540129,
      0.68539244840948,
      0.6989530339895303,
      0.6868596754241523,
      0.7191509580803985,
      0.6819893992643383,
      0.6871922796497006,
      0.6965879394103238,
      0.6968804017465818,
      0.6961832436284991,
      0.716641680388639,
      0.706428436842062,
      0.7065767160657671
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.3308270676691729,
        0.07042253521126761
      ],
      [
        0.3905325443786982,
        0.40522875816993464,
        0.5771144278606966
      ],
      [
        0.6967213114754098,
        0.44651162790697674,
        0.663594470046083
      ],
      [
        0.5841584158415841,
        0.46846846846846846,
        0.7698412698412699
      ],
      [
        0.7380073800738007,
        0.4161073825503356,
        0.75
      ],
      [
        0.6542056074766355,
        0.4434389140271493,
        0.7385892116182573
      ],
      [
        0.708171206225681,
        0.449438202247191,
        0.7717842323651453
      ],
      [
        0.7727272727272727,
        0.4172661870503597,
        0.7692307692307693
      ],
      [
        0.7799227799227799,
        0.49079754601226994,
        0.7716535433070866
      ],
      [
        0.7479674796747967,
        0.4943820224719101,
        0.7698412698412699
      ],
      [
        0.7888446215139442,
        0.4966442953020134,
        0.7971014492753623
      ],
      [
        0.7739463601532567,
        0.49333333333333335,
        0.7773584905660378
      ],
      [
        0.7938931297709924,
        0.54421768707483,
        0.8014981273408239
      ],
      [
        0.7851851851851852,
        0.47368421052631576,
        0.7716535433070866
      ],
      [
        0.7874015748031497,
        0.484472049689441,
        0.7662835249042146
      ],
      [
        0.7969924812030075,
        0.4931506849315068,
        0.7878787878787878
      ],
      [
        0.8074074074074075,
        0.4966442953020134,
        0.7704280155642024
      ],
      [
        0.8076923076923077,
        0.4892086330935252,
        0.7870036101083032
      ],
      [
        0.823076923076923,
        0.527027027027027,
        0.7835820895522388
      ],
      [
        0.8164794007490637,
        0.5070422535211268,
        0.7865168539325843
      ],
      [
        0.8089887640449438,
        0.5138888888888888,
        0.7849056603773585
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21
    ]
  },
  "test_metrics": {
    "loss": 1.6904209447758538,
    "accuracy": 0.7445652173913043,
    "f1_macro": 0.6901353018330004,
    "precision": 0.7071094545844788,
    "recall": 0.7076516322758651,
    "f1_per_class": [
      0.6980728051391863,
      0.5113924050632911,
      0.8609406952965235
    ],
    "auc_macro": 0.8994706021507052,
    "auc_weighted": 0.9081086193719883,
    "confusion_matrix": [
      [
        163,
        18,
        15
      ],
      [
        81,
        101,
        64
      ],
      [
        27,
        30,
        421
      ]
    ]
  }
}