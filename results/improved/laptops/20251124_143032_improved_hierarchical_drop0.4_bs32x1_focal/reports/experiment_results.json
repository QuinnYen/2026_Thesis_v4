{
  "args": {
    "dataset": "laptops",
    "use_augmented": true,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical",
    "auto_select": false,
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": null,
    "auto_class_weights": true,
    "seed": 42,
    "contrastive_weight": 0.0,
    "contrastive_temperature": 0.07
  },
  "best_val_f1": 0.7534245809014116,
  "history": {
    "train_loss": [
      0.48882163604911494,
      0.3619211580680341,
      0.23960881938739698,
      0.14800116556639575,
      0.09865503777198646,
      0.0716645242076139,
      0.047291754592894295,
      0.04329999092472147,
      0.03413074619935027,
      0.021329213599009172,
      0.021365519527497948,
      0.018127578365312397,
      0.01507030276769335,
      0.012693838509778512,
      0.00895479706274013,
      0.008205852886170092
    ],
    "val_loss": [
      0.4262944410244624,
      0.32419120023647946,
      0.28520497183005017,
      0.32462357232968014,
      0.3516318326195081,
      0.3300781274835269,
      0.4101180334885915,
      0.38930132736762363,
      0.4229942013820012,
      0.44678110380967456,
      0.4637002299229304,
      0.5355234444141388,
      0.5242630392313004,
      0.5783009628454844,
      0.5406061857938766,
      0.5950865397850672
    ],
    "val_accuracy": [
      0.29533678756476683,
      0.6424870466321243,
      0.6813471502590673,
      0.7098445595854922,
      0.7383419689119171,
      0.7875647668393783,
      0.7564766839378239,
      0.7694300518134715,
      0.7772020725388601,
      0.7538860103626943,
      0.7746113989637305,
      0.7435233160621761,
      0.7694300518134715,
      0.7461139896373057,
      0.7823834196891192,
      0.7253886010362695
    ],
    "val_f1_macro": [
      0.2569151103748822,
      0.6058177453780524,
      0.6452272264223284,
      0.6743695020331734,
      0.7035816742391092,
      0.7534245809014116,
      0.7260670184202375,
      0.7276494487567152,
      0.7371925184035142,
      0.7246999258905257,
      0.7379435131112982,
      0.7161483240100336,
      0.7207341978802403,
      0.716327914648268,
      0.7397112894148964,
      0.6988112583232343
    ],
    "val_precision": [
      0.6604611804527184,
      0.6181425786688944,
      0.6505072729495172,
      0.6808356290174472,
      0.7082871332582114,
      0.7543134494499739,
      0.7290432868102771,
      0.7274854023656955,
      0.7363573986959545,
      0.7264752791068579,
      0.7359424201529464,
      0.7190645309366771,
      0.7252395124716554,
      0.7164625850340136,
      0.7401644354789413,
      0.7071378094346281
    ],
    "val_recall": [
      0.4109644953999099,
      0.6092536545286139,
      0.6515638335448056,
      0.6837701486066328,
      0.7127486693923091,
      0.7630908148276161,
      0.7389949155702702,
      0.7305229504245362,
      0.7382858392416711,
      0.7379858745628436,
      0.7415405412780199,
      0.7308278418763576,
      0.7180136843014822,
      0.7278691252021873,
      0.7392819948428055,
      0.7153289720022861
    ],
    "val_f1_per_class": [
      [
        0.025974025974025976,
        0.33753148614609574,
        0.4072398190045249
      ],
      [
        0.7122302158273381,
        0.3687150837988827,
        0.7365079365079366
      ],
      [
        0.7386759581881533,
        0.43023255813953487,
        0.7667731629392971
      ],
      [
        0.7326007326007326,
        0.47953216374269003,
        0.8109756097560976
      ],
      [
        0.779783393501805,
        0.5088757396449705,
        0.8220858895705522
      ],
      [
        0.8142857142857143,
        0.5766871165644172,
        0.8693009118541033
      ],
      [
        0.8013698630136986,
        0.5402298850574713,
        0.8366013071895425
      ],
      [
        0.8027681660899654,
        0.5333333333333333,
        0.8468468468468469
      ],
      [
        0.8273615635179153,
        0.5555555555555556,
        0.8286604361370716
      ],
      [
        0.8157894736842105,
        0.5529411764705883,
        0.8053691275167785
      ],
      [
        0.8246753246753247,
        0.5637583892617449,
        0.8253968253968254
      ],
      [
        0.7874564459930313,
        0.5454545454545454,
        0.8155339805825242
      ],
      [
        0.8093645484949833,
        0.5185185185185185,
        0.834319526627219
      ],
      [
        0.7931034482758621,
        0.5443786982248521,
        0.8115015974440895
      ],
      [
        0.8157894736842105,
        0.5531914893617021,
        0.8501529051987767
      ],
      [
        0.7526881720430108,
        0.5217391304347826,
        0.8220064724919094
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16
    ]
  },
  "test_metrics": {
    "loss": 0.32705775062952724,
    "accuracy": 0.7597826086956522,
    "f1_macro": 0.7056119629737351,
    "precision": 0.7288547877200674,
    "recall": 0.7214278540616506,
    "f1_per_class": [
      0.7276688453159041,
      0.5219638242894057,
      0.8672032193158954
    ],
    "auc_macro": 0.9044485255437529,
    "auc_weighted": 0.9111832986655014,
    "confusion_matrix": [
      [
        167,
        13,
        16
      ],
      [
        76,
        101,
        69
      ],
      [
        20,
        27,
        431
      ]
    ]
  }
}