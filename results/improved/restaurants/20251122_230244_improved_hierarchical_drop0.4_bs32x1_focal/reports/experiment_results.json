{
  "args": {
    "dataset": "restaurants",
    "use_augmented": true,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical",
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "batch_size": 32,
    "epochs": 25,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 8,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.7098767879807699,
  "history": {
    "train_loss": [
      0.7168707889423036,
      0.5087096330366636,
      0.3652278122149016,
      0.28950094523137077,
      0.194190683987057,
      0.14237309312611296,
      0.09474762045500572,
      0.07763958714183486,
      0.05483021799540311,
      0.049217057185607,
      0.03831937629321035,
      0.027382025834205643,
      0.02198211363365612,
      0.014285359591125152,
      0.014385726019482766,
      0.014364966310064406,
      0.007990983793365956,
      0.006636204475701864,
      0.0034337974647585946,
      0.004183289224002102
    ],
    "val_loss": [
      0.4536130428314209,
      0.380025999886649,
      0.36250764983040945,
      0.3769021374838693,
      0.39918837802750723,
      0.46322000452450346,
      0.6745705434254238,
      0.7676802234990256,
      0.8359194653374808,
      0.8954868997846331,
      0.9676973692008427,
      1.121179461479187,
      1.1593637466430664,
      1.5545378582818168,
      1.8105695247650146,
      1.75988735471453,
      1.57329694713865,
      1.6715490818023682,
      1.6855910590716772,
      1.7651082192148482
    ],
    "val_accuracy": [
      0.3031578947368421,
      0.6105263157894737,
      0.6273684210526316,
      0.7136842105263158,
      0.7263157894736842,
      0.7536842105263157,
      0.751578947368421,
      0.7789473684210526,
      0.7747368421052632,
      0.7389473684210527,
      0.7726315789473684,
      0.791578947368421,
      0.7705263157894737,
      0.7852631578947369,
      0.7894736842105263,
      0.7957894736842105,
      0.7810526315789473,
      0.7747368421052632,
      0.7768421052631579,
      0.7768421052631579
    ],
    "val_f1_macro": [
      0.22298010913571553,
      0.48497153983719804,
      0.5558219402780251,
      0.5903531661510487,
      0.6251261862675355,
      0.667127842127842,
      0.6644462496438109,
      0.6710698343222768,
      0.6874581192763012,
      0.6577337041480388,
      0.6828079755108795,
      0.7098767879807699,
      0.6837700417673199,
      0.6880811497562577,
      0.6864540164462397,
      0.7013151237969755,
      0.6930696114721714,
      0.6765591681091795,
      0.6830065359477123,
      0.6778669136049679
    ],
    "val_precision": [
      0.3943853701135254,
      0.6807682348408773,
      0.6472168276868215,
      0.6577989782783947,
      0.6620843091603135,
      0.6943893970189702,
      0.6778871643952399,
      0.6918158567774936,
      0.6959834591873427,
      0.6555815773755147,
      0.6961554654435064,
      0.7112589112430583,
      0.6922740330823429,
      0.7010180791430791,
      0.7131422004475896,
      0.7231123764290223,
      0.6975575864464755,
      0.6822217541067381,
      0.6846324773375754,
      0.6839265642562758
    ],
    "val_recall": [
      0.4010928961748634,
      0.5392197666387991,
      0.5816119006942677,
      0.5942813783577477,
      0.6310378878751529,
      0.6727496880035865,
      0.6678531617655968,
      0.6580064943719482,
      0.6879599675281401,
      0.6685492469678795,
      0.6779506379266476,
      0.7093465644045412,
      0.6825248688403427,
      0.6774550785746308,
      0.667752293022185,
      0.6850602183369077,
      0.6895756848775642,
      0.6714362739752584,
      0.6814456035767512,
      0.6725291701501218
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.3319838056680162,
        0.33695652173913043
      ],
      [
        0.2524271844660194,
        0.4186046511627907,
        0.7838827838827839
      ],
      [
        0.4806201550387597,
        0.4098939929328622,
        0.7769516728624535
      ],
      [
        0.4566929133858268,
        0.4558139534883721,
        0.8585526315789473
      ],
      [
        0.5390070921985816,
        0.4744186046511628,
        0.8619528619528619
      ],
      [
        0.6216216216216216,
        0.5047619047619047,
        0.875
      ],
      [
        0.6282051282051282,
        0.49746192893401014,
        0.8676716917922948
      ],
      [
        0.6410256410256411,
        0.47904191616766467,
        0.8931419457735247
      ],
      [
        0.65,
        0.5297297297297298,
        0.8826446280991735
      ],
      [
        0.6432748538011696,
        0.47668393782383417,
        0.8532423208191127
      ],
      [
        0.6582278481012658,
        0.5111111111111111,
        0.8790849673202614
      ],
      [
        0.7017543859649122,
        0.5411764705882353,
        0.8866995073891626
      ],
      [
        0.6583850931677019,
        0.5164835164835165,
        0.8764415156507414
      ],
      [
        0.6746987951807228,
        0.5031446540880503,
        0.8864
      ],
      [
        0.6871165644171779,
        0.4864864864864865,
        0.8857589984350548
      ],
      [
        0.7108433734939759,
        0.5066666666666667,
        0.886435331230284
      ],
      [
        0.6863905325443787,
        0.5119047619047619,
        0.8809135399673735
      ],
      [
        0.6744186046511628,
        0.475,
        0.8802588996763754
      ],
      [
        0.6666666666666666,
        0.5,
        0.8823529411764706
      ],
      [
        0.6705202312138728,
        0.4810126582278481,
        0.8820678513731826
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20
    ]
  },
  "test_metrics": {
    "loss": 1.0000560694423162,
    "accuracy": 0.821000704721635,
    "f1_macro": 0.7504695754356016,
    "precision": 0.7585012037632323,
    "recall": 0.7432706295038459,
    "f1_per_class": [
      0.7801980198019802,
      0.5714285714285714,
      0.8997821350762527
    ],
    "auc_macro": 0.9065023188908072,
    "auc_weighted": 0.9151072374859784,
    "confusion_matrix": [
      [
        197,
        35,
        26
      ],
      [
        35,
        142,
        80
      ],
      [
        15,
        63,
        826
      ]
    ]
  }
}