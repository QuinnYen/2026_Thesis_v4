{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical",
    "auto_select": false,
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": null,
    "auto_class_weights": true,
    "seed": 42
  },
  "best_val_f1": 0.7031389537061044,
  "history": {
    "train_loss": [
      0.410498616465351,
      0.33774320310667943,
      0.2410562090706407,
      0.1783382118793956,
      0.12860783633955739,
      0.0879582871535891,
      0.06861739932445057,
      0.049638715164180384,
      0.038419636023606644,
      0.025287395923218707,
      0.021601516649274056,
      0.01765531597004411,
      0.01253799571739428,
      0.012078108342074413,
      0.009236613132024854,
      0.007009207303972768,
      0.005182222346009344,
      0.0040253341029982265,
      0.003996004046042033,
      0.0037925593080632225,
      0.002651868536384172,
      0.0026929875465085437
    ],
    "val_loss": [
      0.2920283717768533,
      0.23101707441466196,
      0.22465279698371887,
      0.23576260677405766,
      0.2701436983687537,
      0.273508044225829,
      0.3294390227113451,
      0.32311143619673593,
      0.40037370792457033,
      0.46313701570034027,
      0.4390817050422941,
      0.4536511387143816,
      0.500731463943209,
      0.5849006175994873,
      0.5520632990768978,
      0.6358734497002193,
      0.6008439234324864,
      0.6427952476910183,
      0.6551408682550702,
      0.6138338659490857,
      0.6420387199946812,
      0.6273537150451115
    ],
    "val_accuracy": [
      0.5831578947368421,
      0.7052631578947368,
      0.7368421052631579,
      0.7242105263157895,
      0.7473684210526316,
      0.7663157894736842,
      0.7663157894736842,
      0.7557894736842106,
      0.7557894736842106,
      0.7768421052631579,
      0.7768421052631579,
      0.7873684210526316,
      0.791578947368421,
      0.7726315789473684,
      0.7705263157894737,
      0.7873684210526316,
      0.7726315789473684,
      0.7642105263157895,
      0.7873684210526316,
      0.7663157894736842,
      0.7789473684210526,
      0.7768421052631579
    ],
    "val_f1_macro": [
      0.41900649502527837,
      0.6097981762220988,
      0.6495013995013995,
      0.6223469748583903,
      0.6519730536842836,
      0.6904973282076369,
      0.6798456281214902,
      0.6843381030573149,
      0.6730854109131262,
      0.686306335076444,
      0.6822439284894584,
      0.7031389537061044,
      0.70248815798986,
      0.6749801384632845,
      0.6883326074964433,
      0.6772984356887418,
      0.6827313777438754,
      0.6642419055769505,
      0.6835632999667641,
      0.6788169932656792,
      0.6840566148087496,
      0.686510881335994
    ],
    "val_precision": [
      0.5481179958791899,
      0.6065017228718297,
      0.6438950480413895,
      0.6501561070675735,
      0.6538429932686424,
      0.7018747558819646,
      0.6971016561964593,
      0.6798152887504173,
      0.6670303088555684,
      0.6946552814674257,
      0.6842287199001501,
      0.7029063371453423,
      0.7052584670231729,
      0.6933397957253641,
      0.6864221818670971,
      0.6972509909218769,
      0.6886598314966097,
      0.6732321016386562,
      0.699059966692817,
      0.68180405024302,
      0.6930547266010524,
      0.6945707456575159
    ],
    "val_recall": [
      0.48264724413265,
      0.6208637757018405,
      0.6588170792289145,
      0.626418523499691,
      0.6518386584760035,
      0.6946454751432761,
      0.6743947875395296,
      0.6994066009959653,
      0.6815737341427065,
      0.6817227654392788,
      0.680614117989168,
      0.703634303854216,
      0.6998758072528565,
      0.666062060024475,
      0.6927504755673488,
      0.6631329286467231,
      0.6795369730895521,
      0.658164007124423,
      0.6717722002108247,
      0.6795075909030327,
      0.6768713726630559,
      0.6819999273018066
    ],
    "val_f1_per_class": [
      [
        0.10309278350515463,
        0.4,
        0.7539267015706806
      ],
      [
        0.5348837209302325,
        0.4583333333333333,
        0.8361774744027304
      ],
      [
        0.6136363636363636,
        0.4835164835164835,
        0.8513513513513513
      ],
      [
        0.547945205479452,
        0.45714285714285713,
        0.8619528619528619
      ],
      [
        0.6588235294117647,
        0.4342857142857143,
        0.8628099173553719
      ],
      [
        0.6918238993710691,
        0.5076142131979695,
        0.8720538720538721
      ],
      [
        0.6794871794871795,
        0.4864864864864865,
        0.8735632183908046
      ],
      [
        0.7011494252873564,
        0.4897959183673469,
        0.8620689655172413
      ],
      [
        0.6853932584269663,
        0.47191011235955055,
        0.8619528619528619
      ],
      [
        0.6951219512195121,
        0.48,
        0.88379705400982
      ],
      [
        0.6892655367231638,
        0.4779874213836478,
        0.8794788273615635
      ],
      [
        0.7126436781609196,
        0.5119047619047619,
        0.8848684210526315
      ],
      [
        0.7167630057803468,
        0.5,
        0.8907014681892332
      ],
      [
        0.6666666666666666,
        0.47191011235955055,
        0.8863636363636364
      ],
      [
        0.686046511627907,
        0.5056179775280899,
        0.8733333333333333
      ],
      [
        0.6946107784431138,
        0.44594594594594594,
        0.8913385826771654
      ],
      [
        0.6867469879518072,
        0.4827586206896552,
        0.8786885245901639
      ],
      [
        0.6585365853658537,
        0.45614035087719296,
        0.8780487804878049
      ],
      [
        0.6982248520710059,
        0.46357615894039733,
        0.8888888888888888
      ],
      [
        0.6706586826347305,
        0.49162011173184356,
        0.8741721854304636
      ],
      [
        0.6867469879518072,
        0.4819277108433735,
        0.883495145631068
      ],
      [
        0.6829268292682927,
        0.4942528735632184,
        0.8823529411764706
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22
    ]
  },
  "test_metrics": {
    "loss": 0.41986499118961784,
    "accuracy": 0.8104298801973221,
    "f1_macro": 0.7297083633118439,
    "precision": 0.7401600358271345,
    "recall": 0.722882064090624,
    "f1_per_class": [
      0.7615384615384615,
      0.5330490405117271,
      0.8945375878853434
    ],
    "auc_macro": 0.9092446175529637,
    "auc_weighted": 0.9205273083870863,
    "confusion_matrix": [
      [
        198,
        30,
        30
      ],
      [
        44,
        125,
        88
      ],
      [
        20,
        57,
        827
      ]
    ]
  }
}