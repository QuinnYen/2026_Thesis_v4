{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "vp_iarn",
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "batch_size": 32,
    "epochs": 25,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 8,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.6991673184410828,
  "history": {
    "train_loss": [
      0.7665937333776239,
      0.6046212258046133,
      0.428927389153263,
      0.3280854959759796,
      0.2379036769270897,
      0.17878218485336556,
      0.14562874032478584,
      0.12008108404514037,
      0.08999289712754258,
      0.0691927325617718,
      0.05782044129119369,
      0.04797461395674761,
      0.03316444985715574,
      0.030447551696724667,
      0.02123692092126268,
      0.013062737026637862,
      0.009454964447190593,
      0.010899896489399109,
      0.005767792860544368,
      0.009270709081503906,
      0.006767142053847732,
      0.0043115101143484935,
      0.004606867733137302
    ],
    "val_loss": [
      0.5626446349280221,
      0.4753500691481999,
      0.4106574313981192,
      0.4164373576641083,
      0.5035085890974317,
      0.706523814371654,
      0.7256012218339103,
      0.8552599804741996,
      0.9531643731253487,
      1.1174881969179427,
      1.1120917541640145,
      1.4926423174994332,
      1.3375300168991089,
      2.0813000542776927,
      1.6199717095920019,
      1.7531676036970956,
      1.7984309537070138,
      1.8569069419588362,
      1.8703829390662057,
      1.7845290899276733,
      1.9676859719412667,
      1.9725962366376604,
      1.9233348029000419
    ],
    "val_accuracy": [
      0.24421052631578946,
      0.4905263157894737,
      0.7157894736842105,
      0.7052631578947368,
      0.7221052631578947,
      0.7094736842105264,
      0.7242105263157895,
      0.72,
      0.7578947368421053,
      0.7642105263157895,
      0.7726315789473684,
      0.7747368421052632,
      0.7768421052631579,
      0.7768421052631579,
      0.7894736842105263,
      0.7684210526315789,
      0.7726315789473684,
      0.7642105263157895,
      0.7747368421052632,
      0.7705263157894737,
      0.7810526315789473,
      0.7810526315789473,
      0.7768421052631579
    ],
    "val_f1_macro": [
      0.17139758678982256,
      0.4062251517053777,
      0.6008702415745563,
      0.60788234693557,
      0.606899581285779,
      0.6093279104643433,
      0.6484310514006235,
      0.6425168607539287,
      0.6819011502970547,
      0.656185623435102,
      0.6731077711642343,
      0.6677742616033756,
      0.681335678026639,
      0.6670376074145957,
      0.6991673184410828,
      0.6652314028799597,
      0.6672314256255231,
      0.6583384711872694,
      0.6726284813156487,
      0.6758341289074931,
      0.6835067437379575,
      0.6826923076923076,
      0.6801756424326885
    ],
    "val_precision": [
      0.37707753311397957,
      0.6619958281634929,
      0.6691736674958152,
      0.6751793893787559,
      0.6482766439909297,
      0.6406881586898762,
      0.6568014238494787,
      0.6358446358446358,
      0.6757049740891574,
      0.6845775145526453,
      0.6903977754685126,
      0.6891655744866755,
      0.6888806155373542,
      0.6960757708782292,
      0.7074074074074074,
      0.6750997635062946,
      0.6807608637722448,
      0.6673616807948228,
      0.6817930208301061,
      0.6767430422153549,
      0.6948616946778712,
      0.693114904341849,
      0.6883128784291062
    ],
    "val_recall": [
      0.3704918032786885,
      0.4896447481613415,
      0.6129299795233422,
      0.6244668799147007,
      0.6091557316467352,
      0.609851816849018,
      0.6519825403172065,
      0.6578816958065259,
      0.6951095319447979,
      0.6428255970339136,
      0.663921401136515,
      0.6528485575466784,
      0.6749469909006095,
      0.6520013206838478,
      0.6933929458519622,
      0.6571004931360789,
      0.6565913028727902,
      0.651942556310809,
      0.6657691468866999,
      0.6751947705766179,
      0.6747149624998485,
      0.6747149624998485,
      0.6730834938751772
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.31477927063339733,
        0.19941348973607037
      ],
      [
        0.2,
        0.37037037037037035,
        0.6483050847457628
      ],
      [
        0.46875,
        0.4675324675324675,
        0.8663282571912013
      ],
      [
        0.5038167938931297,
        0.4691358024691358,
        0.8506944444444444
      ],
      [
        0.49635036496350365,
        0.46153846153846156,
        0.8628099173553719
      ],
      [
        0.5517241379310345,
        0.430622009569378,
        0.8456375838926175
      ],
      [
        0.6748466257668712,
        0.4365482233502538,
        0.8338983050847457
      ],
      [
        0.6480446927374302,
        0.44559585492227977,
        0.8339100346020761
      ],
      [
        0.6742857142857143,
        0.5079365079365079,
        0.863481228668942
      ],
      [
        0.6040268456375839,
        0.48554913294797686,
        0.8789808917197452
      ],
      [
        0.6282051282051282,
        0.5086705202312138,
        0.8824476650563607
      ],
      [
        0.6329113924050633,
        0.4875,
        0.8829113924050633
      ],
      [
        0.6936416184971098,
        0.47435897435897434,
        0.8760064412238325
      ],
      [
        0.6589595375722543,
        0.46715328467153283,
        0.875
      ],
      [
        0.6741573033707865,
        0.5394736842105263,
        0.8838709677419355
      ],
      [
        0.6432748538011696,
        0.4774193548387097,
        0.875
      ],
      [
        0.6390532544378699,
        0.48366013071895425,
        0.8789808917197452
      ],
      [
        0.625,
        0.4768211920529801,
        0.8731942215088283
      ],
      [
        0.6514285714285715,
        0.4868421052631579,
        0.8796147672552167
      ],
      [
        0.651685393258427,
        0.5,
        0.8758169934640523
      ],
      [
        0.6705202312138728,
        0.5,
        0.88
      ],
      [
        0.6666666666666666,
        0.5,
        0.8814102564102564
      ],
      [
        0.6549707602339181,
        0.5063291139240507,
        0.8792270531400966
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23
    ]
  },
  "test_metrics": {
    "loss": 1.5190937609264725,
    "accuracy": 0.8118393234672304,
    "f1_macro": 0.7269398067800105,
    "precision": 0.7436912754332184,
    "recall": 0.7162284352150444,
    "f1_per_class": [
      0.7417475728155339,
      0.5414847161572053,
      0.8975871313672922
    ],
    "auc_macro": 0.9008561769685555,
    "auc_weighted": 0.9128190886090378,
    "confusion_matrix": [
      [
        191,
        34,
        33
      ],
      [
        42,
        124,
        91
      ],
      [
        24,
        43,
        837
      ]
    ]
  }
}