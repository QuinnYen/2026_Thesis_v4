{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hsa",
    "auto_select": false,
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": null,
    "auto_class_weights": true,
    "seed": 42
  },
  "best_val_f1": 0.717503857669595,
  "history": {
    "train_loss": [
      0.3696055407064003,
      0.2716132747499566,
      0.2058060748273866,
      0.15576094532744927,
      0.10945678652639974,
      0.08175110320250194,
      0.05383077275269387,
      0.04970831325963924,
      0.03648719103320649,
      0.025379642541928774,
      0.023859872595047613,
      0.01789619454607498,
      0.012271405205849493,
      0.008806039469179763,
      0.006590256929038125,
      0.005652679192982696,
      0.004707465008035989,
      0.0036676138892959755,
      0.004036415800918915,
      0.0027783733784688814,
      0.003104996682387744,
      0.0023433194637299606
    ],
    "val_loss": [
      0.2538626172712871,
      0.24409084234918868,
      0.23754144992147172,
      0.23051002195903234,
      0.26825020568711416,
      0.28370562195777893,
      0.33079668453761507,
      0.3266278164727347,
      0.4005222235407148,
      0.3918806527342115,
      0.4516854967389788,
      0.4517653286457062,
      0.5269298808915275,
      0.5510087013244629,
      0.5845811154161181,
      0.5824999383517674,
      0.5990457875388009,
      0.5656386741570064,
      0.6131099462509155,
      0.5989900869982583,
      0.6104596938405719,
      0.6282659385885511
    ],
    "val_accuracy": [
      0.6589473684210526,
      0.6989473684210527,
      0.6273684210526316,
      0.7221052631578947,
      0.7473684210526316,
      0.7431578947368421,
      0.7957894736842105,
      0.7410526315789474,
      0.791578947368421,
      0.7873684210526316,
      0.7494736842105263,
      0.8021052631578948,
      0.7936842105263158,
      0.783157894736842,
      0.8,
      0.7368421052631579,
      0.8063157894736842,
      0.783157894736842,
      0.8,
      0.7789473684210526,
      0.7873684210526316,
      0.791578947368421
    ],
    "val_f1_macro": [
      0.58932502596054,
      0.6309806479507054,
      0.5958141655698691,
      0.6449792038027332,
      0.6700460769860207,
      0.6573493884946399,
      0.7041083604340349,
      0.6713926615860291,
      0.6969461462355279,
      0.7015737819858522,
      0.6745406208460395,
      0.717503857669595,
      0.6971884449591457,
      0.7032650843277528,
      0.7164233210406161,
      0.6660294147325335,
      0.712586625720823,
      0.6963476576940876,
      0.7055167451993718,
      0.6876537200897279,
      0.692828628457371,
      0.6927803741253031
    ],
    "val_precision": [
      0.5807664429477611,
      0.6193813662274553,
      0.6087381994013356,
      0.6337310905576589,
      0.664737520731625,
      0.651081631468858,
      0.7087860683237291,
      0.6643424528119999,
      0.7054709635337044,
      0.6989979985123593,
      0.6596955057824623,
      0.724360295551925,
      0.7133732727540778,
      0.702490686993892,
      0.7229624298314393,
      0.6655692114334745,
      0.7283014463157022,
      0.6969284346735328,
      0.7175553319919518,
      0.6904869421238805,
      0.6993646544864843,
      0.7038817291690854
    ],
    "val_recall": [
      0.6328868452618952,
      0.6730710746004628,
      0.6443513503689434,
      0.66436455720742,
      0.6812829413689069,
      0.6663770855294245,
      0.7015072758775278,
      0.6885070214338507,
      0.6912365356887548,
      0.705774962742176,
      0.6968827620466964,
      0.7112845770782595,
      0.684244484024572,
      0.7044206559800322,
      0.7104688427659239,
      0.6785134431076054,
      0.7015817915258139,
      0.6957813844159307,
      0.6958852822507361,
      0.6849563205021022,
      0.6877415700386512,
      0.6834287497122363
    ],
    "val_f1_per_class": [
      [
        0.5866666666666667,
        0.4,
        0.7813084112149533
      ],
      [
        0.6173913043478261,
        0.47337278106508873,
        0.8021778584392014
      ],
      [
        0.656084656084656,
        0.4015748031496063,
        0.7297830374753451
      ],
      [
        0.6417112299465241,
        0.45989304812834225,
        0.8333333333333334
      ],
      [
        0.6551724137931034,
        0.5026737967914439,
        0.8522920203735145
      ],
      [
        0.6703910614525139,
        0.44692737430167595,
        0.8547297297297297
      ],
      [
        0.7111111111111111,
        0.5098039215686274,
        0.8914100486223663
      ],
      [
        0.6966292134831461,
        0.4717948717948718,
        0.8457538994800693
      ],
      [
        0.6853932584269663,
        0.5165562913907285,
        0.8888888888888888
      ],
      [
        0.7027027027027027,
        0.5189873417721519,
        0.8830313014827018
      ],
      [
        0.7040816326530612,
        0.47126436781609193,
        0.8482758620689655
      ],
      [
        0.7251461988304093,
        0.5341614906832298,
        0.8932038834951457
      ],
      [
        0.703030303030303,
        0.4968152866242038,
        0.89171974522293
      ],
      [
        0.7126436781609196,
        0.5207100591715976,
        0.8764415156507414
      ],
      [
        0.7093023255813954,
        0.55,
        0.889967637540453
      ],
      [
        0.6823529411764706,
        0.4723618090452261,
        0.8433734939759037
      ],
      [
        0.7126436781609196,
        0.527027027027027,
        0.8980891719745223
      ],
      [
        0.6931818181818182,
        0.5153374233128835,
        0.8805237315875614
      ],
      [
        0.6976744186046512,
        0.5228758169934641,
        0.896
      ],
      [
        0.6896551724137931,
        0.49382716049382713,
        0.8794788273615635
      ],
      [
        0.6586826347305389,
        0.5269461077844312,
        0.8928571428571429
      ],
      [
        0.6745562130177515,
        0.5095541401273885,
        0.8942307692307693
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22
    ]
  },
  "test_metrics": {
    "loss": 0.43376616310132177,
    "accuracy": 0.8090204369274137,
    "f1_macro": 0.721741488542202,
    "precision": 0.7337331335765778,
    "recall": 0.712008870645057,
    "f1_per_class": [
      0.7276341948310139,
      0.5352697095435685,
      0.9023205612520238
    ],
    "auc_macro": 0.8979135842655118,
    "auc_weighted": 0.9097714364086769,
    "confusion_matrix": [
      [
        183,
        44,
        31
      ],
      [
        46,
        129,
        82
      ],
      [
        16,
        52,
        836
      ]
    ]
  }
}