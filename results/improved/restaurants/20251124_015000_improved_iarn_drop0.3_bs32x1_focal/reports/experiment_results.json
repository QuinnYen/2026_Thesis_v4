{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "iarn",
    "auto_select": false,
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": null,
    "auto_class_weights": true,
    "seed": 42
  },
  "best_val_f1": 0.7033778945451936,
  "history": {
    "train_loss": [
      0.3996569101224866,
      0.31369175696582124,
      0.22759570678075156,
      0.17720255007346472,
      0.12598140688057533,
      0.09584993529215194,
      0.07782144416450408,
      0.058411016341364176,
      0.04168411260960918,
      0.03179468434271321,
      0.025997061153726752,
      0.019740073880376786,
      0.014069197013189918,
      0.011636887946096658,
      0.009935202329009036,
      0.008493001275877632,
      0.0063245151691820895,
      0.0038451732682899505,
      0.0043833519110258,
      0.003372998290024841,
      0.003389506148538969,
      0.002629510481742807,
      0.0025666686981965447,
      0.0027515125633758622,
      0.001695761050302137,
      0.0024672986159873147,
      0.001993114445691677
    ],
    "val_loss": [
      0.3020010420254299,
      0.25366116634437014,
      0.2098682735647474,
      0.2257170272724969,
      0.27128916340214865,
      0.2864868768623897,
      0.28240090182849337,
      0.3281667062214443,
      0.41943049005099703,
      0.4206496945449284,
      0.43678457183497293,
      0.5050765105656215,
      0.5498079508543015,
      0.5748238818986076,
      0.5851796737739018,
      0.5890467464923859,
      0.6446984963757652,
      0.6742268076964787,
      0.6536294605050769,
      0.6752189227512905,
      0.73635390826634,
      0.6569163714136396,
      0.696552825825555,
      0.6948176877839225,
      0.698908052274159,
      0.7075224944523403,
      0.6997559922082084
    ],
    "val_accuracy": [
      0.40210526315789474,
      0.6421052631578947,
      0.7368421052631579,
      0.7010526315789474,
      0.7410526315789474,
      0.7157894736842105,
      0.7452631578947368,
      0.7389473684210527,
      0.7621052631578947,
      0.7410526315789474,
      0.7663157894736842,
      0.7768421052631579,
      0.7726315789473684,
      0.7810526315789473,
      0.7747368421052632,
      0.7810526315789473,
      0.7936842105263158,
      0.7789473684210526,
      0.7852631578947369,
      0.783157894736842,
      0.7873684210526316,
      0.7873684210526316,
      0.7810526315789473,
      0.783157894736842,
      0.7873684210526316,
      0.7789473684210526,
      0.783157894736842
    ],
    "val_f1_macro": [
      0.39068657310145066,
      0.5947161477940642,
      0.6481166745596525,
      0.6381757260497221,
      0.6386535758734608,
      0.6525306915605764,
      0.6584181915346089,
      0.662220993887812,
      0.6751450113599202,
      0.6661717870401094,
      0.681903646275393,
      0.6816062509963726,
      0.6820366909252947,
      0.6836437217472505,
      0.6868738278373723,
      0.6870650446599814,
      0.7033778945451936,
      0.6664995112938337,
      0.6943255614150949,
      0.686884907699102,
      0.684783526704066,
      0.6960198876286164,
      0.6842605853507372,
      0.6872642962530603,
      0.6926681873000892,
      0.6814431895702265,
      0.6886612409210472
    ],
    "val_precision": [
      0.5235889996391614,
      0.5945589770645368,
      0.6563959681146581,
      0.6496226320787725,
      0.6572757743874248,
      0.6409482116799191,
      0.6658856416238427,
      0.6697956649678014,
      0.6763858516435836,
      0.6659824857734612,
      0.6787920227354904,
      0.6849041186390584,
      0.6935169475964892,
      0.6912276881427744,
      0.6837051487261571,
      0.6910542213469951,
      0.7127295497084795,
      0.6882106017929029,
      0.7046475781059994,
      0.7013363274969128,
      0.7102756487831116,
      0.6994538600032326,
      0.6952575564069816,
      0.7012261181390529,
      0.7067301366151941,
      0.6937978847435043,
      0.6997605531161777
    ],
    "val_recall": [
      0.49011213696339645,
      0.6430851901663578,
      0.6577850677910654,
      0.6713450983243067,
      0.6340530454484873,
      0.686726521512607,
      0.660216519452825,
      0.6753250215065489,
      0.6770446366907782,
      0.6818078829074431,
      0.6873153768795511,
      0.6787506209637358,
      0.6738698460009935,
      0.6774099451128639,
      0.692518447166588,
      0.6836313959264779,
      0.6955787382016889,
      0.6606248409727018,
      0.6866486738637878,
      0.6758078586747119,
      0.6666593968473217,
      0.6928543734021543,
      0.6749921243623763,
      0.6769165061248228,
      0.6817972810875649,
      0.6712042455744974,
      0.6793343268753104
    ],
    "val_f1_per_class": [
      [
        0.352112676056338,
        0.36363636363636365,
        0.4563106796116505
      ],
      [
        0.6138613861386139,
        0.41739130434782606,
        0.752895752895753
      ],
      [
        0.5911949685534591,
        0.49261083743842365,
        0.8605442176870748
      ],
      [
        0.5975609756097561,
        0.4957983193277311,
        0.8211678832116789
      ],
      [
        0.5789473684210527,
        0.4756756756756757,
        0.8613376835236541
      ],
      [
        0.6632124352331606,
        0.4682926829268293,
        0.8260869565217391
      ],
      [
        0.6625766871165644,
        0.450261780104712,
        0.8624161073825504
      ],
      [
        0.6419753086419753,
        0.4880382775119617,
        0.8566493955094991
      ],
      [
        0.6745562130177515,
        0.48044692737430167,
        0.8704318936877077
      ],
      [
        0.6428571428571429,
        0.5024630541871922,
        0.853195164075993
      ],
      [
        0.6896551724137931,
        0.48314606741573035,
        0.8729096989966555
      ],
      [
        0.6666666666666666,
        0.4939759036144578,
        0.8841761827079935
      ],
      [
        0.6871165644171779,
        0.48520710059171596,
        0.8737864077669902
      ],
      [
        0.6781609195402298,
        0.49032258064516127,
        0.8824476650563607
      ],
      [
        0.6589595375722543,
        0.5168539325842697,
        0.8848080133555927
      ],
      [
        0.6590909090909091,
        0.5189873417721519,
        0.8831168831168831
      ],
      [
        0.6936416184971098,
        0.5290322580645161,
        0.887459807073955
      ],
      [
        0.6739130434782609,
        0.4444444444444444,
        0.8811410459587956
      ],
      [
        0.6707317073170732,
        0.5269461077844312,
        0.8852988691437803
      ],
      [
        0.6783625730994152,
        0.5033112582781457,
        0.8789808917197452
      ],
      [
        0.6871165644171779,
        0.48322147651006714,
        0.8840125391849529
      ],
      [
        0.6744186046511628,
        0.524390243902439,
        0.8892508143322475
      ],
      [
        0.6745562130177515,
        0.4968152866242038,
        0.8814102564102564
      ],
      [
        0.6666666666666666,
        0.509090909090909,
        0.8860353130016051
      ],
      [
        0.6748466257668712,
        0.5153374233128835,
        0.8878205128205128
      ],
      [
        0.6706586826347305,
        0.4936708860759494,
        0.88
      ],
      [
        0.6706586826347305,
        0.5125,
        0.8828250401284109
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27
    ]
  },
  "test_metrics": {
    "loss": 0.5711696885134044,
    "accuracy": 0.8160676532769556,
    "f1_macro": 0.7292281987194514,
    "precision": 0.7563956661754271,
    "recall": 0.7128811672030642,
    "f1_per_class": [
      0.7470355731225297,
      0.5417607223476298,
      0.8988883006881948
    ],
    "auc_macro": 0.9013614254175445,
    "auc_weighted": 0.9094304801846801,
    "confusion_matrix": [
      [
        189,
        30,
        39
      ],
      [
        40,
        120,
        97
      ],
      [
        19,
        36,
        849
      ]
    ]
  }
}