{
  "args": {
    "dataset": "restaurants",
    "use_augmented": true,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "iarn",
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "batch_size": 32,
    "epochs": 25,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 8,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.6952589123080927,
  "history": {
    "train_loss": [
      0.6253997155448847,
      0.49089393908517404,
      0.3416767645823328,
      0.26407135055776226,
      0.1983321545024713,
      0.1569433681536139,
      0.1310471991697947,
      0.11298510497599318,
      0.08840212639290512,
      0.07685468504368737,
      0.06719363619687788,
      0.04844277489342188,
      0.04034611739201896,
      0.02750468584749717,
      0.03049778243273562,
      0.016657200361614263,
      0.015472162638360985,
      0.010029099995000778,
      0.010994018441762595,
      0.009325152884182324,
      0.007687743809232447,
      0.004801008363612805,
      0.005620401360685814,
      0.004599680343010716
    ],
    "val_loss": [
      0.4384849156652178,
      0.37921638573919025,
      0.33890803371156963,
      0.34699518765722004,
      0.38975163442747934,
      0.5890742242336273,
      0.6098649672099522,
      0.5070011445454189,
      0.7261377956186023,
      0.7121724741799491,
      0.8659759249005999,
      1.2326659645353044,
      1.0632530067648207,
      1.2073209541184562,
      1.1065523879868644,
      1.0616433875901359,
      1.1333996483257838,
      1.4805341533252172,
      1.3732917223657881,
      1.3800636955669947,
      1.4796277114323206,
      1.5089335526738847,
      1.5164401701518468,
      1.55370032787323
    ],
    "val_accuracy": [
      0.391578947368421,
      0.6126315789473684,
      0.7178947368421053,
      0.6926315789473684,
      0.7221052631578947,
      0.7094736842105264,
      0.7389473684210527,
      0.6842105263157895,
      0.7389473684210527,
      0.7389473684210527,
      0.7684210526315789,
      0.7894736842105263,
      0.7705263157894737,
      0.7684210526315789,
      0.783157894736842,
      0.7810526315789473,
      0.7768421052631579,
      0.783157894736842,
      0.783157894736842,
      0.7747368421052632,
      0.7810526315789473,
      0.7789473684210526,
      0.7789473684210526,
      0.7810526315789473
    ],
    "val_f1_macro": [
      0.2886686772942697,
      0.5376323761056585,
      0.6007109388517201,
      0.6055716237680074,
      0.6237889759613795,
      0.6032214156079855,
      0.6312944332341753,
      0.6140146127955672,
      0.6593042387225831,
      0.6320795676058834,
      0.6691189584448011,
      0.6812115056577731,
      0.6596673473115172,
      0.6592218371106933,
      0.6840650854992297,
      0.6952589123080927,
      0.6853512580198377,
      0.6789273506169154,
      0.691465072367361,
      0.683506153085491,
      0.6834095206822441,
      0.6814719495187253,
      0.6834854940150131,
      0.6831639022650258
    ],
    "val_precision": [
      0.376482197711248,
      0.6391014715793295,
      0.675332567978089,
      0.672782738095238,
      0.6756261657340795,
      0.6067830152580476,
      0.6576569756897626,
      0.6314010683873698,
      0.6638266830000138,
      0.6649519102627356,
      0.6861526037900653,
      0.7142275786174577,
      0.6673772176233209,
      0.6718041192094488,
      0.6967445748695749,
      0.7005430904954967,
      0.6939696508151408,
      0.6968540665501676,
      0.6987314241440407,
      0.6865523052083112,
      0.693300608477783,
      0.6898319854479164,
      0.6909647246996644,
      0.6928512963975568
    ],
    "val_recall": [
      0.4410502465680395,
      0.5750702749203349,
      0.6143000375607333,
      0.632770225243236,
      0.6291292573879539,
      0.6014130711351823,
      0.6210715713714514,
      0.6304626634194807,
      0.6626049580167933,
      0.6248752014345776,
      0.6576548168611344,
      0.6593901833206112,
      0.654389759247816,
      0.6530197012104249,
      0.6736671997867519,
      0.6933793149406905,
      0.6795821065513189,
      0.6668914252480826,
      0.6850014539638689,
      0.6806298692644154,
      0.6749921243623763,
      0.6741763900500405,
      0.6768713726630559,
      0.6749921243623763
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.36363636363636365,
        0.5023696682464455
      ],
      [
        0.42857142857142855,
        0.41333333333333333,
        0.7709923664122137
      ],
      [
        0.4603174603174603,
        0.4721030042918455,
        0.8697123519458545
      ],
      [
        0.5,
        0.48249027237354086,
        0.8342245989304813
      ],
      [
        0.5441176470588235,
        0.47058823529411764,
        0.8566610455311973
      ],
      [
        0.5833333333333334,
        0.39080459770114945,
        0.8355263157894737
      ],
      [
        0.5906040268456376,
        0.4419889502762431,
        0.8612903225806452
      ],
      [
        0.5949367088607594,
        0.43859649122807015,
        0.8085106382978723
      ],
      [
        0.6666666666666666,
        0.4656084656084656,
        0.8456375838926175
      ],
      [
        0.5694444444444444,
        0.4631578947368421,
        0.8636363636363636
      ],
      [
        0.6666666666666666,
        0.4642857142857143,
        0.8764044943820225
      ],
      [
        0.6792452830188679,
        0.47619047619047616,
        0.8881987577639752
      ],
      [
        0.6590909090909091,
        0.4370860927152318,
        0.8828250401284109
      ],
      [
        0.659217877094972,
        0.4444444444444444,
        0.8740031897926634
      ],
      [
        0.6626506024096386,
        0.5031446540880503,
        0.8864
      ],
      [
        0.6666666666666666,
        0.5371428571428571,
        0.8819672131147541
      ],
      [
        0.6585365853658537,
        0.5176470588235295,
        0.8798701298701299
      ],
      [
        0.6744186046511628,
        0.4794520547945205,
        0.8829113924050633
      ],
      [
        0.6705882352941176,
        0.5217391304347826,
        0.8820678513731826
      ],
      [
        0.6589595375722543,
        0.5153374233128835,
        0.8762214983713354
      ],
      [
        0.6705882352941176,
        0.4968152866242038,
        0.8828250401284109
      ],
      [
        0.6588235294117647,
        0.5031446540880503,
        0.8824476650563607
      ],
      [
        0.6666666666666666,
        0.5031446540880503,
        0.8806451612903226
      ],
      [
        0.6666666666666666,
        0.5,
        0.8828250401284109
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24
    ]
  },
  "test_metrics": {
    "loss": 1.0214654026847136,
    "accuracy": 0.8188865398167724,
    "f1_macro": 0.7433206425640998,
    "precision": 0.754240066823474,
    "recall": 0.7338551119076326,
    "f1_per_class": [
      0.752,
      0.5760649087221096,
      0.9018970189701897
    ],
    "auc_macro": 0.9026850366438106,
    "auc_weighted": 0.9118744017624347,
    "confusion_matrix": [
      [
        188,
        40,
        30
      ],
      [
        36,
        142,
        79
      ],
      [
        18,
        54,
        832
      ]
    ]
  }
}