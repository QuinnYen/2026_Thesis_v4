{
  "args": {
    "dataset": "restaurants",
    "use_augmented": true,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "hierarchical",
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.4,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.7042551127822824,
  "history": {
    "train_loss": [
      0.845724316019761,
      0.6485972655446905,
      0.49280870065354465,
      0.373277509421633,
      0.290970679437905,
      0.23775293952540347,
      0.18334764451311344,
      0.131916803945052,
      0.10460772401277434,
      0.0898291449667069,
      0.06636290525069885,
      0.0629205558154928,
      0.048162747517620265,
      0.03770649889810828,
      0.043988204798089306,
      0.02488206749120237,
      0.018915394199562764,
      0.015394900239219791,
      0.012978061693087383,
      0.014107098999885605,
      0.009756935897154076,
      0.013262988920599272,
      0.0069409537808448815,
      0.005124132216798516,
      0.00741970368631372,
      0.004163227550618518,
      0.003935061834725498,
      0.005538856930989392
    ],
    "val_loss": [
      0.536706954240799,
      0.4375821224280766,
      0.39804779631750925,
      0.38893074222973417,
      0.4106778757912772,
      0.49996754952839445,
      0.5485969824450356,
      0.9141644282000405,
      0.8429946643965585,
      1.0987157906804765,
      1.5503215108598982,
      1.1286934103284563,
      1.801118356840951,
      1.4723580053874425,
      1.4423179030418396,
      1.7383881977626257,
      1.947104070867811,
      2.33226146868297,
      2.629896674837385,
      2.4465861320495605,
      2.6438545158931186,
      2.2634983233043124,
      2.27265841620309,
      2.623624699456351,
      2.534384642328535,
      2.514341729027884,
      2.5256756714412143,
      2.592946307999747
    ],
    "val_accuracy": [
      0.1726315789473684,
      0.4378947368421053,
      0.6778947368421052,
      0.5789473684210527,
      0.6273684210526316,
      0.6694736842105263,
      0.631578947368421,
      0.7578947368421053,
      0.7368421052631579,
      0.7494736842105263,
      0.7873684210526316,
      0.7684210526315789,
      0.783157894736842,
      0.7473684210526316,
      0.7747368421052632,
      0.7894736842105263,
      0.7894736842105263,
      0.7852631578947369,
      0.7768421052631579,
      0.7705263157894737,
      0.7768421052631579,
      0.7768421052631579,
      0.783157894736842,
      0.783157894736842,
      0.7768421052631579,
      0.7810526315789473,
      0.783157894736842,
      0.7810526315789473
    ],
    "val_f1_macro": [
      0.09814482345900659,
      0.3191042888352305,
      0.583068330362448,
      0.5388298397340374,
      0.5769308990785501,
      0.6119049919734357,
      0.5859969558599695,
      0.6714343275942806,
      0.6633329718681507,
      0.6604725124351942,
      0.6889449964679834,
      0.6854821535054093,
      0.6834576534576534,
      0.6728091768012803,
      0.6926321372961688,
      0.7042551127822824,
      0.7005326086547967,
      0.6883131791326282,
      0.6896929824561404,
      0.6684854850399827,
      0.6822283918127604,
      0.6872560298122966,
      0.6970632576482902,
      0.6891116666813902,
      0.6874785314501626,
      0.6925668961872503,
      0.6962184873949578,
      0.6912392575905354
    ],
    "val_precision": [
      0.05754385964912281,
      0.38790504098186607,
      0.6745367878180378,
      0.669269701870694,
      0.6784838044527968,
      0.6720627407068086,
      0.6829244829244829,
      0.6710469345493103,
      0.6809405354181474,
      0.6585372980807443,
      0.7054148740836048,
      0.6978477586320723,
      0.6943727334193865,
      0.6631471319037027,
      0.6998522696749934,
      0.7206419989028685,
      0.7082632016416012,
      0.6989508258599479,
      0.689661739283172,
      0.6809244771693,
      0.6843756890358832,
      0.6872933016535866,
      0.6983424127130532,
      0.6945662419056712,
      0.6879127805928863,
      0.6957266294615693,
      0.6992855308448546,
      0.6932614320545355
    ],
    "val_recall": [
      0.3333333333333333,
      0.4532053845128616,
      0.6083957326160445,
      0.5891688779033841,
      0.6069753916615173,
      0.636086777410248,
      0.6145511492372747,
      0.6745816824785238,
      0.6745092871942133,
      0.6650972944155672,
      0.6761301539990064,
      0.6882077472041487,
      0.6758078586747119,
      0.6896450510704809,
      0.6936270946166987,
      0.6956102407521839,
      0.6939472695770177,
      0.6798728993251184,
      0.6943661929167727,
      0.6590248748985253,
      0.6808912798516956,
      0.6873898925278373,
      0.6966128700035138,
      0.6844471302388135,
      0.6871127306653095,
      0.6898528467400918,
      0.6939178873904983,
      0.6892985230150365
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.29443447037701975,
        0.0
      ],
      [
        0.0,
        0.36538461538461536,
        0.5919282511210763
      ],
      [
        0.464,
        0.45454545454545453,
        0.8306595365418895
      ],
      [
        0.4881889763779528,
        0.4169184290030212,
        0.7113821138211383
      ],
      [
        0.5454545454545454,
        0.4161073825503356,
        0.7692307692307693
      ],
      [
        0.5915492957746479,
        0.4419475655430712,
        0.8022181146025879
      ],
      [
        0.5714285714285714,
        0.4246575342465753,
        0.7619047619047619
      ],
      [
        0.6783625730994152,
        0.4692737430167598,
        0.8666666666666667
      ],
      [
        0.6538461538461539,
        0.48148148148148145,
        0.8546712802768166
      ],
      [
        0.6395348837209303,
        0.48044692737430167,
        0.8614357262103506
      ],
      [
        0.6625766871165644,
        0.5157232704402516,
        0.8885350318471338
      ],
      [
        0.6410256410256411,
        0.5416666666666666,
        0.8737541528239202
      ],
      [
        0.6590909090909091,
        0.5066666666666667,
        0.8846153846153846
      ],
      [
        0.6555555555555556,
        0.5106382978723404,
        0.852233676975945
      ],
      [
        0.6583850931677019,
        0.5434782608695652,
        0.8760330578512396
      ],
      [
        0.6624203821656051,
        0.5664739884393064,
        0.8838709677419355
      ],
      [
        0.6904761904761905,
        0.524390243902439,
        0.8867313915857605
      ],
      [
        0.6705202312138728,
        0.5098039215686274,
        0.8846153846153846
      ],
      [
        0.6842105263157895,
        0.5131578947368421,
        0.8717105263157895
      ],
      [
        0.6380368098159509,
        0.4878048780487805,
        0.8796147672552167
      ],
      [
        0.6703910614525139,
        0.4968152866242038,
        0.8794788273615635
      ],
      [
        0.6666666666666666,
        0.5149700598802395,
        0.8801313628899836
      ],
      [
        0.6783625730994152,
        0.5294117647058824,
        0.8834154351395731
      ],
      [
        0.6742857142857143,
        0.5095541401273885,
        0.883495145631068
      ],
      [
        0.6666666666666666,
        0.5185185185185185,
        0.8772504091653028
      ],
      [
        0.6666666666666666,
        0.5301204819277109,
        0.8809135399673735
      ],
      [
        0.6705882352941176,
        0.5357142857142857,
        0.8823529411764706
      ],
      [
        0.6742857142857143,
        0.5185185185185185,
        0.8809135399673735
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28
    ]
  },
  "test_metrics": {
    "loss": 1.7786026055875577,
    "accuracy": 0.806906272022551,
    "f1_macro": 0.7228230419325287,
    "precision": 0.7462439717901116,
    "recall": 0.7063416846199889,
    "f1_per_class": [
      0.7213822894168467,
      0.547945205479452,
      0.8991416309012875
    ],
    "auc_macro": 0.8975789799284976,
    "auc_weighted": 0.9078780981622212
  }
}