{
  "args": {
    "dataset": "restaurants",
    "use_augmented": true,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": null,
    "improved": "iarn",
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.7169853364952276,
  "history": {
    "train_loss": [
      0.7084004795342161,
      0.6069283176932418,
      0.44441691380843784,
      0.3617936210674152,
      0.2834001298536334,
      0.2308256848339449,
      0.18250710948517448,
      0.16151812819665984,
      0.12667782916769124,
      0.11014438288188294,
      0.10496813823518,
      0.08523192853062299,
      0.07179987031901092,
      0.060077250428628506,
      0.05472029722704176,
      0.04671930827265769,
      0.042240260454842395,
      0.032208799806284605,
      0.027773240232930044,
      0.020203791568954393,
      0.020213068206590322,
      0.015598325908700772,
      0.015820028465608822,
      0.009788452650434664,
      0.01199891379987923,
      0.00972931511779806,
      0.007841910027516923,
      0.01045481745715829,
      0.008676039583198809,
      0.011082579687354155
    ],
    "val_loss": [
      0.5873006326811654,
      0.44688500676836285,
      0.38692634872027803,
      0.41595034514154705,
      0.4332839165415083,
      0.42980334162712097,
      0.6131056547164917,
      0.7043817383902413,
      1.0595110825129919,
      0.9919728892190116,
      1.1687288922922952,
      1.0239073463848658,
      1.4043395987578802,
      1.1693743850503648,
      1.6822182450975691,
      1.257595888205937,
      2.171671450138092,
      2.000138291290828,
      1.9605758105005537,
      2.128706531865256,
      2.081408602850778,
      2.3687324609075273,
      2.5973465016910007,
      2.4303561193602428,
      2.492875099182129,
      2.459624069077628,
      2.526775130203792,
      2.4488479750497,
      2.4109882542065213,
      2.4488653114863803
    ],
    "val_accuracy": [
      0.1726315789473684,
      0.4589473684210526,
      0.6231578947368421,
      0.4694736842105263,
      0.72,
      0.6463157894736842,
      0.7221052631578947,
      0.7452631578947368,
      0.7263157894736842,
      0.6821052631578948,
      0.7663157894736842,
      0.6947368421052632,
      0.7452631578947368,
      0.7263157894736842,
      0.783157894736842,
      0.7305263157894737,
      0.791578947368421,
      0.7852631578947369,
      0.7936842105263158,
      0.7894736842105263,
      0.7810526315789473,
      0.8021052631578948,
      0.8,
      0.7936842105263158,
      0.8,
      0.7957894736842105,
      0.7936842105263158,
      0.7957894736842105,
      0.7978947368421052,
      0.7957894736842105
    ],
    "val_f1_macro": [
      0.09814482345900659,
      0.33239708466568724,
      0.5369837936789964,
      0.43594757071459583,
      0.6070609569852494,
      0.5688471929362151,
      0.6344656172328086,
      0.6466049872235439,
      0.6382457935610811,
      0.614905701112853,
      0.6671071320061853,
      0.6244202415594212,
      0.67092986694944,
      0.6711072961985466,
      0.6997074757391988,
      0.6649567055953834,
      0.6796403028434098,
      0.6936607542219666,
      0.7069373901829316,
      0.7079976360189119,
      0.6872109658202029,
      0.7166675650502139,
      0.7096656568348907,
      0.7004025828039632,
      0.7169853364952276,
      0.7102011271392379,
      0.7068421809111163,
      0.7102011271392379,
      0.7131543586373864,
      0.710451963870959
    ],
    "val_precision": [
      0.05754385964912281,
      0.3916550840759818,
      0.686529033020261,
      0.682991057810668,
      0.6797439300923621,
      0.6628638707752632,
      0.6772246757593777,
      0.6603659260314295,
      0.6521680570474403,
      0.6504900685228554,
      0.6846250671641587,
      0.6730698952921176,
      0.6738071788998283,
      0.6735987788760447,
      0.6977695808337968,
      0.6794638052292675,
      0.7123067323141056,
      0.7030604969217755,
      0.7139007172732262,
      0.7079065049362079,
      0.6928252530968999,
      0.7221122299975345,
      0.7216965822172413,
      0.7124137284042606,
      0.7206879204009763,
      0.7152476731642458,
      0.7125158127767236,
      0.7152476731642458,
      0.7177843244536256,
      0.7161600879950013
    ],
    "val_recall": [
      0.3333333333333333,
      0.46413434626149536,
      0.5786712587692197,
      0.523775641258648,
      0.6083399973343996,
      0.5944201107435814,
      0.6334105751638739,
      0.6472959301128034,
      0.6431269916275913,
      0.6331733973077437,
      0.6576705681363818,
      0.6402850980819793,
      0.6804672070565713,
      0.7003525862382319,
      0.701725673367017,
      0.6863684829098663,
      0.6583424206075146,
      0.6869258357263156,
      0.7031859983279416,
      0.7088079919547332,
      0.6852943671016442,
      0.7121160626658427,
      0.6996889123138623,
      0.6910202585632413,
      0.7139953109665225,
      0.7064195533907648,
      0.7023545127403584,
      0.7064195533907648,
      0.7104845940411714,
      0.7064195533907648
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.29443447037701975,
        0.0
      ],
      [
        0.0,
        0.37438423645320196,
        0.6228070175438597
      ],
      [
        0.4,
        0.4304635761589404,
        0.7804878048780488
      ],
      [
        0.34234234234234234,
        0.3802469135802469,
        0.5852534562211982
      ],
      [
        0.5116279069767442,
        0.44144144144144143,
        0.8681135225375626
      ],
      [
        0.484375,
        0.42142857142857143,
        0.8007380073800738
      ],
      [
        0.6056338028169014,
        0.4507042253521127,
        0.8470588235294118
      ],
      [
        0.6025641025641025,
        0.4639175257731959,
        0.8733333333333333
      ],
      [
        0.6114649681528662,
        0.45098039215686275,
        0.8522920203735145
      ],
      [
        0.5906040268456376,
        0.4426229508196721,
        0.8114901256732495
      ],
      [
        0.6282051282051282,
        0.49710982658959535,
        0.8760064412238325
      ],
      [
        0.5915492957746479,
        0.45901639344262296,
        0.8226950354609929
      ],
      [
        0.6746987951807228,
        0.48484848484848486,
        0.8532423208191127
      ],
      [
        0.6666666666666666,
        0.5201793721973094,
        0.8264758497316637
      ],
      [
        0.6892655367231638,
        0.5301204819277109,
        0.8797364085667215
      ],
      [
        0.6369426751592356,
        0.5178571428571429,
        0.8400702987697716
      ],
      [
        0.6580645161290323,
        0.48366013071895425,
        0.897196261682243
      ],
      [
        0.6585365853658537,
        0.5357142857142857,
        0.8867313915857605
      ],
      [
        0.6585365853658537,
        0.5697674418604651,
        0.8925081433224755
      ],
      [
        0.6744186046511628,
        0.5647058823529412,
        0.8848684210526315
      ],
      [
        0.6341463414634146,
        0.5371428571428571,
        0.8903436988543372
      ],
      [
        0.6982248520710059,
        0.5542168674698795,
        0.8975609756097561
      ],
      [
        0.6867469879518072,
        0.546583850931677,
        0.8956661316211878
      ],
      [
        0.6707317073170732,
        0.5365853658536586,
        0.8938906752411575
      ],
      [
        0.6941176470588235,
        0.562874251497006,
        0.8939641109298532
      ],
      [
        0.6785714285714286,
        0.5595238095238095,
        0.8925081433224755
      ],
      [
        0.6785714285714286,
        0.5508982035928144,
        0.8910569105691057
      ],
      [
        0.6785714285714286,
        0.5595238095238095,
        0.8925081433224755
      ],
      [
        0.6826347305389222,
        0.5614035087719298,
        0.8954248366013072
      ],
      [
        0.6826347305389222,
        0.5562130177514792,
        0.8925081433224755
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30
    ]
  },
  "test_metrics": {
    "loss": 2.551041548189364,
    "accuracy": 0.7991543340380549,
    "f1_macro": 0.7090365245737701,
    "precision": 0.7290482954048944,
    "recall": 0.6957021779864466,
    "f1_per_class": [
      0.7301587301587301,
      0.5087719298245614,
      0.8881789137380192
    ],
    "auc_macro": 0.8846012215797444,
    "auc_weighted": 0.8928794761730341
  }
}