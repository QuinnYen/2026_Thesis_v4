{
  "args": {
    "dataset": "mams",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": false,
    "virtual_aspect_mode": "none",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": "bert_cls",
    "improved": null,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.45,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.05,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.8226774316526034,
  "history": {
    "train_loss": [
      1.1036918026429636,
      0.5613436924086677,
      0.3774986054058428,
      0.2787789756501162,
      0.208823189691261,
      0.14783810371602024,
      0.1024977241953214,
      0.06956959746226117,
      0.04943536858729742,
      0.039458123748018235,
      0.03492244934076788,
      0.02168232258711079,
      0.01674734371675489,
      0.018618309585791495,
      0.01130169418476591,
      0.012754390917177295,
      0.008541839625185175,
      0.012155972788753355,
      0.005542063007440582,
      0.00800666826960676,
      0.0024204713276520596,
      0.003937882970458978,
      0.003816631431069524,
      0.0052006788883132956,
      0.0021057310144156132,
      0.002892650687457448,
      0.00729400719626904,
      0.0015706807766306425,
      0.004206736000023065,
      0.0027238811907240976
    ],
    "val_loss": [
      0.6562890186905861,
      0.4499057848006487,
      0.3263026103377342,
      0.2983625549823046,
      0.3373982245102525,
      0.38026213366538286,
      0.5745433066040277,
      0.5854354118928313,
      0.6677863132208586,
      0.8630460035055876,
      0.8404001854360104,
      1.0967040657997131,
      1.0560727324336767,
      1.1891277451068163,
      1.1037090178579092,
      1.4147969409823418,
      1.3123092036694288,
      1.5615593306720257,
      1.5495407655835152,
      1.481227021664381,
      1.4788063876330853,
      1.4883429296314716,
      1.7513175010681152,
      1.5465217344462872,
      1.4952517449855804,
      1.592669565230608,
      1.5924073606729507,
      1.5662823058664799,
      1.5673997066915035,
      1.6010649763047695
    ],
    "val_accuracy": [
      0.45263157894736844,
      0.6203007518796992,
      0.7699248120300752,
      0.7804511278195488,
      0.8052631578947368,
      0.8045112781954887,
      0.812781954887218,
      0.8112781954887218,
      0.8285714285714286,
      0.8180451127819549,
      0.8240601503759398,
      0.8150375939849624,
      0.824812030075188,
      0.8300751879699249,
      0.8240601503759398,
      0.8225563909774436,
      0.8195488721804511,
      0.824812030075188,
      0.8270676691729323,
      0.8285714285714286,
      0.8270676691729323,
      0.8300751879699249,
      0.8263157894736842,
      0.8300751879699249,
      0.8300751879699249,
      0.8293233082706767,
      0.8300751879699249,
      0.8308270676691729,
      0.8308270676691729,
      0.8300751879699249
    ],
    "val_f1_macro": [
      0.20772946859903382,
      0.557745324325591,
      0.7545766582495067,
      0.7644105106658584,
      0.7927602962153225,
      0.7920319266330491,
      0.8028315412186379,
      0.8014648347680979,
      0.8192852834953644,
      0.8094702947516784,
      0.8148543000586815,
      0.8067558032036871,
      0.8162452338379813,
      0.8225503140948313,
      0.8143709792978685,
      0.8164234206968967,
      0.8110313881710551,
      0.8181503536866527,
      0.8209025225743175,
      0.8213423293697332,
      0.818959074630777,
      0.8223242281195654,
      0.8202064066460742,
      0.8226774316526034,
      0.8220540440025322,
      0.8214994553715043,
      0.8220548267113069,
      0.8226115325353343,
      0.8226115325353343,
      0.8221197094072039
    ],
    "val_precision": [
      0.15087719298245614,
      0.7082379228629102,
      0.8060784549146524,
      0.8345650062876216,
      0.8242758166817733,
      0.8153712425868282,
      0.8135382101842037,
      0.8219167483927209,
      0.8274535563021658,
      0.8154870993415204,
      0.8228610743209209,
      0.8106367099052504,
      0.8201992882401069,
      0.8239175844374085,
      0.8227350866894044,
      0.8187397572077607,
      0.8171408156748475,
      0.8176878409287317,
      0.82076159613561,
      0.8215131580885314,
      0.8217950341024104,
      0.8252790725421039,
      0.8195102144795188,
      0.8243835655396815,
      0.8248126327342334,
      0.8232727732233184,
      0.8235191982285553,
      0.8243820062336717,
      0.8243820062336717,
      0.8234197613851869
    ],
    "val_recall": [
      0.3333333333333333,
      0.5588900521833754,
      0.7357254148702012,
      0.7404472546708106,
      0.776712969451154,
      0.7790395401048064,
      0.7963143533136031,
      0.7896111940072931,
      0.8132795836321717,
      0.8061456572934443,
      0.8088149509904948,
      0.8035375327348321,
      0.8131441102033751,
      0.8214172773962721,
      0.8085153156420973,
      0.8149887471867968,
      0.806163134190141,
      0.8188597149287321,
      0.8211163779955978,
      0.8213286288605118,
      0.8164457597915962,
      0.8197542792291479,
      0.8211844169833666,
      0.8210951639008653,
      0.8196044615549493,
      0.8198710117089711,
      0.8206981415683591,
      0.8209784314210421,
      0.8209784314210421,
      0.8208966527346123
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.6231884057971014,
        0.0
      ],
      [
        0.6093457943925233,
        0.7107231920199502,
        0.3531669865642994
      ],
      [
        0.7312925170068028,
        0.8089080459770115,
        0.7235294117647059
      ],
      [
        0.7415329768270945,
        0.8176718092566619,
        0.7340267459138187
      ],
      [
        0.7474048442906575,
        0.836719337848006,
        0.7941567065073041
      ],
      [
        0.7550335570469798,
        0.8412213740458016,
        0.7798408488063661
      ],
      [
        0.7633333333333333,
        0.8451612903225807,
        0.8
      ],
      [
        0.780327868852459,
        0.8433179723502304,
        0.7807486631016043
      ],
      [
        0.7892234548335975,
        0.8619313647246608,
        0.8067010309278351
      ],
      [
        0.7908396946564885,
        0.8523274478330658,
        0.7852437417654808
      ],
      [
        0.7859424920127795,
        0.8576,
        0.8010204081632653
      ],
      [
        0.780952380952381,
        0.848732624693377,
        0.7905824039653035
      ],
      [
        0.7875968992248062,
        0.8580697485806975,
        0.80306905370844
      ],
      [
        0.8018433179723502,
        0.8627773212818406,
        0.803030303030303
      ],
      [
        0.7874015748031497,
        0.8598726114649682,
        0.7958387516254877
      ],
      [
        0.7968253968253968,
        0.8495428096425602,
        0.8029020556227328
      ],
      [
        0.7910685805422647,
        0.8546042003231018,
        0.7874213836477988
      ],
      [
        0.7987616099071208,
        0.856663872590109,
        0.7990255785627284
      ],
      [
        0.8068006182380216,
        0.8573811509591326,
        0.7985257985257985
      ],
      [
        0.7987804878048781,
        0.8602150537634409,
        0.8050314465408805
      ],
      [
        0.7949921752738655,
        0.8608837970540099,
        0.8010012515644556
      ],
      [
        0.8,
        0.8630024610336341,
        0.8039702233250621
      ],
      [
        0.80370942812983,
        0.8564231738035264,
        0.8004866180048662
      ],
      [
        0.80248833592535,
        0.8625514403292182,
        0.8029925187032418
      ],
      [
        0.8,
        0.8641571194762684,
        0.8020050125313283
      ],
      [
        0.7987519500780031,
        0.8632619439868204,
        0.8024844720496894
      ],
      [
        0.7975077881619937,
        0.8646864686468647,
        0.8039702233250621
      ],
      [
        0.7975077881619937,
        0.8658436213991769,
        0.8044831880448319
      ],
      [
        0.7975077881619937,
        0.8658436213991769,
        0.8044831880448319
      ],
      [
        0.7968992248062016,
        0.8639736191261336,
        0.8054862842892768
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24,
      25,
      26,
      27,
      28,
      29,
      30
    ]
  },
  "test_metrics": {
    "loss": 1.7485748454928398,
    "accuracy": 0.8271975957926371,
    "f1_macro": 0.8217388282980592,
    "precision": 0.8220634127796814,
    "recall": 0.8214293373338734,
    "f1_per_class": [
      0.8061068702290076,
      0.8510288065843621,
      0.8080808080808081
    ],
    "auc_macro": 0.940750281333572,
    "auc_weighted": 0.9394969733617695
  }
}