{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": "bert_cls",
    "improved": null,
    "auto_select": false,
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.01,
    "grad_clip": 1.0,
    "patience": 10,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.0,
    "label_smoothing": 0.0,
    "class_weights": null,
    "auto_class_weights": true,
    "seed": 42
  },
  "best_val_f1": 0.7121020899741818,
  "history": {
    "train_loss": [
      0.3768687666508189,
      0.27171677168001207,
      0.19930786927018249,
      0.14458865129895376,
      0.10280413625010273,
      0.07121551834177553,
      0.04695630000021897,
      0.04149818203101555,
      0.030923128577374052,
      0.01941436867785166,
      0.015998930568202285,
      0.015228173241076436,
      0.012312859711400642,
      0.006576124095692904,
      0.008526117421863825,
      0.007147032800467538,
      0.003981528017902747,
      0.003311963885240849,
      0.002785928268023877,
      0.0029289743674381866,
      0.0029938122633482857,
      0.002705353043079652,
      0.0025823904476662087,
      0.0019238765309733264
    ],
    "val_loss": [
      0.2981120731149401,
      0.2224769230399813,
      0.21489176792757853,
      0.2310712273631777,
      0.2865404997553144,
      0.2681730879204614,
      0.30337553152016233,
      0.3000110515526363,
      0.3794684793267931,
      0.3981305935553142,
      0.4226166435650417,
      0.4145538019282477,
      0.4479982214314597,
      0.4795545978205545,
      0.5947175409112658,
      0.49335406933512005,
      0.5495718462126595,
      0.5489938982895443,
      0.5772841828210014,
      0.5812774641173226,
      0.6142609970910209,
      0.5807982981204987,
      0.5875756101948875,
      0.5971449911594391
    ],
    "val_accuracy": [
      0.5452631578947369,
      0.6126315789473684,
      0.7410526315789474,
      0.6378947368421053,
      0.7494736842105263,
      0.7326315789473684,
      0.7684210526315789,
      0.7452631578947368,
      0.7621052631578947,
      0.7747368421052632,
      0.7894736842105263,
      0.7642105263157895,
      0.7810526315789473,
      0.791578947368421,
      0.791578947368421,
      0.7873684210526316,
      0.791578947368421,
      0.7789473684210526,
      0.7873684210526316,
      0.7810526315789473,
      0.7978947368421052,
      0.7873684210526316,
      0.8,
      0.7894736842105263
    ],
    "val_f1_macro": [
      0.4799417880438586,
      0.5555693847727022,
      0.6464988238110364,
      0.5929763309645403,
      0.6324825860059786,
      0.6574747881436186,
      0.6758586762652353,
      0.675868830290737,
      0.6676092371453093,
      0.6781115573105237,
      0.7022214722136283,
      0.6887498487069488,
      0.7050583210091445,
      0.7121020899741818,
      0.6837333333333332,
      0.7028051450465244,
      0.6978265429185675,
      0.6986962734526792,
      0.694307197103488,
      0.6959692165177476,
      0.7076937063300345,
      0.6975027144408251,
      0.7083285845875303,
      0.6975020095023409
    ],
    "val_precision": [
      0.4840948448992224,
      0.5858929169719734,
      0.6410283667001319,
      0.6090380700175372,
      0.6406641236306729,
      0.6663379413577529,
      0.6747230334214064,
      0.6760647400002506,
      0.6713456994785663,
      0.6827227836472209,
      0.7175687292436844,
      0.6775666100782741,
      0.7181949719659975,
      0.7103669716565153,
      0.7188399778516059,
      0.7022672027824215,
      0.713207167460041,
      0.7051493139628734,
      0.7034788331435681,
      0.7037280701754386,
      0.7238176918452374,
      0.7108647585821722,
      0.7195357318745091,
      0.7106699275598901
    ],
    "val_recall": [
      0.5150585220457272,
      0.5952443265118195,
      0.6636212181793949,
      0.6312281148146802,
      0.6261822543709789,
      0.6652705584432894,
      0.6781060303151466,
      0.6882749930330898,
      0.6651560587886057,
      0.6738540947257462,
      0.6942244314395455,
      0.705641682720851,
      0.7079628754558782,
      0.7139050440429889,
      0.6881877552009499,
      0.7033571419916882,
      0.6858465704627239,
      0.7006485284674008,
      0.6866329225885403,
      0.6925478293531073,
      0.6947923860758726,
      0.6904365526516666,
      0.6988574267262792,
      0.6882801424884591
    ],
    "val_f1_per_class": [
      [
        0.4690265486725664,
        0.2912621359223301,
        0.6795366795366795
      ],
      [
        0.4968944099378882,
        0.4222222222222222,
        0.7475915221579962
      ],
      [
        0.6407766990291263,
        0.4473684210526316,
        0.8513513513513513
      ],
      [
        0.6101694915254238,
        0.41106719367588934,
        0.7576923076923077
      ],
      [
        0.6511627906976745,
        0.3790849673202614,
        0.8672
      ],
      [
        0.6748466257668712,
        0.44878048780487806,
        0.8487972508591065
      ],
      [
        0.7142857142857143,
        0.445859872611465,
        0.867430441898527
      ],
      [
        0.7058823529411765,
        0.47,
        0.8517241379310345
      ],
      [
        0.6745562130177515,
        0.45614035087719296,
        0.8721311475409836
      ],
      [
        0.6976744186046512,
        0.4567901234567901,
        0.8798701298701299
      ],
      [
        0.7169811320754716,
        0.4971751412429379,
        0.8925081433224755
      ],
      [
        0.7065217391304348,
        0.4918032786885246,
        0.8679245283018868
      ],
      [
        0.7088607594936709,
        0.5204081632653061,
        0.8859060402684564
      ],
      [
        0.7303370786516854,
        0.524390243902439,
        0.881578947368421
      ],
      [
        0.72,
        0.448,
        0.8832
      ],
      [
        0.7159090909090909,
        0.509090909090909,
        0.8834154351395731
      ],
      [
        0.7239263803680982,
        0.4785276073619632,
        0.8910256410256411
      ],
      [
        0.6993865030674846,
        0.5133689839572193,
        0.8833333333333333
      ],
      [
        0.7065868263473054,
        0.4878048780487805,
        0.8885298869143781
      ],
      [
        0.7073170731707317,
        0.4971751412429379,
        0.8834154351395731
      ],
      [
        0.7317073170731707,
        0.5,
        0.8913738019169329
      ],
      [
        0.7,
        0.5,
        0.8925081433224755
      ],
      [
        0.718562874251497,
        0.5093167701863354,
        0.8971061093247589
      ],
      [
        0.7037037037037037,
        0.4970414201183432,
        0.8917609046849758
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24
    ]
  },
  "test_metrics": {
    "loss": 0.4222831792737308,
    "accuracy": 0.806906272022551,
    "f1_macro": 0.722169300158631,
    "precision": 0.729758205074852,
    "recall": 0.718253550380123,
    "f1_per_class": [
      0.75,
      0.5202558635394456,
      0.8962520369364476
    ],
    "auc_macro": 0.9098838960920572,
    "auc_weighted": 0.9198679735989487,
    "confusion_matrix": [
      [
        198,
        33,
        27
      ],
      [
        50,
        122,
        85
      ],
      [
        22,
        57,
        825
      ]
    ]
  }
}