{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": "bert_cls",
    "improved": null,
    "bert_model": "distilbert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "use_pmac": false,
    "gate_bias_init": -3.0,
    "gate_weight_gain": 0.1,
    "gate_sparsity_weight": 0.0,
    "gate_sparsity_type": "l1",
    "use_iarm": false,
    "iarm_heads": 4,
    "iarm_layers": 2,
    "batch_size": 32,
    "epochs": 30,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 12,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      8.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.7104357984458675,
  "history": {
    "train_loss": [
      0.8565497471575152,
      0.5051941678189394,
      0.3933803159416768,
      0.3057430480655871,
      0.22774098630537065,
      0.1562182403970183,
      0.11511111658131867,
      0.07925952340296485,
      0.07460637065467604,
      0.057739014974223415,
      0.047308878695363536,
      0.04689482008842261,
      0.033745313555476046,
      0.024854754551166768,
      0.018432335483866108,
      0.012684890992220556,
      0.0137025905791425,
      0.009339224043702543,
      0.010107874828559273,
      0.005704307139303796,
      0.006438186084108709,
      0.00818263961353519,
      0.006695908292098657,
      0.003982881992685674
    ],
    "val_loss": [
      0.522725522518158,
      0.4129380328314645,
      0.39338409900665283,
      0.41034058162144255,
      0.46447961245264324,
      0.5419639987604958,
      0.701076192515237,
      0.8330434688499996,
      0.9629666379519871,
      0.8236774759633201,
      1.0478634238243103,
      1.3415122543062483,
      1.166854875428336,
      1.130790148462568,
      1.5911529915673392,
      1.1686137574059623,
      1.6295778581074305,
      1.8850620644433158,
      1.7609960521970476,
      1.602328666618892,
      1.79552561044693,
      1.6513622914041792,
      1.7950661778450012,
      1.7927506225449699
    ],
    "val_accuracy": [
      0.18105263157894738,
      0.5136842105263157,
      0.6231578947368421,
      0.5431578947368421,
      0.6947368421052632,
      0.6589473684210526,
      0.7389473684210527,
      0.7347368421052631,
      0.7642105263157895,
      0.7557894736842106,
      0.76,
      0.8021052631578948,
      0.76,
      0.7578947368421053,
      0.7852631578947369,
      0.76,
      0.7621052631578947,
      0.7852631578947369,
      0.7894736842105263,
      0.7789473684210526,
      0.7894736842105263,
      0.7705263157894737,
      0.7852631578947369,
      0.7894736842105263
    ],
    "val_f1_macro": [
      0.10872174337606962,
      0.38381768944081146,
      0.5253902674737068,
      0.5113638158414279,
      0.6063657409387774,
      0.6185415420722079,
      0.6755715232779452,
      0.66048664085777,
      0.6715806386622459,
      0.6754899675043292,
      0.6700665069074662,
      0.7104357984458675,
      0.6839756357101047,
      0.68013079885575,
      0.6897752689378573,
      0.6904909128869314,
      0.6800164777166436,
      0.6898128155524312,
      0.696735765371643,
      0.6955419098220248,
      0.6990600729405209,
      0.6913631412302347,
      0.6967398275091669,
      0.7015005185377237
    ],
    "val_precision": [
      0.33534707415304427,
      0.7314500941619585,
      0.6558319314267403,
      0.6622152629854813,
      0.6716061444932965,
      0.6792121647509579,
      0.69008102616827,
      0.6783061668770466,
      0.7070285295437425,
      0.6961168912388424,
      0.6790839623520641,
      0.7161942768355617,
      0.6768834620193983,
      0.687691798941799,
      0.6916710205503308,
      0.6948272163237702,
      0.6699015270443841,
      0.6982592199418102,
      0.6974931769632494,
      0.6937802663438258,
      0.6990600729405209,
      0.6850394808360298,
      0.6971571722669275,
      0.7012305881750965
    ],
    "val_recall": [
      0.3347327735572438,
      0.4946903056959034,
      0.5673370045921026,
      0.571143966655762,
      0.6181709134528007,
      0.644097209601008,
      0.6890770964341536,
      0.6704442465438069,
      0.6627991227751324,
      0.6781239019543698,
      0.6711160990149395,
      0.7053402881271733,
      0.698620248870149,
      0.6837752777676808,
      0.6879578471641646,
      0.7024238789332752,
      0.692937370506343,
      0.6825678819381338,
      0.6960879284649777,
      0.6998170428798177,
      0.6990600729405209,
      0.700835423406395,
      0.6971514424533217,
      0.7020322174160639
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.294010889292196,
        0.03215434083601286
      ],
      [
        0.06593406593406594,
        0.3925729442970822,
        0.6929460580912863
      ],
      [
        0.3620689655172414,
        0.4186046511627907,
        0.7954971857410882
      ],
      [
        0.4603174603174603,
        0.4,
        0.673773987206823
      ],
      [
        0.5373134328358209,
        0.4426229508196721,
        0.8391608391608392
      ],
      [
        0.6438356164383562,
        0.4306569343065693,
        0.7811320754716982
      ],
      [
        0.7,
        0.47706422018348627,
        0.8496503496503497
      ],
      [
        0.6538461538461539,
        0.4744186046511628,
        0.853195164075993
      ],
      [
        0.6575342465753424,
        0.47668393782383417,
        0.8805237315875614
      ],
      [
        0.6753246753246753,
        0.47804878048780486,
        0.8730964467005076
      ],
      [
        0.6583850931677019,
        0.47368421052631576,
        0.8781302170283807
      ],
      [
        0.7126436781609196,
        0.5189873417721519,
        0.8996763754045307
      ],
      [
        0.6892655367231638,
        0.49473684210526314,
        0.8679245283018868
      ],
      [
        0.6993865030674846,
        0.4742268041237113,
        0.866779089376054
      ],
      [
        0.6971428571428572,
        0.48148148148148145,
        0.8907014681892332
      ],
      [
        0.703030303030303,
        0.5024630541871922,
        0.865979381443299
      ],
      [
        0.6881720430107527,
        0.48554913294797686,
        0.8663282571912013
      ],
      [
        0.7023809523809523,
        0.4785276073619632,
        0.8885298869143781
      ],
      [
        0.7011494252873564,
        0.4939759036144578,
        0.8950819672131147
      ],
      [
        0.6976744186046512,
        0.5056179775280899,
        0.8833333333333333
      ],
      [
        0.6931818181818182,
        0.5121951219512195,
        0.8918032786885246
      ],
      [
        0.7005649717514124,
        0.5,
        0.8735244519392917
      ],
      [
        0.6976744186046512,
        0.5029239766081871,
        0.8896210873146623
      ],
      [
        0.7011494252873564,
        0.5119047619047619,
        0.8914473684210527
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23,
      24
    ]
  },
  "test_metrics": {
    "loss": 1.300058019396506,
    "accuracy": 0.8125440451021846,
    "f1_macro": 0.7219600935938068,
    "precision": 0.7431416649582471,
    "recall": 0.7091859659874968,
    "f1_per_class": [
      0.734375,
      0.5300668151447662,
      0.9014384656366542
    ],
    "auc_macro": 0.9106782997589832,
    "auc_weighted": 0.9180394427934621
  }
}