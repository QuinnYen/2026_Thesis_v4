{
  "args": {
    "dataset": "restaurants",
    "use_augmented": false,
    "augmented_dir": null,
    "min_aspects": 2,
    "max_aspects": 8,
    "include_single_aspect": true,
    "virtual_aspect_mode": "overall",
    "max_text_len": 128,
    "max_aspect_len": 10,
    "baseline": "bert_cls",
    "improved": null,
    "bert_model": "bert-base-uncased",
    "freeze_bert": false,
    "hidden_dim": 768,
    "dropout": 0.3,
    "batch_size": 32,
    "epochs": 25,
    "lr": 2e-05,
    "weight_decay": 0.05,
    "grad_clip": 1.0,
    "patience": 8,
    "virtual_weight": 0.5,
    "accumulation_steps": 1,
    "use_scheduler": true,
    "warmup_ratio": 0.1,
    "loss_type": "focal",
    "focal_gamma": 2.5,
    "label_smoothing": 0.0,
    "class_weights": [
      1.0,
      5.0,
      1.0
    ],
    "seed": 42
  },
  "best_val_f1": 0.7112073952806145,
  "history": {
    "train_loss": [
      0.627954153638137,
      0.410668601069534,
      0.3019189417623637,
      0.22440382576825327,
      0.1585146131876268,
      0.11850238048978019,
      0.0900224800172605,
      0.0672080415023262,
      0.049944454281215085,
      0.03300207087426985,
      0.027931581343230056,
      0.020423083731561507,
      0.019780889460857827,
      0.021481800957158077,
      0.008480994866164238,
      0.009384604509122846,
      0.007158375309428952,
      0.004668706670998833,
      0.0037592467645784686,
      0.003569338972642742,
      0.004033098803885973
    ],
    "val_loss": [
      0.43753928371838163,
      0.3432230225631169,
      0.3440294436046055,
      0.3610833244664328,
      0.4685360406126295,
      0.4341915931020464,
      0.5838178992271423,
      0.7082970014640263,
      0.5567913736615863,
      0.8826553821563721,
      0.8812741466930935,
      1.075803177697318,
      1.0154766355242049,
      1.1335493751934596,
      1.2511656965528215,
      1.0336016416549683,
      1.2355699368885584,
      1.272829839161464,
      1.2526837417057581,
      1.3056264179093497,
      1.2618737476212638
    ],
    "val_accuracy": [
      0.3936842105263158,
      0.6357894736842106,
      0.6463157894736842,
      0.5894736842105263,
      0.7494736842105263,
      0.7052631578947368,
      0.76,
      0.76,
      0.7536842105263157,
      0.7642105263157895,
      0.7705263157894737,
      0.7810526315789473,
      0.7894736842105263,
      0.783157894736842,
      0.7684210526315789,
      0.7621052631578947,
      0.783157894736842,
      0.7810526315789473,
      0.7810526315789473,
      0.7684210526315789,
      0.7726315789473684
    ],
    "val_f1_macro": [
      0.28894738825454763,
      0.5467507800841135,
      0.5477849530247831,
      0.5298936378344247,
      0.6344968302028583,
      0.6382662279003743,
      0.6687840290381125,
      0.6667262470775809,
      0.6724897496783696,
      0.6662007620757975,
      0.6865334040195904,
      0.6897526091658582,
      0.7112073952806145,
      0.6946535290701327,
      0.6990614209715332,
      0.6848994820088287,
      0.693818118146889,
      0.6922289409540676,
      0.6940602031819338,
      0.6837300404513519,
      0.6886324604357391
    ],
    "val_precision": [
      0.3686434317963497,
      0.6202603543029075,
      0.633051165518698,
      0.63445095959911,
      0.6701434159061278,
      0.6843661041652433,
      0.6723131008753049,
      0.6791314553990611,
      0.6846738909238909,
      0.6696698728429725,
      0.689459885642559,
      0.6942990212046474,
      0.716047544193486,
      0.7030702987466508,
      0.6902352757999629,
      0.6920204465967178,
      0.7059329482052042,
      0.703922735118064,
      0.7048429013572264,
      0.6904925968913277,
      0.695169722456872
    ],
    "val_recall": [
      0.4183659869385579,
      0.581147843892746,
      0.5812223595410321,
      0.5684383822228685,
      0.6170652950940836,
      0.6570838331334133,
      0.6673124689518132,
      0.6624768274508378,
      0.6770310057795065,
      0.6629996486253983,
      0.6873605103413181,
      0.6857720548144379,
      0.7085308300922056,
      0.6876964365768844,
      0.7107996195461209,
      0.6859610701174076,
      0.6850014539638689,
      0.6839085577890055,
      0.6868807022645488,
      0.6803233252153684,
      0.6854812620406383
    ],
    "val_f1_per_class": [
      [
        0.0,
        0.3356643356643357,
        0.5311778290993071
      ],
      [
        0.4153846153846154,
        0.42857142857142855,
        0.7962962962962963
      ],
      [
        0.4,
        0.4316546762589928,
        0.8117001828153565
      ],
      [
        0.4496124031007752,
        0.3974358974358974,
        0.7426326129666012
      ],
      [
        0.6258503401360545,
        0.4046242774566474,
        0.873015873015873
      ],
      [
        0.6111111111111112,
        0.4715447154471545,
        0.8321428571428572
      ],
      [
        0.6666666666666666,
        0.47126436781609193,
        0.868421052631579
      ],
      [
        0.6540880503144654,
        0.4725274725274725,
        0.8735632183908046
      ],
      [
        0.6582278481012658,
        0.49246231155778897,
        0.866779089376054
      ],
      [
        0.6744186046511628,
        0.45121951219512196,
        0.8729641693811075
      ],
      [
        0.6826347305389222,
        0.5027932960893855,
        0.8741721854304636
      ],
      [
        0.6971428571428572,
        0.4936708860759494,
        0.8784440842787682
      ],
      [
        0.7065868263473054,
        0.5465116279069767,
        0.8805237315875614
      ],
      [
        0.6946107784431138,
        0.509090909090909,
        0.8802588996763754
      ],
      [
        0.7222222222222222,
        0.5168539325842697,
        0.8581081081081081
      ],
      [
        0.6993865030674846,
        0.4919786096256685,
        0.8633333333333333
      ],
      [
        0.6993865030674846,
        0.5,
        0.8820678513731826
      ],
      [
        0.6993865030674846,
        0.4970414201183432,
        0.8802588996763754
      ],
      [
        0.6993865030674846,
        0.5029239766081871,
        0.8798701298701299
      ],
      [
        0.6909090909090909,
        0.49142857142857144,
        0.8688524590163934
      ],
      [
        0.6909090909090909,
        0.5028571428571429,
        0.8721311475409836
      ]
    ],
    "epochs": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21
    ]
  },
  "test_metrics": {
    "loss": 0.9332587502308582,
    "accuracy": 0.8195912614517266,
    "f1_macro": 0.7391874762408043,
    "precision": 0.7554056146635322,
    "recall": 0.7258994389736971,
    "f1_per_class": [
      0.7413441955193483,
      0.5708418891170431,
      0.9053763440860215
    ],
    "auc_macro": 0.9066096496464208,
    "auc_weighted": 0.9147275464781618,
    "confusion_matrix": [
      [
        182,
        43,
        33
      ],
      [
        37,
        139,
        81
      ],
      [
        14,
        48,
        842
      ]
    ]
  }
}