# 實驗結果分析與論文策略

> 建立時間: 2025-11-23
> 狀態: 待討論

---

## 實驗結果總覽

### Restaurants Dataset (約 80% 單 aspect)

| Model | Acc (%) | Macro-F1 (%) | Neg F1 | Neu F1 | Pos F1 | Best Epoch |
|-------|---------|--------------|--------|--------|--------|------------|
| Baseline (BERT-CLS) | 81.96 | 73.92 | 74.13 | 57.08 | 90.54 | 13/25 |
| **Hierarchical BERT** | **82.10** | **75.05** | **78.02** | 57.14 | 89.98 | 12/25 |
| IARN | 81.89 | 74.33 | 75.20 | 57.61 | 90.19 | 16/25 |
| VP-IARN | 81.18 | 72.69 | 74.17 | 54.15 | 89.76 | 15/25 |

### MAMS Dataset (100% 多 aspect)

| Model | Acc (%) | Macro-F1 (%) | Neg F1 | Neu F1 | Pos F1 | Best Epoch |
|-------|---------|--------------|--------|--------|--------|------------|
| Baseline (BERT-CLS) | 82.95 | 82.31 | 79.09 | 85.27 | 82.56 | 12/40 |
| Hierarchical BERT | 83.10 | 82.50 | 79.82 | 85.55 | 82.13 | 15/40 |
| **IARN** | **84.90** | **84.36** | **82.23** | **87.02** | **83.83** | 14/40 |
| VP-IARN | 84.15 | 83.48 | 80.65 | 86.84 | 82.94 | 11/40 |

---

## 關鍵發現

### 1. 場景決定最佳方法

| 場景特徵 | 最佳方法 | 改進幅度 |
|----------|----------|----------|
| 單 aspect 為主 (Restaurants) | Hierarchical BERT | +1.13% vs Baseline |
| 多 aspect 為主 (MAMS) | IARN | +2.05% vs Baseline |

### 2. VP-IARN 表現不如預期

- Restaurants: 72.69% (低於 Baseline 73.92%)
- MAMS: 83.48% (低於 IARN 84.36%)
- 原因分析：向量投影 + Attention 組合增加複雜度，但未帶來效益

### 3. 方法特性分析

**Hierarchical BERT 優勢：**
- 利用 BERT 不同層的語義資訊 (Low/Mid/High)
- 對單 aspect 精細分類有效
- Negative F1 提升明顯 (74.13 → 78.02)

**IARN 優勢：**
- Aspect-to-Aspect Attention 顯式建模多 aspect 關係
- 在 100% 多 aspect 場景優勢明顯
- 所有類別 F1 都達到最高

---

## 論文策略建議

### 決定：移除 VP-IARN，採用雙模式框架

**核心貢獻：場景自適應 Multi-Aspect ABSA**

將 Hierarchical BERT 和 IARN 視為互補方法：
- 單 aspect 為主 → Hierarchical BERT
- 多 aspect 為主 → IARN

### 論文敘事結構

1. **問題發現**
   - 現有 ABSA 方法未考慮數據集的 aspect 分布特性
   - 同一模型在不同場景表現差異大

2. **方法設計**
   - Hierarchical BERT: 階層特徵提取，適合單 aspect 精細分類
   - IARN: Aspect-to-Aspect Attention，適合多 aspect 交互建模

3. **場景選擇策略**
   - 多 aspect 比例 > 50% → IARN
   - 多 aspect 比例 ≤ 50% → Hierarchical BERT

4. **實驗結論**
   - 場景匹配的模型選擇比單一模型更有效
   - 提供實用的模型選擇指南

---

## 實施完成

### 已完成項目

- [x] 更新報告生成器，移除 VP-IARN 相關內容
- [x] 更新實驗配置，簡化為三個方法 (Baseline, H-BERT, IARN)
- [x] 實作自動模型選擇系統

### 雙架構自適應系統

已實作完整的場景自適應系統，包含：

1. **數據集分析器** (`utils/dataset_analyzer.py`)
   - 計算 multi-aspect 比例
   - 統計情感分布

2. **模型選擇器** (`utils/model_selector.py`)
   - 閾值: multi-aspect > 50% → IARN
   - 否則 → Hierarchical BERT

3. **訓練整合** (`experiments/train_multiaspect.py`)
   - 新增 `--auto_select` 參數
   - 數據加載後自動分析並選擇模型

4. **批次執行** (`run_experiments.py`)
   - 新增 `--auto` 模式

### 使用方式

```bash
# 自動選擇模式
python run_experiments.py --dataset mams --auto      # → 選擇 IARN
python run_experiments.py --dataset restaurants --auto  # → 選擇 Hierarchical

# 或使用配置
python experiments/train_from_config.py --config configs/adaptive_dual.yaml --dataset mams
```

---

## 待辦事項

- [ ] 撰寫論文方法章節
- [ ] 準備場景分析圖表
- [ ] 在 Laptops 數據集上驗證

---

## 備註

VP-IARN 相關程式碼保留在 `experiments/improved_models.py`，但不納入論文。
如需後續研究，可考慮簡化向量投影機制或調整 adaptive fusion 權重。
