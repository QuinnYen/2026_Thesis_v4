HMAC-Net å¯¦é©—ç¨‹å¼æ¶æ§‹è¨­è¨ˆ
ä¸€ã€å°ˆæ¡ˆç›®éŒ„çµæ§‹
HMAC-Net/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                      # åŸå§‹æ•¸æ“š
â”‚   â”œâ”€â”€ processed/                # é è™•ç†å¾Œæ•¸æ“š
â”‚   â””â”€â”€ embeddings/               # GloVe/BERT embeddings
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ base_model.py            # åŸºç¤æ¨¡å‹é¡
â”‚   â”œâ”€â”€ aaha.py                  # AAHAæ¨¡çµ„
â”‚   â”œâ”€â”€ pmac.py                  # PMACæ¨¡çµ„
â”‚   â”œâ”€â”€ iarm.py                  # IARMæ¨¡çµ„
â”‚   â”œâ”€â”€ hmac_net.py              # å®Œæ•´HMAC-Net
â”‚   â””â”€â”€ baselines.py             # Baselineæ¨¡å‹ (LSTM, ATAE-LSTM, IAN)
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ data_loader.py           # æ•¸æ“šè¼‰å…¥èˆ‡æ‰¹æ¬¡è™•ç†
â”‚   â”œâ”€â”€ preprocessor.py          # æ•¸æ“šé è™•ç†
â”‚   â”œâ”€â”€ metrics.py               # è©•ä¼°æŒ‡æ¨™è¨ˆç®—
â”‚   â”œâ”€â”€ visualization.py         # æ³¨æ„åŠ›è¦–è¦ºåŒ–
â”‚   â””â”€â”€ logger.py                # æ—¥èªŒè¨˜éŒ„
â”œâ”€â”€ experiments/
â”‚   â”œâ”€â”€ train.py                 # è¨“ç·´è…³æœ¬
â”‚   â”œâ”€â”€ evaluate.py              # è©•ä¼°è…³æœ¬
â”‚   â”œâ”€â”€ ablation_study.py        # æ¶ˆèå¯¦é©—
â”‚   â””â”€â”€ compare_baselines.py     # Baselineæ¯”è¼ƒ
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ model_config.yaml        # æ¨¡å‹è¶…åƒæ•¸
â”‚   â”œâ”€â”€ experiment_config.yaml   # å¯¦é©—é…ç½®
â”‚   â””â”€â”€ data_config.yaml         # æ•¸æ“šé…ç½®
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ checkpoints/             # æ¨¡å‹æª¢æŸ¥é»
â”‚   â”œâ”€â”€ logs/                    # è¨“ç·´æ—¥èªŒ
â”‚   â”œâ”€â”€ visualizations/          # è¦–è¦ºåŒ–åœ–è¡¨
â”‚   â””â”€â”€ reports/                 # å¯¦é©—å ±å‘Š
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md

äºŒã€æ¶æ§‹åœ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      HMAC-Net Architecture                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Input: Sentence + Aspect Terms
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Embedding Layer    â”‚  â† GloVe/BERT embeddings
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AAHA Module (Aspect-Aware Hierarchical Attention)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Word-level  â”‚â†’ â”‚ Phrase-level â”‚â†’ â”‚Sentence-levelâ”‚       â”‚
â”‚  â”‚  Attention   â”‚  â”‚  Attention   â”‚  â”‚  Attention   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PMAC Module (Progressive Multi-Aspect Composition)         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚  â”‚ Multi-granular â”‚ â†’ Aspect Feature Fusion                 â”‚
â”‚  â”‚ Representation â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IARM Module (Inter-Aspect Relation Modeling)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  Aspect1 â†â†’ Aspect2 â†â†’ Aspect3        â”‚                  â”‚
â”‚  â”‚     (Relation Graph / Attention)      â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â†“
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  Classifier Layer  â”‚
                              â”‚  (Softmax)         â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â†“
                           Output: Sentiment (Pos/Neg/Neu)

ä¸‰ã€æ ¸å¿ƒæ¨¡çµ„èªªæ˜
1. AAHA Module (aaha.py)
pythonclass AAHA(nn.Module):
    """
    Aspect-Aware Hierarchical Attention
    
    åŠŸèƒ½ï¼š
    - ä¸‰å±¤éšå±¤å¼æ³¨æ„åŠ› (word/phrase/sentence)
    - æ¯å±¤éƒ½æ„ŸçŸ¥aspectä¿¡æ¯
    - å‹•æ…‹èª¿æ•´æ³¨æ„åŠ›æ¬Šé‡
    
    è¼¸å…¥ï¼š
    - hidden_states: [batch, seq_len, hidden_dim]
    - aspect_embedding: [batch, aspect_dim]
    
    è¼¸å‡ºï¼š
    - context_vector: [batch, hidden_dim]
    - attention_weights: [batch, seq_len] (ç”¨æ–¼è¦–è¦ºåŒ–)
    """
2. PMAC Module (pmac.py)
pythonclass PMAC(nn.Module):
    """
    Progressive Multi-Aspect Composition
    
    åŠŸèƒ½ï¼š
    - å¤šç²’åº¦aspectè¡¨ç¤º
    - æ¼¸é€²å¼ç‰¹å¾µèåˆ
    - å‹•æ…‹çµ„åˆå¤šå€‹aspect
    
    è¼¸å…¥ï¼š
    - aspect_features: [batch, num_aspects, feature_dim]
    - context_vectors: [batch, num_aspects, context_dim]
    
    è¼¸å‡ºï¼š
    - composed_representation: [batch, output_dim]
    """
3. IARM Module (iarm.py)
pythonclass IARM(nn.Module):
    """
    Inter-Aspect Relation Modeling
    
    åŠŸèƒ½ï¼š
    - å»ºæ¨¡aspecté–“ä¾è³´é—œä¿‚
    - åœ–æ³¨æ„åŠ›ç¶²çµ¡ æˆ– Transformerå¼äº¤äº’
    - é—œä¿‚å¢å¼·çš„aspectè¡¨ç¤º
    
    è¼¸å…¥ï¼š
    - aspect_representations: [batch, num_aspects, dim]
    
    è¼¸å‡ºï¼š
    - relation_enhanced_aspects: [batch, num_aspects, dim]
    """
4. HMAC-Net Complete (hmac_net.py)
pythonclass HMACNet(nn.Module):
    """
    å®Œæ•´HMAC-Netæ¨¡å‹
    
    æ•´åˆAAHA + PMAC + IARM
    
    forwardæµç¨‹ï¼š
    1. Embedding
    2. AAHAæå–éšå±¤å¼ç‰¹å¾µ
    3. PMACçµ„åˆå¤šå€‹aspect
    4. IARMå»ºæ¨¡aspecté–“é—œä¿‚
    5. Classifierè¼¸å‡ºæƒ…æ„Ÿé¡åˆ¥
    """

å››ã€å¯¦é©—æµç¨‹è¨­è¨ˆ
å¯¦é©—1: Baselineæ¯”è¼ƒ (compare_baselines.py)
æ¯”è¼ƒå°è±¡ï¼š
- LSTM
- ATAE-LSTM
- IAN
- Sentic GCN (optional)
- HMAC-Net

è¼¸å‡ºï¼š
- æ€§èƒ½æ¯”è¼ƒè¡¨ (Accuracy & F1)
- è¨“ç·´æ›²ç·šå°æ¯”åœ–
- çµ±è¨ˆé¡¯è‘—æ€§æª¢é©—çµæœ
"""
å¯¦é©—2: æ¶ˆèå¯¦é©— (ablation_study.py)
æ¶ˆèè®Šé«”ï¼š
1. HMAC-Net (å®Œæ•´ç‰ˆ)
2. w/o AAHA (å–®å±¤attention)
3. w/o PMAC (ç°¡å–®å¹³å‡)
4. w/o IARM (ç¨ç«‹è™•ç†)
5. w/o éšå±¤å¼è¨­è¨ˆ (flat architecture)

è¼¸å‡ºï¼š
- å„è®Šé«”æ€§èƒ½å°æ¯”
- æ¯å€‹æ¨¡çµ„çš„è²¢ç»åº¦åˆ†æ
"""
å¯¦é©—3: ä¸»è¦è¨“ç·´ (train.py)
è¨“ç·´é…ç½®ï¼š
- å„ªåŒ–å™¨: Adam
- å­¸ç¿’ç‡: 0.001 with scheduler
- Batch size: 32
- Epochs: 50
- Early stopping: patience=10
- æ•¸æ“šå¢å¼·: dropout, label smoothing

ç›£æ§æŒ‡æ¨™ï¼š
- Training/Validation Loss
- Accuracy, Macro-F1
- æ¯å€‹é¡åˆ¥çš„Precision/Recall
"""

äº”ã€æ•¸æ“šè™•ç†æµç¨‹
preprocessor.py æ ¸å¿ƒåŠŸèƒ½
1. è¼‰å…¥SemEval-2014æ•¸æ“š
   - Restaurant: ~3,000 samples
   - Laptop: ~3,000 samples

2. æ–‡æœ¬è™•ç†
   - Tokenization
   - æ§‹å»ºè©å½™è¡¨
   - Padding/Truncation
   
3. Aspectè™•ç†
   - æå–aspect terms
   - å‰µå»ºaspect masks
   - Aspect embeddingåˆå§‹åŒ–

4. æ¨™ç±¤ç·¨ç¢¼
   - Positive: 2
   - Neutral: 1
   - Negative: 0

5. åŠƒåˆ†è¨“ç·´/é©—è­‰/æ¸¬è©¦é›†
   - Train: 70%
   - Val: 15%
   - Test: 15%
"""

å…­ã€è©•ä¼°æŒ‡æ¨™ (metrics.py)
ä¸»è¦æŒ‡æ¨™ï¼š
1. Accuracy: æ•´é«”æº–ç¢ºç‡
2. Macro-F1: é¡åˆ¥å¹³è¡¡çš„F1
3. Precision/Recall per class
4. Confusion Matrix

çµ±è¨ˆæª¢é©—ï¼š
- Paired t-test
- Wilcoxon signed-rank test
- Bootstrap confidence intervals
"""

ä¸ƒã€é…ç½®æ–‡ä»¶ç¯„ä¾‹
model_config.yaml
yamlmodel:
  embedding_dim: 300
  hidden_dim: 256
  num_layers: 2
  dropout: 0.5
  
aaha:
  word_attention_dim: 128
  phrase_attention_dim: 128
  sentence_attention_dim: 128
  
pmac:
  composition_layers: 2
  fusion_method: "gated"
  
iarm:
  relation_type: "graph_attention"
  num_heads: 4
```

---

å…«ã€é—œéµè¼¸å‡º
results/reports/ å°‡åŒ…å«
1. `baseline_comparison.csv` - æ¨¡å‹æ€§èƒ½å°æ¯”è¡¨
2. `ablation_results.csv` - æ¶ˆèå¯¦é©—çµæœ
3. `attention_visualization.png` - æ³¨æ„åŠ›æ¬Šé‡è¦–è¦ºåŒ–
4. `confusion_matrix.png` - æ··æ·†çŸ©é™£
5. `training_curves.png` - è¨“ç·´/é©—è­‰æ›²ç·š
6. `statistical_significance.txt` - çµ±è¨ˆæª¢é©—å ±å‘Š

ä¹ã€æ•¸æ“šé›†
ç¬¬ä¸€éšæ®µåŒ…å«æœ‰å«"é¢å‘"ç­‰ç´šçš„ï¼Œseneval å«æœ‰é¢å‘çš„æ‰€æœ‰å¯èƒ½æ•¸æ“šé›†ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨è·¯å¾‘ç·¨ç¢¼ä¾†æ”¯æ´æ•¸æ“š
ç¬¬äºŒéšæ®µåŒ…å«æ‰€æœ‰å„é¡è©•è«–ï¼Œimdbã€amazonã€hotelã€twitterç­‰ç­‰ä¸ç®¡é¢å‘ç´šåˆ¥æˆ–è€…å¥å­ç´šåˆ¥ã€‚


é–‹ç™¼è¨»è¨˜
models/aaha.py	ğŸ“ ä¿ç•™	èˆŠç‰ˆä»£ç¢¼ä¿ç•™ä½œç‚ºåƒè€ƒ
models/aaha_enhanced.py	âœ… ä½¿ç”¨ä¸­	æ–°ç‰ˆå¢å¼·æ¨¡çµ„